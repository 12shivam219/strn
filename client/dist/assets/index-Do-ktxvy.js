var g_=Object.defineProperty;var Fp=e=>{throw TypeError(e)};var v_=(e,t,r)=>t in e?g_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var v=(e,t,r)=>v_(e,typeof t!="symbol"?t+"":t,r),zp=(e,t,r)=>t.has(e)||Fp("Cannot "+r);var G=(e,t,r)=>(zp(e,t,"read from private field"),r?r.call(e):t.get(e)),Be=(e,t,r)=>t.has(e)?Fp("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),ge=(e,t,r,n)=>(zp(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var _n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function __(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var sm={exports:{}},Ka={},im={exports:{}},J={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=Symbol.for("react.element"),y_=Symbol.for("react.portal"),w_=Symbol.for("react.fragment"),S_=Symbol.for("react.strict_mode"),R_=Symbol.for("react.profiler"),b_=Symbol.for("react.provider"),C_=Symbol.for("react.context"),k_=Symbol.for("react.forward_ref"),T_=Symbol.for("react.suspense"),E_=Symbol.for("react.memo"),x_=Symbol.for("react.lazy"),Bp=Symbol.iterator;function P_(e){return e===null||typeof e!="object"?null:(e=Bp&&e[Bp]||e["@@iterator"],typeof e=="function"?e:null)}var om={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},am=Object.assign,cm={};function qs(e,t,r){this.props=e,this.context=t,this.refs=cm,this.updater=r||om}qs.prototype.isReactComponent={};qs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};qs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lm(){}lm.prototype=qs.prototype;function zd(e,t,r){this.props=e,this.context=t,this.refs=cm,this.updater=r||om}var Bd=zd.prototype=new lm;Bd.constructor=zd;am(Bd,qs.prototype);Bd.isPureReactComponent=!0;var Up=Array.isArray,dm=Object.prototype.hasOwnProperty,Ud={current:null},um={key:!0,ref:!0,__self:!0,__source:!0};function pm(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)dm.call(t,n)&&!um.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];s.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:so,type:e,key:i,ref:o,props:s,_owner:Ud.current}}function D_(e,t){return{$$typeof:so,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vd(e){return typeof e=="object"&&e!==null&&e.$$typeof===so}function L_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Vp=/\/+/g;function Wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?L_(""+e.key):t.toString(36)}function ia(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case so:case y_:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Wc(o,0):n,Up(s)?(r="",e!=null&&(r=e.replace(Vp,"$&/")+"/"),ia(s,t,r,"",function(l){return l})):s!=null&&(Vd(s)&&(s=D_(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Vp,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Up(e))for(var a=0;a<e.length;a++){i=e[a];var c=n+Wc(i,a);o+=ia(i,t,r,c,s)}else if(c=P_(e),typeof c=="function")for(e=c.call(e),a=0;!(i=e.next()).done;)i=i.value,c=n+Wc(i,a++),o+=ia(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Co(e,t,r){if(e==null)return e;var n=[],s=0;return ia(e,n,"","",function(i){return t.call(r,i,s++)}),n}function I_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ct={current:null},oa={transition:null},M_={ReactCurrentDispatcher:ct,ReactCurrentBatchConfig:oa,ReactCurrentOwner:Ud};function fm(){throw Error("act(...) is not supported in production builds of React.")}J.Children={map:Co,forEach:function(e,t,r){Co(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Co(e,function(){t++}),t},toArray:function(e){return Co(e,function(t){return t})||[]},only:function(e){if(!Vd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};J.Component=qs;J.Fragment=w_;J.Profiler=R_;J.PureComponent=zd;J.StrictMode=S_;J.Suspense=T_;J.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M_;J.act=fm;J.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=am({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Ud.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)dm.call(t,c)&&!um.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:so,type:e.type,key:s,ref:i,props:n,_owner:o}};J.createContext=function(e){return e={$$typeof:C_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:b_,_context:e},e.Consumer=e};J.createElement=pm;J.createFactory=function(e){var t=pm.bind(null,e);return t.type=e,t};J.createRef=function(){return{current:null}};J.forwardRef=function(e){return{$$typeof:k_,render:e}};J.isValidElement=Vd;J.lazy=function(e){return{$$typeof:x_,_payload:{_status:-1,_result:e},_init:I_}};J.memo=function(e,t){return{$$typeof:E_,type:e,compare:t===void 0?null:t}};J.startTransition=function(e){var t=oa.transition;oa.transition={};try{e()}finally{oa.transition=t}};J.unstable_act=fm;J.useCallback=function(e,t){return ct.current.useCallback(e,t)};J.useContext=function(e){return ct.current.useContext(e)};J.useDebugValue=function(){};J.useDeferredValue=function(e){return ct.current.useDeferredValue(e)};J.useEffect=function(e,t){return ct.current.useEffect(e,t)};J.useId=function(){return ct.current.useId()};J.useImperativeHandle=function(e,t,r){return ct.current.useImperativeHandle(e,t,r)};J.useInsertionEffect=function(e,t){return ct.current.useInsertionEffect(e,t)};J.useLayoutEffect=function(e,t){return ct.current.useLayoutEffect(e,t)};J.useMemo=function(e,t){return ct.current.useMemo(e,t)};J.useReducer=function(e,t,r){return ct.current.useReducer(e,t,r)};J.useRef=function(e){return ct.current.useRef(e)};J.useState=function(e){return ct.current.useState(e)};J.useSyncExternalStore=function(e,t,r){return ct.current.useSyncExternalStore(e,t,r)};J.useTransition=function(){return ct.current.useTransition()};J.version="18.3.1";im.exports=J;var re=im.exports;const O_=__(re);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N_=re,A_=Symbol.for("react.element"),j_=Symbol.for("react.fragment"),$_=Object.prototype.hasOwnProperty,F_=N_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,z_={key:!0,ref:!0,__self:!0,__source:!0};function hm(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)$_.call(t,n)&&!z_.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:A_,type:e,key:i,ref:o,props:s,_owner:F_.current}}Ka.Fragment=j_;Ka.jsx=hm;Ka.jsxs=hm;sm.exports=Ka;var D=sm.exports;const B_=()=>{const[e,t]=re.useState(!1),[r,n]=re.useState("Ready to stream"),s=async()=>{try{if(n("Processing..."),window.electronAPI){const o=await window.electronAPI.toggleStream();console.log("Stream toggle result:",o),t(a=>!a),n(e?"Stream stopped":"Stream started")}else await i()}catch(o){console.error("Error toggling stream:",o),n("Error: "+o.message)}},i=async()=>{try{const o=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720},audio:!0});t(!0),n("Streaming from browser"),console.log("Browser stream started:",o)}catch(o){console.error("Error starting web stream:",o),n("Error accessing camera/microphone")}};return D.jsxs("div",{className:"space-y-4 p-6 bg-gray-800 rounded-lg",children:[D.jsxs("div",{className:"text-center",children:[D.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Stream Controls"}),D.jsx("p",{className:"text-gray-400 text-sm mb-4",children:r})]}),D.jsx("button",{onClick:s,className:`w-full px-6 py-3 rounded-lg font-medium transition-colors ${e?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:e?"⏹️ Stop Streaming":"▶️ Start Streaming"}),D.jsxs("div",{className:"flex space-x-2",children:[D.jsx("div",{className:`w-3 h-3 rounded-full ${e?"bg-green-500":"bg-gray-500"}`}),D.jsx("span",{className:"text-sm text-gray-400",children:e?"Live":"Offline"})]})]})};var Hd={},Al={exports:{}},qc,Hp;function U_(){if(Hp)return qc;Hp=1;var e=1e3,t=e*60,r=t*60,n=r*24,s=n*7,i=n*365.25;qc=function(u,d){d=d||{};var p=typeof u;if(p==="string"&&u.length>0)return o(u);if(p==="number"&&isFinite(u))return d.long?c(u):a(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function o(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var p=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*n;case"hours":case"hour":case"hrs":case"hr":case"h":return p*r;case"minutes":case"minute":case"mins":case"min":case"m":return p*t;case"seconds":case"second":case"secs":case"sec":case"s":return p*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function a(u){var d=Math.abs(u);return d>=n?Math.round(u/n)+"d":d>=r?Math.round(u/r)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=n?l(u,d,n,"day"):d>=r?l(u,d,r,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,p,f){var y=d>=p*1.5;return Math.round(u/p)+" "+f+(y?"s":"")}return qc}function V_(e){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=s,r.enabled=a,r.humanize=U_(),r.destroy=l,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let d=0;for(let p=0;p<u.length;p++)d=(d<<5)-d+u.charCodeAt(p),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=t;function r(u){let d,p=null,f,y;function w(...b){if(!w.enabled)return;const h=w,g=Number(new Date),m=g-(d||g);h.diff=m,h.prev=d,h.curr=g,d=g,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let _=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(R,E)=>{if(R==="%%")return"%";_++;const P=r.formatters[E];if(typeof P=="function"){const C=b[_];R=P.call(h,C),b.splice(_,1),_--}return R}),r.formatArgs.call(h,b),(h.log||r.log).apply(h,b)}return w.namespace=u,w.useColors=r.useColors(),w.color=r.selectColor(u),w.extend=n,w.destroy=r.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(f!==r.namespaces&&(f=r.namespaces,y=r.enabled(u)),y),set:b=>{p=b}}),typeof r.init=="function"&&r.init(w),w}function n(u,d){const p=r(this.namespace+(typeof d>"u"?":":d)+u);return p.log=this.log,p}function s(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];const d=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const p of d)p[0]==="-"?r.skips.push(p.slice(1)):r.names.push(p)}function i(u,d){let p=0,f=0,y=-1,w=0;for(;p<u.length;)if(f<d.length&&(d[f]===u[p]||d[f]==="*"))d[f]==="*"?(y=f,w=p,f++):(p++,f++);else if(y!==-1)f=y+1,w++,p=w;else return!1;for(;f<d.length&&d[f]==="*";)f++;return f===d.length}function o(){const u=[...r.names,...r.skips.map(d=>"-"+d)].join(",");return r.enable(""),u}function a(u){for(const d of r.skips)if(i(u,d))return!1;for(const d of r.names)if(i(u,d))return!0;return!1}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var H_=V_;(function(e,t){var r={};t.formatArgs=s,t.save=i,t.load=o,t.useColors=n,t.storage=a(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,p=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(p=d))}),l.splice(p,0,u)}t.log=console.debug||console.log||(()=>{});function i(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function o(){let l;try{l=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=r.DEBUG),l}function a(){try{return localStorage}catch{}}e.exports=H_(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Al,Al.exports);var Qa=Al.exports,mm={},Fn={},jl={exports:{}};(function(e,t){(function(r,n){var s="2.0.3",i=500,o="user-agent",a="",c="?",l="function",u="undefined",d="object",p="string",f="browser",y="cpu",w="device",b="engine",h="os",g="result",m="name",_="type",S="vendor",R="version",E="architecture",P="major",C="model",A="console",x="mobile",B="tablet",W="smarttv",Ie="wearable",Qt="xr",fr="embedded",hr="inapp",L="brands",U="formFactors",q="fullVersionList",ue="platform",Te="platformVersion",mr="bitness",qe="sec-ch-ua",ri=qe+"-full-version-list",gr=qe+"-arch",Hn=qe+"-"+mr,a_=qe+"-form-factors",c_=qe+"-"+x,l_=qe+"-"+C,wp=qe+"-"+ue,d_=wp+"-version",Sp=[L,q,x,C,ue,Te,E,U,mr],vo="Amazon",Kn="Apple",Rp="ASUS",bp="BlackBerry",fn="Google",Cp="Huawei",kp="Lenovo",Tp="Honor",_o="LG",Mc="Microsoft",Oc="Motorola",Nc="Nvidia",Ep="OnePlus",Ac="OPPO",ni="Samsung",xp="Sharp",si="Sony",jc="Xiaomi",$c="Zebra",Pp="Chrome",Dp="Chromium",Or="Chromecast",u_="Edge",ii="Firefox",oi="Opera",Fc="Facebook",Lp="Sogou",Qn="Mobile ",ai=" Browser",zc="Windows",Ip=typeof r!==u,dt=Ip&&r.navigator?r.navigator:n,Nr=dt&&dt.userAgentData?dt.userAgentData:n,p_=function(T,M){var O={},oe=M;if(!wo(M)){oe={};for(var H in M)for(var fe in M[H])oe[fe]=M[H][fe].concat(oe[fe]?oe[fe]:[])}for(var j in T)O[j]=oe[j]&&oe[j].length%2===0?oe[j].concat(T[j]):T[j];return O},yo=function(T){for(var M={},O=0;O<T.length;O++)M[T[O].toUpperCase()]=T[O];return M},Bc=function(T,M){if(typeof T===d&&T.length>0){for(var O in T)if(vr(T[O])==vr(M))return!0;return!1}return Wn(T)?vr(M).indexOf(vr(T))!==-1:!1},wo=function(T,M){for(var O in T)return/^(browser|cpu|device|engine|os)$/.test(O)||(M?wo(T[O]):!1)},Wn=function(T){return typeof T===p},Uc=function(T){if(!T)return n;for(var M=[],O=qn(/\\?\"/g,T).split(","),oe=0;oe<O.length;oe++)if(O[oe].indexOf(";")>-1){var H=li(O[oe]).split(";v=");M[oe]={brand:H[0],version:H[1]}}else M[oe]=li(O[oe]);return M},vr=function(T){return Wn(T)?T.toLowerCase():T},Vc=function(T){return Wn(T)?qn(/[^\d\.]/g,T).split(".")[0]:n},_r=function(T){for(var M in T){var O=T[M];typeof O==d&&O.length==2?this[O[0]]=O[1]:this[O]=n}return this},qn=function(T,M){return Wn(M)?M.replace(T,a):M},ci=function(T){return qn(/\\?\"/g,T)},li=function(T,M){if(Wn(T))return T=qn(/^\s\s*/,T),typeof M===u?T:T.substring(0,i)},Hc=function(T,M){if(!(!T||!M))for(var O=0,oe,H,fe,j,ce,X;O<M.length&&!ce;){var xe=M[O],yr=M[O+1];for(oe=H=0;oe<xe.length&&!ce&&xe[oe];)if(ce=xe[oe++].exec(T),ce)for(fe=0;fe<yr.length;fe++)X=ce[++H],j=yr[fe],typeof j===d&&j.length>0?j.length===2?typeof j[1]==l?this[j[0]]=j[1].call(this,X):this[j[0]]=j[1]:j.length===3?typeof j[1]===l&&!(j[1].exec&&j[1].test)?this[j[0]]=X?j[1].call(this,X,j[2]):n:this[j[0]]=X?X.replace(j[1],j[2]):n:j.length===4&&(this[j[0]]=X?j[3].call(this,X.replace(j[1],j[2])):n):this[j]=X||n;O+=2}},Ar=function(T,M){for(var O in M)if(typeof M[O]===d&&M[O].length>0){for(var oe=0;oe<M[O].length;oe++)if(Bc(M[O][oe],T))return O===c?n:O}else if(Bc(M[O],T))return O===c?n:O;return M.hasOwnProperty("*")?M["*"]:T},Mp={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Op={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":n},Np={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[R,[m,Qn+"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[R,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,R],[/opios[\/ ]+([\w\.]+)/i],[R,[m,oi+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[R,[m,oi+" GX"]],[/\bopr\/([\w\.]+)/i],[R,[m,oi]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[R,[m,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[R,[m,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:lg |qute)browser)\/([-\w\.]+)/i,/(heytap|ovi|115|surf)browser\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[m,R],[/quark(?:pc)?\/([-\w\.]+)/i],[R,[m,"Quark"]],[/\bddg\/([\w\.]+)/i],[R,[m,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[R,[m,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[R,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[R,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[R,[m,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[R,[m,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[R,[m,"Smart "+kp+ai]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure"+ai],R],[/\bfocus\/([\w\.]+)/i],[R,[m,ii+" Focus"]],[/\bopt\/([\w\.]+)/i],[R,[m,oi+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[R,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[R,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[R,[m,oi+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[R,[m,"MIUI"+ai]],[/fxios\/([\w\.-]+)/i],[R,[m,Qn+ii]],[/\bqihoobrowser\/?([\w\.]*)/i],[R,[m,"360"]],[/\b(qq)\/([\w\.]+)/i],[[m,/(.+)/,"$1Browser"],R],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1"+ai],R],[/samsungbrowser\/([\w\.]+)/i],[R,[m,ni+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[R,[m,Lp+" Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[m,Lp+" Mobile"],R],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[m,R],[/(lbbrowser|rekonq)/i],[m],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[R,m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,Fc],R,[_,hr]],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(instagram|snapchat)[\/ ]([-\w\.]+)/i],[m,R,[_,hr]],[/\bgsa\/([\w\.]+) .*safari\//i],[R,[m,"GSA"],[_,hr]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[R,[m,"TikTok"],[_,hr]],[/\[(linkedin)app\]/i],[m,[_,hr]],[/(chromium)[\/ ]([-\w\.]+)/i],[m,R],[/headlesschrome(?:\/([\w\.]+)| )/i],[R,[m,Pp+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,Pp+" WebView"],R],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[R,[m,"Android"+ai]],[/chrome\/([\w\.]+) mobile/i],[R,[m,Qn+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,R],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[R,[m,Qn+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[m,Qn+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[R,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[R,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[m,R],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[m,Qn+ii],R],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],R],[/(wolvic|librewolf)\/([\w\.]+)/i],[m,R],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[R,[m,ii+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[m,[R,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[m,[R,/[^\d\.]+./,a]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[E,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[E,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[E,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[E,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[E,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[E,/ower/,a,vr]],[/ sun4\w[;\)]/i],[[E,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[E,vr]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[C,[S,ni],[_,B]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[C,[S,ni],[_,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[C,[S,Kn],[_,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[C,[S,Kn],[_,B]],[/(macintosh);/i],[C,[S,Kn]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[C,[S,xp],[_,x]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[C,[S,Tp],[_,B]],[/honor([-\w ]+)[;\)]/i],[C,[S,Tp],[_,x]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[C,[S,Cp],[_,B]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[C,[S,Cp],[_,x]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[C,/_/g," "],[S,jc],[_,B]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[C,/_/g," "],[S,jc],[_,x]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[C,[S,Ac],[_,x]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[C,[S,Ar,{OnePlus:["304","403","203"],"*":Ac}],[_,B]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[C,[S,"BLU"],[_,x]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[C,[S,"Vivo"],[_,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[C,[S,"Realme"],[_,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[C,[S,Oc],[_,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[C,[S,Oc],[_,B]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[C,[S,_o],[_,B]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch))(\w+)/i,/\blg-?([\d\w]+) bui/i],[C,[S,_o],[_,x]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[C,[S,kp],[_,B]],[/(nokia) (t[12][01])/i],[S,C,[_,B]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[C,/_/g," "],[_,x],[S,"Nokia"]],[/(pixel (c|tablet))\b/i],[C,[S,fn],[_,B]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[C,[S,fn],[_,x]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[C,[S,si],[_,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[C,"Xperia Tablet"],[S,si],[_,B]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[C,[S,Ep],[_,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[C,[S,vo],[_,B]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[C,/(.+)/g,"Fire Phone $1"],[S,vo],[_,x]],[/(playbook);[-\w\),; ]+(rim)/i],[C,S,[_,B]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[C,[S,bp],[_,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[C,[S,Rp],[_,B]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[C,[S,Rp],[_,x]],[/(nexus 9)/i],[C,[S,"HTC"],[_,B]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[S,[C,/_/g," "],[_,x]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[C,[S,"TCL"],[_,B]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[C,[S,"TCL"],[_,x]],[/(itel) ((\w+))/i],[[S,vr],C,[_,Ar,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[C,[S,"Acer"],[_,B]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[C,[S,"Meizu"],[_,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[C,[S,"Ulefone"],[_,x]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[C,[S,"Energizer"],[_,x]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[C,[S,"Cat"],[_,x]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[C,[S,"Smartfren"],[_,x]],[/droid.+; (a(?:015|06[35]|142p?))/i],[C,[S,"Nothing"],[_,x]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[C,[S,"Archos"],[_,B]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[C,[S,"Archos"],[_,x]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[S,C,[_,B]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|tcl)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[S,C,[_,x]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[S,C,[_,B]],[/(surface duo)/i],[C,[S,Mc],[_,B]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[C,[S,"Fairphone"],[_,x]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[C,[S,Nc],[_,B]],[/(sprint) (\w+)/i],[S,C,[_,x]],[/(kin\.[onetw]{3})/i],[[C,/\./g," "],[S,Mc],[_,x]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[C,[S,$c],[_,B]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[C,[S,$c],[_,x]],[/smart-tv.+(samsung)/i],[S,[_,W]],[/hbbtv.+maple;(\d+)/i],[[C,/^/,"SmartTV"],[S,ni],[_,W]],[/tcast.+(lg)e?. ([-\w]+)/i],[S,C,[_,W]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[S,_o],[_,W]],[/(apple) ?tv/i],[S,[C,Kn+" TV"],[_,W]],[/crkey.*devicetype\/chromecast/i],[[C,Or+" Third Generation"],[S,fn],[_,W]],[/crkey.*devicetype\/([^/]*)/i],[[C,/^/,"Chromecast "],[S,fn],[_,W]],[/fuchsia.*crkey/i],[[C,Or+" Nest Hub"],[S,fn],[_,W]],[/crkey/i],[[C,Or],[S,fn],[_,W]],[/(portaltv)/i],[C,[S,Fc],[_,W]],[/droid.+aft(\w+)( bui|\))/i],[C,[S,vo],[_,W]],[/(shield \w+ tv)/i],[C,[S,Nc],[_,W]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[C,[S,xp],[_,W]],[/(bravia[\w ]+)( bui|\))/i],[C,[S,si],[_,W]],[/(mi(tv|box)-?\w+) bui/i],[C,[S,jc],[_,W]],[/Hbbtv.*(technisat) (.*);/i],[S,C,[_,W]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[S,li],[C,li],[_,W]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[C,[_,W]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[_,W]],[/(ouya)/i,/(nintendo) (\w+)/i],[S,C,[_,A]],[/droid.+; (shield)( bui|\))/i],[C,[S,Nc],[_,A]],[/(playstation \w+)/i],[C,[S,si],[_,A]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[C,[S,Mc],[_,A]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[C,[S,ni],[_,Ie]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[S,C,[_,Ie]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[C,[S,Ac],[_,Ie]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[C,[S,Kn],[_,Ie]],[/(opwwe\d{3})/i],[C,[S,Ep],[_,Ie]],[/(moto 360)/i],[C,[S,Oc],[_,Ie]],[/(smartwatch 3)/i],[C,[S,si],[_,Ie]],[/(g watch r)/i],[C,[S,_o],[_,Ie]],[/droid.+; (wt63?0{2,3})\)/i],[C,[S,$c],[_,Ie]],[/droid.+; (glass) \d/i],[C,[S,fn],[_,Qt]],[/(pico) (4|neo3(?: link|pro)?)/i],[S,C,[_,Qt]],[/(quest( \d| pro)?s?).+vr/i],[C,[S,Fc],[_,Qt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[S,[_,fr]],[/(aeobc)\b/i],[C,[S,vo],[_,fr]],[/(homepod).+mac os/i],[C,[S,Kn],[_,fr]],[/windows iot/i],[[_,fr]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+?(mobile|vr|\d) safari/i],[C,[_,Ar,{mobile:"Mobile",xr:"VR","*":B}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[_,B]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[_,x]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[C,[S,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[R,[m,u_+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[m,R],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[R,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[m,R],[/ladybird\//i],[[m,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[R,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,R],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[m,[R,Ar,Mp]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[R,Ar,Mp],[m,zc]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[R,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,"macOS"],[R,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[R,[m,Or+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[R,[m,Or+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[R,[m,Or+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[R,[m,Or+" Linux"]],[/crkey\/([\d\.]+)/i],[R,[m,Or]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[R,m],[/(ubuntu) ([\w\.]+) like android/i],[[m,/(.+)/,"$1 Touch"],R],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/\.; ]?([\d\.]*)/i],[m,R],[/\(bb(10);/i],[R,[m,bp]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[R,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[R,[m,ii+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[R,[m,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[R,[m,"watchOS"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[m,"Chrome OS"],R],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,R],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],R],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[m,R]]},So=function(){var T={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}};return _r.call(T.init,[[f,[m,R,P,_]],[y,[E]],[w,[_,C,S]],[b,[m,R]],[h,[m,R]]]),_r.call(T.isIgnore,[[f,[R,P]],[b,[R]],[h,[R]]]),_r.call(T.isIgnoreRgx,[[f,/ ?browser$/i],[h,/ ?os$/i]]),_r.call(T.toString,[[f,[m,R]],[y,[E]],[w,[S,C]],[b,[m,R]],[h,[m,R]]]),T}(),f_=function(T,M){var O=So.init[M],oe=So.isIgnore[M]||0,H=So.isIgnoreRgx[M]||0,fe=So.toString[M]||0;function j(){_r.call(this,O)}return j.prototype.getItem=function(){return T},j.prototype.withClientHints=function(){return Nr?Nr.getHighEntropyValues(Sp).then(function(ce){return T.setCH(new Ap(ce,!1)).parseCH().get()}):T.parseCH().get()},j.prototype.withFeatureCheck=function(){return T.detectFeature().get()},M!=g&&(j.prototype.is=function(ce){var X=!1;for(var xe in this)if(this.hasOwnProperty(xe)&&!Bc(oe,xe)&&vr(H?qn(H,this[xe]):this[xe])==vr(H?qn(H,ce):ce)){if(X=!0,ce!=u)break}else if(ce==u&&X){X=!X;break}return X},j.prototype.toString=function(){var ce=a;for(var X in fe)typeof this[fe[X]]!==u&&(ce+=(ce?" ":a)+this[fe[X]]);return ce||u}),Nr||(j.prototype.then=function(ce){var X=this,xe=function(){for(var jr in X)X.hasOwnProperty(jr)&&(this[jr]=X[jr])};xe.prototype={is:j.prototype.is,toString:j.prototype.toString};var yr=new xe;return ce(yr),yr}),new j};function Ap(T,M){if(T=T||{},_r.call(this,Sp),M)_r.call(this,[[L,Uc(T[qe])],[q,Uc(T[ri])],[x,/\?1/.test(T[c_])],[C,ci(T[l_])],[ue,ci(T[wp])],[Te,ci(T[d_])],[E,ci(T[gr])],[U,Uc(T[a_])],[mr,ci(T[Hn])]]);else for(var O in T)this.hasOwnProperty(O)&&typeof T[O]!==u&&(this[O]=T[O])}function jp(T,M,O,oe){return this.get=function(H){return H?this.data.hasOwnProperty(H)?this.data[H]:n:this.data},this.set=function(H,fe){return this.data[H]=fe,this},this.setCH=function(H){return this.uaCH=H,this},this.detectFeature=function(){if(dt&&dt.userAgent==this.ua)switch(this.itemType){case f:dt.brave&&typeof dt.brave.isBrave==l&&this.set(m,"Brave");break;case w:!this.get(_)&&Nr&&Nr[x]&&this.set(_,x),this.get(C)=="Macintosh"&&dt&&typeof dt.standalone!==u&&dt.maxTouchPoints&&dt.maxTouchPoints>2&&this.set(C,"iPad").set(_,B);break;case h:!this.get(m)&&Nr&&Nr[ue]&&this.set(m,Nr[ue]);break;case g:var H=this.data,fe=function(j){return H[j].getItem().detectFeature().get()};this.set(f,fe(f)).set(y,fe(y)).set(w,fe(w)).set(b,fe(b)).set(h,fe(h))}return this},this.parseUA=function(){return this.itemType!=g&&Hc.call(this.data,this.ua,this.rgxMap),this.itemType==f&&this.set(P,Vc(this.get(R))),this},this.parseCH=function(){var H=this.uaCH,fe=this.rgxMap;switch(this.itemType){case f:case b:var j=H[q]||H[L],ce;if(j)for(var X in j){var xe=j[X].brand||j[X],yr=j[X].version;this.itemType==f&&!/not.a.brand/i.test(xe)&&(!ce||/chrom/i.test(ce)&&xe!=Dp)&&(xe=Ar(xe,{Chrome:"Google Chrome",Edge:"Microsoft Edge","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"}),this.set(m,xe).set(R,yr).set(P,Vc(yr)),ce=xe),this.itemType==b&&xe==Dp&&this.set(R,yr)}break;case y:var jr=H[E];jr&&(jr&&H[mr]=="64"&&(jr+="64"),Hc.call(this.data,jr+";",fe));break;case w:if(H[x]&&this.set(_,x),H[C]&&(this.set(C,H[C]),!this.get(_)||!this.get(S))){var di={};Hc.call(di,"droid 9; "+H[C]+")",fe),!this.get(_)&&di.type&&this.set(_,di.type),!this.get(S)&&di.vendor&&this.set(S,di.vendor)}if(H[U]){var bo;if(typeof H[U]!="string")for(var $p=0;!bo&&$p<H[U].length;)bo=Ar(H[U][$p++],Op);else bo=Ar(H[U],Op);this.set(_,bo)}break;case h:var Kc=H[ue];if(Kc){var Qc=H[Te];Kc==zc&&(Qc=parseInt(Vc(Qc),10)>=13?"11":"10"),this.set(m,Kc).set(R,Qc)}this.get(m)==zc&&H[C]=="Xbox"&&this.set(m,"Xbox").set(R,n);break;case g:var h_=this.data,ui=function(m_){return h_[m_].getItem().setCH(H).parseCH().get()};this.set(f,ui(f)).set(y,ui(y)).set(w,ui(w)).set(b,ui(b)).set(h,ui(h))}return this},_r.call(this,[["itemType",T],["ua",M],["uaCH",oe],["rgxMap",O],["data",f_(this,T)]]),this}function Ot(T,M,O){if(typeof T===d?(wo(T,!0)?(typeof M===d&&(O=M),M=T):(O=T,M=n),T=n):typeof T===p&&!wo(M,!0)&&(O=M,M=n),O&&typeof O.append===l){var oe={};O.forEach(function(X,xe){oe[xe]=X}),O=oe}if(!(this instanceof Ot))return new Ot(T,M,O).getResult();var H=typeof T===p?T:O&&O[o]?O[o]:dt&&dt.userAgent?dt.userAgent:a,fe=new Ap(O,!0),j=M?p_(Np,M):Np,ce=function(X){return X==g?function(){return new jp(X,H,j,fe).set("ua",H).set(f,this.getBrowser()).set(y,this.getCPU()).set(w,this.getDevice()).set(b,this.getEngine()).set(h,this.getOS()).get()}:function(){return new jp(X,H,j[X],fe).parseUA().get()}};return _r.call(this,[["getBrowser",ce(f)],["getCPU",ce(y)],["getDevice",ce(w)],["getEngine",ce(b)],["getOS",ce(h)],["getResult",ce(g)],["getUA",function(){return H}],["setUA",function(X){return Wn(X)&&(H=X.length>i?li(X,i):X),this}]]).setUA(H),this}Ot.VERSION=s,Ot.BROWSER=yo([m,R,P,_]),Ot.CPU=yo([E]),Ot.DEVICE=yo([C,S,_,A,x,W,B,Ie,fr]),Ot.ENGINE=Ot.OS=yo([m,R]),e.exports&&(t=e.exports=Ot),t.UAParser=Ot;var Gn=Ip&&(r.jQuery||r.Zepto);if(Gn&&!Gn.ua){var Ro=new Ot;Gn.ua=Ro.getResult(),Gn.ua.get=function(){return Ro.getUA()},Gn.ua.set=function(T){Ro.setUA(T);var M=Ro.getResult();for(var O in M)Gn.ua[O]=M[O]}}})(typeof window=="object"?window:_n)})(jl,jl.exports);var K_=jl.exports,we={};Object.defineProperty(we,"__esModule",{value:!0});we.Logger=void 0;const Yn=Qa,Xn="mediasoup-client";let Q_=class{constructor(t){v(this,"_debug");v(this,"_warn");v(this,"_error");t?(this._debug=(0,Yn.default)(`${Xn}:${t}`),this._warn=(0,Yn.default)(`${Xn}:WARN:${t}`),this._error=(0,Yn.default)(`${Xn}:ERROR:${t}`)):(this._debug=(0,Yn.default)(Xn),this._warn=(0,Yn.default)(`${Xn}:WARN`),this._error=(0,Yn.default)(`${Xn}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};we.Logger=Q_;var Ht={},Kd={exports:{}},Ps=typeof Reflect=="object"?Reflect:null,Kp=Ps&&typeof Ps.apply=="function"?Ps.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},aa;Ps&&typeof Ps.ownKeys=="function"?aa=Ps.ownKeys:Object.getOwnPropertySymbols?aa=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:aa=function(t){return Object.getOwnPropertyNames(t)};function W_(e){console&&console.warn&&console.warn(e)}var gm=Number.isNaN||function(t){return t!==t};function pe(){pe.init.call(this)}Kd.exports=pe;Kd.exports.once=X_;pe.EventEmitter=pe;pe.prototype._events=void 0;pe.prototype._eventsCount=0;pe.prototype._maxListeners=void 0;var Qp=10;function Wa(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(pe,"defaultMaxListeners",{enumerable:!0,get:function(){return Qp},set:function(e){if(typeof e!="number"||e<0||gm(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Qp=e}});pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||gm(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function vm(e){return e._maxListeners===void 0?pe.defaultMaxListeners:e._maxListeners}pe.prototype.getMaxListeners=function(){return vm(this)};pe.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=t==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[t];if(c===void 0)return!1;if(typeof c=="function")Kp(c,this,r);else for(var l=c.length,u=Rm(c,l),n=0;n<l;++n)Kp(u[n],this,r);return!0};function _m(e,t,r,n){var s,i,o;if(Wa(r),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),o===void 0)o=i[t]=r,++e._eventsCount;else if(typeof o=="function"?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),s=vm(e),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,W_(a)}return e}pe.prototype.addListener=function(t,r){return _m(this,t,r,!1)};pe.prototype.on=pe.prototype.addListener;pe.prototype.prependListener=function(t,r){return _m(this,t,r,!0)};function q_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ym(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=q_.bind(n);return s.listener=r,n.wrapFn=s,s}pe.prototype.once=function(t,r){return Wa(r),this.on(t,ym(this,t,r)),this};pe.prototype.prependOnceListener=function(t,r){return Wa(r),this.prependListener(t,ym(this,t,r)),this};pe.prototype.removeListener=function(t,r){var n,s,i,o,a;if(Wa(r),s=this._events,s===void 0)return this;if(n=s[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():G_(n,i),n.length===1&&(s[t]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",t,a||r)}return this};pe.prototype.off=pe.prototype.removeListener;pe.prototype.removeAllListeners=function(t){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(t,r[s]);return this};function wm(e,t,r){var n=e._events;if(n===void 0)return[];var s=n[t];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?Y_(s):Rm(s,s.length)}pe.prototype.listeners=function(t){return wm(this,t,!0)};pe.prototype.rawListeners=function(t){return wm(this,t,!1)};pe.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Sm.call(e,t)};pe.prototype.listenerCount=Sm;function Sm(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}pe.prototype.eventNames=function(){return this._eventsCount>0?aa(this._events):[]};function Rm(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function G_(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Y_(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function X_(e,t){return new Promise(function(r,n){function s(o){e.removeListener(t,i),n(o)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",s),r([].slice.call(arguments))}bm(e,t,i,{once:!0}),t!=="error"&&J_(e,s,{once:!0})})}function J_(e,t,r){typeof e.on=="function"&&bm(e,"error",t,r)}function bm(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function s(i){n.once&&e.removeEventListener(t,s),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Z_=Kd.exports;Object.defineProperty(Ht,"__esModule",{value:!0});Ht.EnhancedEventEmitter=void 0;const ey=Z_,ty=we,ry=new ty.Logger("EnhancedEventEmitter");class ny extends ey.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(t,...r){return super.emit(t,...r)}safeEmit(t,...r){try{return super.emit(t,...r)}catch(n){ry.error("safeEmit() | event listener threw an error [eventName:%s]:%o",t,n);try{super.emit("listenererror",t,n)}catch{}return!!super.listenerCount(t)}}on(t,r){return super.on(t,r),this}off(t,r){return super.off(t,r),this}addListener(t,r){return super.on(t,r),this}prependListener(t,r){return super.prependListener(t,r),this}once(t,r){return super.once(t,r),this}prependOnceListener(t,r){return super.prependOnceListener(t,r),this}removeListener(t,r){return super.off(t,r),this}removeAllListeners(t){return super.removeAllListeners(t),this}listenerCount(t){return super.listenerCount(t)}listeners(t){return super.listeners(t)}rawListeners(t){return super.rawListeners(t)}}Ht.EnhancedEventEmitter=ny;var Le={};Object.defineProperty(Le,"__esModule",{value:!0});Le.InvalidStateError=Le.UnsupportedError=void 0;class Qd extends Error{constructor(t){super(t),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Qd):this.stack=new Error(t).stack}}Le.UnsupportedError=Qd;class Wd extends Error{constructor(t){super(t),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Wd):this.stack=new Error(t).stack}}Le.InvalidStateError=Wd;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.clone=sy;Ce.generateRandomNumber=iy;Ce.deepFreeze=Cm;function sy(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}function iy(){return Math.round(Math.random()*1e7)}function Cm(e){const t=Reflect.ownKeys(e);for(const r of t){const n=e[r];(n&&typeof n=="object"||typeof n=="function")&&Cm(n)}return Object.freeze(e)}var de={},He={},qa={},oy=_n&&_n.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qa,"__esModule",{value:!0});qa.Logger=void 0;const Jn=oy(Qa),Zn="h264-profile-level-id";let ay=class{constructor(t){t?(this._debug=(0,Jn.default)(`${Zn}:${t}`),this._warn=(0,Jn.default)(`${Zn}:WARN:${t}`),this._error=(0,Jn.default)(`${Zn}:ERROR:${t}`)):(this._debug=(0,Jn.default)(Zn),this._warn=(0,Jn.default)(`${Zn}:WARN`),this._error=(0,Jn.default)(`${Zn}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};qa.Logger=ay;Object.defineProperty(He,"__esModule",{value:!0});He.ProfileLevelId=He.Level=He.Profile=void 0;He.parseProfileLevelId=km;He.profileLevelIdToString=Tm;He.profileToString=uy;He.levelToString=py;He.parseSdpProfileLevelId=In;He.isSameProfile=fy;He.isSameProfileAndLevel=hy;He.generateProfileLevelIdStringForAnswer=my;He.supportedLevel=gy;const cy=qa,zt=new cy.Logger;var he;(function(e){e[e.ConstrainedBaseline=1]="ConstrainedBaseline",e[e.Baseline=2]="Baseline",e[e.Main=3]="Main",e[e.ConstrainedHigh=4]="ConstrainedHigh",e[e.High=5]="High",e[e.PredictiveHigh444=6]="PredictiveHigh444"})(he||(He.Profile=he={}));var N;(function(e){e[e.L1_b=0]="L1_b",e[e.L1=10]="L1",e[e.L1_1=11]="L1_1",e[e.L1_2=12]="L1_2",e[e.L1_3=13]="L1_3",e[e.L2=20]="L2",e[e.L2_1=21]="L2_1",e[e.L2_2=22]="L2_2",e[e.L3=30]="L3",e[e.L3_1=31]="L3_1",e[e.L3_2=32]="L3_2",e[e.L4=40]="L4",e[e.L4_1=41]="L4_1",e[e.L4_2=42]="L4_2",e[e.L5=50]="L5",e[e.L5_1=51]="L5_1",e[e.L5_2=52]="L5_2"})(N||(He.Level=N={}));class Ga{constructor(t,r){this.profile=t,this.level=r}}He.ProfileLevelId=Ga;const ly=new Ga(he.ConstrainedBaseline,N.L3_1);class wr{constructor(t){this.mask=~qp("x",t),this.masked_value=qp("1",t)}isMatch(t){return this.masked_value===(t&this.mask)}}class Sr{constructor(t,r,n){this.profile_idc=t,this.profile_iop=r,this.profile=n}}const dy=[new Sr(66,new wr("x1xx0000"),he.ConstrainedBaseline),new Sr(77,new wr("1xxx0000"),he.ConstrainedBaseline),new Sr(88,new wr("11xx0000"),he.ConstrainedBaseline),new Sr(66,new wr("x0xx0000"),he.Baseline),new Sr(88,new wr("10xx0000"),he.Baseline),new Sr(77,new wr("0x0x0000"),he.Main),new Sr(100,new wr("00000000"),he.High),new Sr(100,new wr("00001100"),he.ConstrainedHigh),new Sr(244,new wr("00000000"),he.PredictiveHigh444)],Wp=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:N.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:N.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:N.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:N.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:N.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:N.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:N.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:N.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:N.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:N.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:N.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:N.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:N.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:N.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:N.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:N.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:N.L5_2}];function km(e){if(typeof e!="string"||e.length!==6)return;const r=parseInt(e,16);if(r===0)return;const n=r&255,s=r>>8&255,i=r>>16&255;let o;switch(n){case N.L1_1:{o=s&16?N.L1_b:N.L1_1;break}case N.L1:case N.L1_2:case N.L1_3:case N.L2:case N.L2_1:case N.L2_2:case N.L3:case N.L3_1:case N.L3_2:case N.L4:case N.L4_1:case N.L4_2:case N.L5:case N.L5_1:case N.L5_2:{o=n;break}default:{zt.warn(`parseProfileLevelId() | unrecognized level_idc [str:${e}, level_idc:${n}]`);return}}for(const a of dy)if(i===a.profile_idc&&a.profile_iop.isMatch(s))return zt.debug(`parseProfileLevelId() | result [str:${e}, profile:${a.profile}, level:${o}]`),new Ga(a.profile,o);zt.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${e}, profile_idc:${i}, profile_iop:${s}]`)}function Tm(e){if(e.level==N.L1_b)switch(e.profile){case he.ConstrainedBaseline:return"42f00b";case he.Baseline:return"42100b";case he.Main:return"4d100b";default:{zt.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${e.profile}`);return}}let t;switch(e.profile){case he.ConstrainedBaseline:{t="42e0";break}case he.Baseline:{t="4200";break}case he.Main:{t="4d00";break}case he.ConstrainedHigh:{t="640c";break}case he.High:{t="6400";break}case he.PredictiveHigh444:{t="f400";break}default:{zt.warn(`profileLevelIdToString() | unrecognized profile ${e.profile}`);return}}let r=e.level.toString(16);return r.length===1&&(r=`0${r}`),`${t}${r}`}function uy(e){switch(e){case he.ConstrainedBaseline:return"ConstrainedBaseline";case he.Baseline:return"Baseline";case he.Main:return"Main";case he.ConstrainedHigh:return"ConstrainedHigh";case he.High:return"High";case he.PredictiveHigh444:return"PredictiveHigh444";default:{zt.warn(`profileToString() | unrecognized profile ${e}`);return}}}function py(e){switch(e){case N.L1_b:return"1b";case N.L1:return"1";case N.L1_1:return"1.1";case N.L1_2:return"1.2";case N.L1_3:return"1.3";case N.L2:return"2";case N.L2_1:return"2.1";case N.L2_2:return"2.2";case N.L3:return"3";case N.L3_1:return"3.1";case N.L3_2:return"3.2";case N.L4:return"4";case N.L4_1:return"4.1";case N.L4_2:return"4.2";case N.L5:return"5";case N.L5_1:return"5.1";case N.L5_2:return"5.2";default:{zt.warn(`levelToString() | unrecognized level ${e}`);return}}}function In(e={}){const t=e["profile-level-id"];return t?km(t):ly}function fy(e={},t={}){const r=In(e),n=In(t);return!!(r&&n&&r.profile===n.profile)}function hy(e={},t={}){const r=In(e),n=In(t);return!!(r&&n&&r.profile===n.profile&&r.level==n.level)}function my(e={},t={}){if(!e["profile-level-id"]&&!t["profile-level-id"]){zt.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const r=In(e),n=In(t);if(!r)throw new TypeError("invalid local_profile_level_id");if(!n)throw new TypeError("invalid remote_profile_level_id");if(r.profile!==n.profile)throw new TypeError("H264 Profile mismatch");const s=Gp(e)&&Gp(t),i=r.level,o=n.level,a=_y(i,o),c=s?i:a;return zt.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${r.profile}, level:${c}]`),Tm(new Ga(r.profile,c))}function gy(e,t){for(let n=Wp.length-1;n>=0;--n){const s=Wp[n];if(s.max_macroblock_frame_size*256<=e&&s.max_macroblocks_per_second<=t*s.max_macroblock_frame_size)return zt.debug(`supportedLevel() | result [max_frame_pixel_count:${e}, max_fps:${t}, level:${s.level}]`),s.level}zt.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${e}, max_fps:${t}]`)}function qp(e,t){return+(t[0]===e)<<7|+(t[1]===e)<<6|+(t[2]===e)<<5|+(t[3]===e)<<4|+(t[4]===e)<<3|+(t[5]===e)<<2|+(t[6]===e)<<1|+(t[7]===e)<<0}function vy(e,t){return e===N.L1_b?t!==N.L1&&t!==N.L1_b:t===N.L1_b?e!==N.L1:e<t}function _y(e,t){return vy(e,t)?e:t}function Gp(e={}){const t=e["level-asymmetry-allowed"];return t===!0||t===1||t==="1"}Object.defineProperty(de,"__esModule",{value:!0});de.validateRtpCapabilities=by;de.validateRtpParameters=qd;de.validateSctpStreamParameters=Cy;de.validateSctpCapabilities=ky;de.getExtendedRtpCapabilities=Ty;de.getRecvRtpCapabilities=Ey;de.getSendingRtpParameters=xy;de.getSendingRemoteRtpParameters=Py;de.reduceCodecs=Dy;de.generateProbatorRtpParameters=Ly;de.canSend=Iy;de.canReceive=My;const Yp=He,yy=Ce,wy="probator",Sy=1234,Ry=127;function by(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);for(const t of e.codecs)Oy(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)Ny(t)}function qd(e){if(typeof e!="object")throw new TypeError("params is not an object");if(e.mid&&typeof e.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");for(const t of e.codecs)Ay(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)jy(t);if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);for(const t of e.encodings)$y(t);if(e.rtcp&&typeof e.rtcp!="object")throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),Fy(e.rtcp)}function Cy(e){if(typeof e!="object")throw new TypeError("params is not an object");if(typeof e.streamId!="number")throw new TypeError("missing params.streamId");let t=!1;if(typeof e.ordered=="boolean"?t=!0:e.ordered=!0,e.maxPacketLifeTime&&typeof e.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&typeof e.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!t&&(e.maxPacketLifeTime||e.maxRetransmits)&&(e.ordered=!1),e.label&&typeof e.label!="string")throw new TypeError("invalid params.label");if(e.protocol&&typeof e.protocol!="string")throw new TypeError("invalid params.protocol")}function ky(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(!e.numStreams||typeof e.numStreams!="object")throw new TypeError("missing caps.numStreams");zy(e.numStreams)}function Ty(e,t,r){const n={codecs:[],headerExtensions:[]};if(r)for(const s of e.codecs??[]){if(gs(s))continue;const i=(t.codecs??[]).find(a=>$l(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={mimeType:s.mimeType,kind:s.kind,clockRate:s.clockRate,channels:s.channels,localPayloadType:s.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:i.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:s.parameters,remoteParameters:i.parameters,rtcpFeedback:Xp(s,i)};n.codecs.push(o)}else for(const s of t.codecs??[]){if(gs(s))continue;const i=(e.codecs??[]).find(a=>$l(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={mimeType:i.mimeType,kind:i.kind,clockRate:i.clockRate,channels:i.channels,localPayloadType:i.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:s.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:i.parameters,remoteParameters:s.parameters,rtcpFeedback:Xp(i,s)};n.codecs.push(o)}for(const s of n.codecs){const i=e.codecs.find(a=>gs(a)&&a.parameters.apt===s.localPayloadType),o=t.codecs.find(a=>gs(a)&&a.parameters.apt===s.remotePayloadType);i&&o&&(s.localRtxPayloadType=i.preferredPayloadType,s.remoteRtxPayloadType=o.preferredPayloadType)}for(const s of t.headerExtensions){const i=e.headerExtensions.find(a=>By(a,s));if(!i)continue;const o={kind:s.kind,uri:s.uri,sendId:i.preferredId,recvId:s.preferredId,encrypt:i.preferredEncrypt,direction:"sendrecv"};switch(s.direction){case"sendrecv":{o.direction="sendrecv";break}case"recvonly":{o.direction="sendonly";break}case"sendonly":{o.direction="recvonly";break}case"inactive":{o.direction="inactive";break}}n.headerExtensions.push(o)}return n}function Ey(e){const t={codecs:[],headerExtensions:[]};for(const r of e.codecs){const n={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(t.codecs.push(n),!r.remoteRtxPayloadType)continue;const s={mimeType:`${r.kind}/rtx`,kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};t.codecs.push(s)}for(const r of e.headerExtensions){if(r.direction!=="sendrecv"&&r.direction!=="recvonly")continue;const n={kind:r.kind,uri:r.uri,preferredId:r.recvId,preferredEncrypt:r.encrypt,direction:r.direction};t.headerExtensions.push(n)}return t}function xy(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const s={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(s),n.localRtxPayloadType){const i={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(i)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const s={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(s)}return r}function Py(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const s={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.remoteParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(s),n.localRtxPayloadType){const i={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(i)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const s={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(s)}if(r.headerExtensions.some(n=>n.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="goog-remb");else if(r.headerExtensions.some(n=>n.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc");else for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc"&&s.type!=="goog-remb");return r}function Dy(e,t){const r=[];if(!t)r.push(e[0]),gs(e[1])&&r.push(e[1]);else{for(let n=0;n<e.length;++n)if($l(e[n],t,{strict:!0})){r.push(e[n]),gs(e[n+1])&&r.push(e[n+1]);break}if(r.length===0)throw new TypeError("no matching codec found")}return r}function Ly(e){e=yy.clone(e),qd(e);const t={mid:wy,codecs:[],headerExtensions:[],encodings:[{ssrc:Sy}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=Ry,t.headerExtensions=e.headerExtensions,t}function Iy(e,t){return t.codecs.some(r=>r.kind===e)}function My(e,t){if(qd(e),e.codecs.length===0)return!1;const r=e.codecs[0];return t.codecs.some(n=>n.remotePayloadType===r.payloadType)}function Oy(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&typeof e.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");e.kind==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const n of Object.keys(e.parameters)){let s=e.parameters[n];if(s===void 0&&(e.parameters[n]="",s=""),typeof s!="string"&&typeof s!="number")throw new TypeError(`invalid codec parameter [key:${n}s, value:${s}]`);if(n==="apt"&&typeof s!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const n of e.rtcpFeedback)Em(n)}function Em(e){if(typeof e!="object")throw new TypeError("fb is not an object");if(!e.type||typeof e.type!="string")throw new TypeError("missing fb.type");(!e.parameter||typeof e.parameter!="string")&&(e.parameter="")}function Ny(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(e.kind!=="audio"&&e.kind!=="video")throw new TypeError("invalid ext.kind");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.preferredId!="number")throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&typeof e.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&typeof e.direction!="string")throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function Ay(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(typeof e.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");r[1].toLowerCase()==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const s of Object.keys(e.parameters)){let i=e.parameters[s];if(i===void 0&&(e.parameters[s]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${s}s, value:${i}]`);if(s==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const s of e.rtcpFeedback)Em(s)}function jy(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.id!="number")throw new TypeError("missing ext.id");if(e.encrypt&&typeof e.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const t of Object.keys(e.parameters)){let r=e.parameters[t];if(r===void 0&&(e.parameters[t]="",r=""),typeof r!="string"&&typeof r!="number")throw new TypeError("invalid header extension parameter")}}function $y(e){if(typeof e!="object")throw new TypeError("encoding is not an object");if(e.ssrc&&typeof e.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(e.rid&&typeof e.rid!="string")throw new TypeError("invalid encoding.rid");if(e.rtx&&typeof e.rtx!="object")throw new TypeError("invalid encoding.rtx");if(e.rtx&&typeof e.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!e.dtx||typeof e.dtx!="boolean")&&(e.dtx=!1),e.scalabilityMode&&typeof e.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function Fy(e){if(typeof e!="object")throw new TypeError("rtcp is not an object");if(e.cname&&typeof e.cname!="string")throw new TypeError("invalid rtcp.cname");(!e.reducedSize||typeof e.reducedSize!="boolean")&&(e.reducedSize=!0)}function zy(e){if(typeof e!="object")throw new TypeError("numStreams is not an object");if(typeof e.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof e.MIS!="number")throw new TypeError("missing numStreams.MIS")}function gs(e){return e?/.+\/rtx$/i.test(e.mimeType):!1}function $l(e,t,{strict:r=!1,modify:n=!1}={}){const s=e.mimeType.toLowerCase(),i=t.mimeType.toLowerCase();if(s!==i||e.clockRate!==t.clockRate||e.channels!==t.channels)return!1;switch(s){case"video/h264":{if(r){const o=e.parameters["packetization-mode"]??0,a=t.parameters["packetization-mode"]??0;if(o!==a||!Yp.isSameProfile(e.parameters,t.parameters))return!1;let c;try{c=Yp.generateProfileLevelIdStringForAnswer(e.parameters,t.parameters)}catch{return!1}n&&(c?(e.parameters["profile-level-id"]=c,t.parameters["profile-level-id"]=c):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break}case"video/vp9":{if(r){const o=e.parameters["profile-id"]??0,a=t.parameters["profile-id"]??0;if(o!==a)return!1}break}}return!0}function By(e,t){return!(e.kind&&t.kind&&e.kind!==t.kind||e.uri!==t.uri)}function Xp(e,t){const r=[];for(const n of e.rtcpFeedback??[]){const s=(t.rtcpFeedback??[]).find(i=>i.type===n.type&&(i.parameter===n.parameter||!i.parameter&&!n.parameter));s&&r.push(s)}return r}var io={},xm={},Ya={},Xa={};Object.defineProperty(Xa,"__esModule",{value:!0});Xa.Logger=void 0;const es=Qa,ts="awaitqueue";class Uy{constructor(t){v(this,"_debug");v(this,"_warn");v(this,"_error");t?(this._debug=es(`${ts}:${t}`),this._warn=es(`${ts}:WARN:${t}`),this._error=es(`${ts}:ERROR:${t}`)):(this._debug=es(ts),this._warn=es(`${ts}:WARN`),this._error=es(`${ts}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}Xa.Logger=Uy;var Mn={};Object.defineProperty(Mn,"__esModule",{value:!0});Mn.AwaitQueueRemovedTaskError=Mn.AwaitQueueStoppedError=void 0;class Gd extends Error{constructor(t){super(t??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Gd)}}Mn.AwaitQueueStoppedError=Gd;class Yd extends Error{constructor(t){super(t??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Yd)}}Mn.AwaitQueueRemovedTaskError=Yd;Object.defineProperty(Ya,"__esModule",{value:!0});Ya.AwaitQueue=void 0;const Vy=Xa,Jp=Mn,Rr=new Vy.Logger("AwaitQueue");class Hy{constructor(){v(this,"pendingTasks",new Map);v(this,"nextTaskId",0);v(this,"stopping",!1);Rr.debug("constructor()")}get size(){return this.pendingTasks.size}async push(t,r){if(r=r??t.name,Rr.debug(`push() [name:${r}]`),typeof t!="function")throw new TypeError("given task is not a function");if(r)try{Object.defineProperty(t,"name",{value:r})}catch{}return new Promise((n,s)=>{const i={id:this.nextTaskId++,task:t,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:o=>{if(i.completed)return;i.completed=!0,this.pendingTasks.delete(i.id),Rr.debug(`resolving task [name:${i.name}]`),n(o);const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)},reject:o=>{if(!i.completed&&(i.completed=!0,this.pendingTasks.delete(i.id),Rr.debug(`rejecting task [name:${i.name}]: %s`,String(o)),s(o),!this.stopping)){const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)}}};this.pendingTasks.set(i.id,i),this.pendingTasks.size===1&&this.execute(i)})}stop(){Rr.debug("stop()"),this.stopping=!0;for(const t of this.pendingTasks.values())Rr.debug(`stop() | stopping task [name:${t.name}]`),t.reject(new Jp.AwaitQueueStoppedError);this.stopping=!1}remove(t){Rr.debug(`remove() [taskIdx:${t}]`);const r=Array.from(this.pendingTasks.values())[t];if(!r){Rr.debug(`stop() | no task with given idx [taskIdx:${t}]`);return}r.reject(new Jp.AwaitQueueRemovedTaskError)}dump(){const t=Date.now();let r=0;return Array.from(this.pendingTasks.values()).map(n=>({idx:r++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:t-n.enqueuedAt,executionTime:n.executedAt?t-n.executedAt:0}))}async execute(t){if(Rr.debug(`execute() [name:${t.name}]`),t.executedAt)throw new Error("task already being executed");t.executedAt=Date.now();try{const r=await t.task();t.resolve(r)}catch(r){t.reject(r)}}}Ya.AwaitQueue=Hy;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=Ya;Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var r=Mn;Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return r.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return r.AwaitQueueRemovedTaskError}})})(xm);var oo={};Object.defineProperty(oo,"__esModule",{value:!0});oo.Producer=void 0;const Ky=we,Zp=Ht,rs=Le,Wt=new Ky.Logger("Producer");class Qy extends Zp.EnhancedEventEmitter{constructor({id:r,localId:n,rtpSender:s,track:i,rtpParameters:o,stopTracks:a,disableTrackOnPause:c,zeroRtpOnPause:l,appData:u}){super();v(this,"_id");v(this,"_localId");v(this,"_closed",!1);v(this,"_rtpSender");v(this,"_track");v(this,"_kind");v(this,"_rtpParameters");v(this,"_paused");v(this,"_maxSpatialLayer");v(this,"_stopTracks");v(this,"_disableTrackOnPause");v(this,"_zeroRtpOnPause");v(this,"_appData");v(this,"_observer",new Zp.EnhancedEventEmitter);Wt.debug("constructor()"),this._id=r,this._localId=n,this._rtpSender=s,this._track=i,this._kind=i.kind,this._rtpParameters=o,this._paused=c?!i.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=a,this._disableTrackOnPause=c,this._zeroRtpOnPause=l,this._appData=u??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(Wt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Wt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new rs.InvalidStateError("closed");return new Promise((r,n)=>{this.safeEmit("@getstats",r,n)})}pause(){if(Wt.debug("pause()"),this._closed){Wt.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((r,n)=>{this.safeEmit("@pause",r,n)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(Wt.debug("resume()"),this._closed){Wt.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((r,n)=>{this.safeEmit("@resume",r,n)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:r}){if(Wt.debug("replaceTrack() [track:%o]",r),this._closed){if(r&&this._stopTracks)try{r.stop()}catch{}throw new rs.InvalidStateError("closed")}else if(r&&r.readyState==="ended")throw new rs.InvalidStateError("track ended");if(r===this._track){Wt.debug("replaceTrack() | same track, ignored");return}await new Promise((n,s)=>{this.safeEmit("@replacetrack",r,n,s)}),this.destroyTrack(),this._track=r,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(r){if(this._closed)throw new rs.InvalidStateError("closed");if(this._kind!=="video")throw new rs.UnsupportedError("not a video Producer");if(typeof r!="number")throw new TypeError("invalid spatialLayer");r!==this._maxSpatialLayer&&(await new Promise((n,s)=>{this.safeEmit("@setmaxspatiallayer",r,n,s)}).catch(()=>{}),this._maxSpatialLayer=r)}async setRtpEncodingParameters(r){if(this._closed)throw new rs.InvalidStateError("closed");if(typeof r!="object")throw new TypeError("invalid params");await new Promise((n,s)=>{this.safeEmit("@setrtpencodingparameters",r,n,s)})}onTrackEnded(){Wt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}oo.Producer=Qy;var ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.Consumer=void 0;const Wy=we,ef=Ht,qy=Le,qt=new Wy.Logger("Consumer");class Gy extends ef.EnhancedEventEmitter{constructor({id:r,localId:n,producerId:s,rtpReceiver:i,track:o,rtpParameters:a,appData:c}){super();v(this,"_id");v(this,"_localId");v(this,"_producerId");v(this,"_closed",!1);v(this,"_rtpReceiver");v(this,"_track");v(this,"_rtpParameters");v(this,"_paused");v(this,"_appData");v(this,"_observer",new ef.EnhancedEventEmitter);qt.debug("constructor()"),this._id=r,this._localId=n,this._producerId=s,this._rtpReceiver=i,this._track=o,this._rtpParameters=a,this._paused=!o.enabled,this._appData=c??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(qt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(qt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new qy.InvalidStateError("closed");return new Promise((r,n)=>{this.safeEmit("@getstats",r,n)})}pause(){if(qt.debug("pause()"),this._closed){qt.error("pause() | Consumer closed");return}if(this._paused){qt.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(qt.debug("resume()"),this._closed){qt.error("resume() | Consumer closed");return}if(!this._paused){qt.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){qt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}ao.Consumer=Gy;var co={};Object.defineProperty(co,"__esModule",{value:!0});co.DataProducer=void 0;const Yy=we,tf=Ht,Xy=Le,br=new Yy.Logger("DataProducer");class Jy extends tf.EnhancedEventEmitter{constructor({id:r,dataChannel:n,sctpStreamParameters:s,appData:i}){super();v(this,"_id");v(this,"_dataChannel");v(this,"_closed",!1);v(this,"_sctpStreamParameters");v(this,"_appData");v(this,"_observer",new tf.EnhancedEventEmitter);br.debug("constructor()"),this._id=r,this._dataChannel=n,this._sctpStreamParameters=s,this._appData=i??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(r){this._dataChannel.bufferedAmountLowThreshold=r}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(br.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(br.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(r){if(br.debug("send()"),this._closed)throw new Xy.InvalidStateError("closed");this._dataChannel.send(r)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(br.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",r=>{if(this._closed)return;let{error:n}=r;n||(n=new Error("unknown DataChannel error")),n.errorDetail==="sctp-failure"?br.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):br.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(br.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||br.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}co.DataProducer=Jy;var lo={};Object.defineProperty(lo,"__esModule",{value:!0});lo.DataConsumer=void 0;const Zy=we,rf=Ht,hn=new Zy.Logger("DataConsumer");class ew extends rf.EnhancedEventEmitter{constructor({id:r,dataProducerId:n,dataChannel:s,sctpStreamParameters:i,appData:o}){super();v(this,"_id");v(this,"_dataProducerId");v(this,"_dataChannel");v(this,"_closed",!1);v(this,"_sctpStreamParameters");v(this,"_appData");v(this,"_observer",new rf.EnhancedEventEmitter);hn.debug("constructor()"),this._id=r,this._dataProducerId=n,this._dataChannel=s,this._sctpStreamParameters=i,this._appData=o??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(r){this._dataChannel.binaryType=r}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(hn.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(hn.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(hn.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",r=>{if(this._closed)return;let{error:n}=r;n||(n=new Error("unknown DataChannel error")),n.errorDetail==="sctp-failure"?hn.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):hn.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(hn.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",r=>{this._closed||this.safeEmit("message",r.data)})}}lo.DataConsumer=ew;Object.defineProperty(io,"__esModule",{value:!0});io.Transport=void 0;const tw=xm,rw=we,nf=Ht,Ae=Le,Gc=Ce,pi=de,nw=oo,sw=ao,iw=co,ow=lo,Pe=new rw.Logger("Transport");class aw{constructor(t){v(this,"consumerOptions");v(this,"promise");v(this,"resolve");v(this,"reject");this.consumerOptions=t,this.promise=new Promise((r,n)=>{this.resolve=r,this.reject=n})}}let cw=class extends nf.EnhancedEventEmitter{constructor({direction:r,id:n,iceParameters:s,iceCandidates:i,dtlsParameters:o,sctpParameters:a,iceServers:c,iceTransportPolicy:l,additionalSettings:u,proprietaryConstraints:d,appData:p,handlerFactory:f,extendedRtpCapabilities:y,canProduceByKind:w}){super();v(this,"_id");v(this,"_closed",!1);v(this,"_direction");v(this,"_extendedRtpCapabilities");v(this,"_canProduceByKind");v(this,"_maxSctpMessageSize");v(this,"_handler");v(this,"_iceGatheringState","new");v(this,"_connectionState","new");v(this,"_appData");v(this,"_producers",new Map);v(this,"_consumers",new Map);v(this,"_dataProducers",new Map);v(this,"_dataConsumers",new Map);v(this,"_probatorConsumerCreated",!1);v(this,"_awaitQueue",new tw.AwaitQueue);v(this,"_pendingConsumerTasks",[]);v(this,"_consumerCreationInProgress",!1);v(this,"_pendingPauseConsumers",new Map);v(this,"_consumerPauseInProgress",!1);v(this,"_pendingResumeConsumers",new Map);v(this,"_consumerResumeInProgress",!1);v(this,"_pendingCloseConsumers",new Map);v(this,"_consumerCloseInProgress",!1);v(this,"_observer",new nf.EnhancedEventEmitter);Pe.debug("constructor() [id:%s, direction:%s]",n,r),this._id=n,this._direction=r,this._extendedRtpCapabilities=y,this._canProduceByKind=w,this._maxSctpMessageSize=a?a.maxMessageSize:null;const b=Gc.clone(u)??{};delete b.iceServers,delete b.iceTransportPolicy,delete b.bundlePolicy,delete b.rtcpMuxPolicy,delete b.sdpSemantics,this._handler=f(),this._handler.run({direction:r,iceParameters:s,iceCandidates:i,dtlsParameters:o,sctpParameters:a,iceServers:c,iceTransportPolicy:l,additionalSettings:b,proprietaryConstraints:d,extendedRtpCapabilities:y}),this._appData=p??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){if(!this._closed){Pe.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const r of this._producers.values())r.transportClosed();this._producers.clear();for(const r of this._consumers.values())r.transportClosed();this._consumers.clear();for(const r of this._dataProducers.values())r.transportClosed();this._dataProducers.clear();for(const r of this._dataConsumers.values())r.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new Ae.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:r}){if(Pe.debug("restartIce()"),this._closed)throw new Ae.InvalidStateError("closed");if(!r)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(r),"transport.restartIce()")}async updateIceServers({iceServers:r}={}){if(Pe.debug("updateIceServers()"),this._closed)throw new Ae.InvalidStateError("closed");if(!Array.isArray(r))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(r),"transport.updateIceServers()")}async produce({track:r,encodings:n,codecOptions:s,codec:i,stopTracks:o=!0,disableTrackOnPause:a=!0,zeroRtpOnPause:c=!1,onRtpSender:l,appData:u={}}={}){if(Pe.debug("produce() [track:%o]",r),this._closed)throw new Ae.InvalidStateError("closed");if(r){if(this._direction!=="send")throw new Ae.UnsupportedError("not a sending Transport");if(this._canProduceByKind[r.kind]){if(r.readyState==="ended")throw new Ae.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(u&&typeof u!="object")throw new TypeError("if given, appData must be an object")}else throw new Ae.UnsupportedError(`cannot produce ${r.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let d;if(n&&!Array.isArray(n))throw TypeError("encodings must be an array");n&&n.length===0?d=void 0:n&&(d=n.map(w=>{const b={active:!0};return w.active===!1&&(b.active=!1),typeof w.dtx=="boolean"&&(b.dtx=w.dtx),typeof w.scalabilityMode=="string"&&(b.scalabilityMode=w.scalabilityMode),typeof w.scaleResolutionDownBy=="number"&&(b.scaleResolutionDownBy=w.scaleResolutionDownBy),typeof w.maxBitrate=="number"&&(b.maxBitrate=w.maxBitrate),typeof w.maxFramerate=="number"&&(b.maxFramerate=w.maxFramerate),typeof w.adaptivePtime=="boolean"&&(b.adaptivePtime=w.adaptivePtime),typeof w.priority=="string"&&(b.priority=w.priority),typeof w.networkPriority=="string"&&(b.networkPriority=w.networkPriority),b}));const{localId:p,rtpParameters:f,rtpSender:y}=await this._handler.send({track:r,encodings:d,codecOptions:s,codec:i,onRtpSender:l});try{pi.validateRtpParameters(f);const{id:w}=await new Promise((h,g)=>{this.safeEmit("produce",{kind:r.kind,rtpParameters:f,appData:u},h,g)}),b=new nw.Producer({id:w,localId:p,rtpSender:y,track:r,rtpParameters:f,stopTracks:o,disableTrackOnPause:a,zeroRtpOnPause:c,appData:u});return this._producers.set(b.id,b),this.handleProducer(b),this._observer.safeEmit("newproducer",b),b}catch(w){throw this._handler.stopSending(p).catch(()=>{}),w}},"transport.produce()").catch(d=>{if(o)try{r.stop()}catch{}throw d})}async consume({id:r,producerId:n,kind:s,rtpParameters:i,streamId:o,onRtpReceiver:a,appData:c={}}){if(Pe.debug("consume()"),this._closed)throw new Ae.InvalidStateError("closed");if(this._direction!=="recv")throw new Ae.UnsupportedError("not a receiving Transport");if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing producerId");if(s!=="audio"&&s!=="video")throw new TypeError(`invalid kind '${s}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(c&&typeof c!="object")throw new TypeError("if given, appData must be an object");const l=Gc.clone(i);if(!pi.canReceive(l,this._extendedRtpCapabilities))throw new Ae.UnsupportedError("cannot consume this Producer");const d=new aw({id:r,producerId:n,kind:s,rtpParameters:l,streamId:o,onRtpReceiver:a,appData:c});return this._pendingConsumerTasks.push(d),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),d.promise}async produceData({ordered:r=!0,maxPacketLifeTime:n,maxRetransmits:s,label:i="",protocol:o="",appData:a={}}={}){if(Pe.debug("produceData()"),this._closed)throw new Ae.InvalidStateError("closed");if(this._direction!=="send")throw new Ae.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new Ae.UnsupportedError("SCTP not enabled by remote Transport");return(n||s)&&(r=!1),this._awaitQueue.push(async()=>{const{dataChannel:c,sctpStreamParameters:l}=await this._handler.sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o});pi.validateSctpStreamParameters(l);const{id:u}=await new Promise((p,f)=>{this.safeEmit("producedata",{sctpStreamParameters:l,label:i,protocol:o,appData:a},p,f)}),d=new iw.DataProducer({id:u,dataChannel:c,sctpStreamParameters:l,appData:a});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d},"transport.produceData()")}async consumeData({id:r,dataProducerId:n,sctpStreamParameters:s,label:i="",protocol:o="",appData:a={}}){if(Pe.debug("consumeData()"),this._closed)throw new Ae.InvalidStateError("closed");if(this._direction!=="recv")throw new Ae.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new Ae.UnsupportedError("SCTP not enabled by remote Transport");const c=Gc.clone(s);return pi.validateSctpStreamParameters(c),this._awaitQueue.push(async()=>{const{dataChannel:l}=await this._handler.receiveDataChannel({sctpStreamParameters:c,label:i,protocol:o}),u=new ow.DataConsumer({id:r,dataProducerId:n,dataChannel:l,sctpStreamParameters:c,appData:a});return this._dataConsumers.set(u.id,u),this.handleDataConsumer(u),this._observer.safeEmit("newdataconsumer",u),u},"transport.consumeData()")}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){Pe.debug("createPendingConsumers() | there is no Consumer to be created");return}const r=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let n;const s=[];for(const i of r){const{id:o,kind:a,rtpParameters:c,streamId:l,onRtpReceiver:u}=i.consumerOptions;s.push({trackId:o,kind:a,rtpParameters:c,streamId:l,onRtpReceiver:u})}try{const i=await this._handler.receive(s);for(let o=0;o<i.length;++o){const a=r[o],c=i[o],{id:l,producerId:u,kind:d,rtpParameters:p,appData:f}=a.consumerOptions,{localId:y,rtpReceiver:w,track:b}=c,h=new sw.Consumer({id:l,localId:y,producerId:u,rtpReceiver:w,track:b,rtpParameters:p,appData:f});this._consumers.set(h.id,h),this.handleConsumer(h),!this._probatorConsumerCreated&&!n&&d==="video"&&(n=h),this._observer.safeEmit("newconsumer",h),a.resolve(h)}}catch(i){for(const o of r)o.reject(i)}if(n)try{const i=pi.generateProbatorRtpParameters(n.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:i}]),Pe.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(i){Pe.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",i)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){Pe.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const r=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const n=r.map(s=>s.localId);await this._handler.pauseReceiving(n)}catch(n){Pe.error("pausePendingConsumers() | failed to pause Consumers:",n)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){Pe.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const r=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const n=r.map(s=>s.localId);await this._handler.resumeReceiving(n)}catch(n){Pe.error("resumePendingConsumers() | failed to resume Consumers:",n)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){Pe.debug("closePendingConsumers() | there is no Consumer to be closed");return}const r=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(r.map(n=>n.localId))}catch(n){Pe.error("closePendingConsumers() | failed to close Consumers:",n)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const r=this._handler;r.on("@connect",({dtlsParameters:n},s,i)=>{if(this._closed){i(new Ae.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:n},s,i)}),r.on("@icegatheringstatechange",n=>{n!==this._iceGatheringState&&(Pe.debug("ICE gathering state changed to %s",n),this._iceGatheringState=n,this._closed||this.safeEmit("icegatheringstatechange",n))}),r.on("@icecandidateerror",n=>{Pe.warn(`ICE candidate error [url:${n.url}, localAddress:${n.address}, localPort:${n.port}]: ${n.errorCode} "${n.errorText}"`),this.safeEmit("icecandidateerror",n)}),r.on("@connectionstatechange",n=>{n!==this._connectionState&&(Pe.debug("connection state changed to %s",n),this._connectionState=n,this._closed||this.safeEmit("connectionstatechange",n))})}handleProducer(r){r.on("@close",()=>{this._producers.delete(r.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(r.localId),"producer @close event").catch(n=>Pe.warn("producer.close() failed:%o",n))}),r.on("@pause",(n,s)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(r.localId),"producer @pause event").then(n).catch(s)}),r.on("@resume",(n,s)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(r.localId),"producer @resume event").then(n).catch(s)}),r.on("@replacetrack",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(r.localId,n),"producer @replacetrack event").then(s).catch(i)}),r.on("@setmaxspatiallayer",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(r.localId,n),"producer @setmaxspatiallayer event").then(s).catch(i)}),r.on("@setrtpencodingparameters",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(r.localId,n),"producer @setrtpencodingparameters event").then(s).catch(i)}),r.on("@getstats",(n,s)=>{if(this._closed)return s(new Ae.InvalidStateError("closed"));this._handler.getSenderStats(r.localId).then(n).catch(s)})}handleConsumer(r){r.on("@close",()=>{this._consumers.delete(r.id),this._pendingPauseConsumers.delete(r.id),this._pendingResumeConsumers.delete(r.id),!this._closed&&(this._pendingCloseConsumers.set(r.id,r),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),r.on("@pause",()=>{this._pendingResumeConsumers.has(r.id)&&this._pendingResumeConsumers.delete(r.id),this._pendingPauseConsumers.set(r.id,r),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),r.on("@resume",()=>{this._pendingPauseConsumers.has(r.id)&&this._pendingPauseConsumers.delete(r.id),this._pendingResumeConsumers.set(r.id,r),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),r.on("@getstats",(n,s)=>{if(this._closed)return s(new Ae.InvalidStateError("closed"));this._handler.getReceiverStats(r.localId).then(n).catch(s)})}handleDataProducer(r){r.on("@close",()=>{this._dataProducers.delete(r.id)})}handleDataConsumer(r){r.on("@close",()=>{this._dataConsumers.delete(r.id)})}};io.Transport=cw;var Ja={},ke={},Pm={},Dm={exports:{}},sf=Dm.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(sf).forEach(function(e){var t=sf[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var Xd=Dm.exports;(function(e){var t=function(a){return String(Number(a))===a?Number(a):a},r=function(a,c,l,u){if(u&&!l)c[u]=t(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=t(a[d+1]))},n=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;r(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},s=Xd,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(i).forEach(function(d){var p=d[0],f=d.slice(2);p==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var y=0;y<(s[p]||[]).length;y+=1){var w=s[p][y];if(w.reg.test(f))return n(w,u,f)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=t(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};e.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(a){return a.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(t),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},e.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=t(l):(u=t(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(Pm);var Yc=Xd,lw=/%[sdv%]/g,dw=function(e){var t=1,r=arguments,n=r.length;return e.replace(lw,function(s){if(t>=n)return s;var i=r[t];switch(t+=1,s){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},fi=function(e,t,r){var n=t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format,s=[e+"="+n];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?s.push(r[t.name][o]):s.push(r[t.names[i]])}else s.push(r[t.name]);return dw.apply(null,s)},uw=["v","o","s","i","u","e","p","c","b","t","r","z","a"],pw=["i","c","b","a"],fw=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(i){i.payloads==null&&(i.payloads="")});var r=t.outerOrder||uw,n=t.innerOrder||pw,s=[];return r.forEach(function(i){Yc[i].forEach(function(o){o.name in e&&e[o.name]!=null?s.push(fi(i,o,e)):o.push in e&&e[o.push]!=null&&e[o.push].forEach(function(a){s.push(fi(i,o,a))})})}),e.media.forEach(function(i){s.push(fi("m",Yc.m[0],i)),n.forEach(function(o){Yc[o].forEach(function(a){a.name in i&&i[a.name]!=null?s.push(fi(o,a,i)):a.push in i&&i[a.push]!=null&&i[a.push].forEach(function(c){s.push(fi(o,a,c))})})})}),s.join(`\r
`)+`\r
`},zn=Pm,hw=fw,mw=Xd;ke.grammar=mw;ke.write=hw;ke.parse=zn.parse;ke.parseParams=zn.parseParams;ke.parseFmtpConfig=zn.parseFmtpConfig;ke.parsePayloads=zn.parsePayloads;ke.parseRemoteCandidates=zn.parseRemoteCandidates;ke.parseImageAttributes=zn.parseImageAttributes;ke.parseSimulcastStreamList=zn.parseSimulcastStreamList;var it={};Object.defineProperty(it,"__esModule",{value:!0});it.extractRtpCapabilities=gw;it.extractDtlsParameters=vw;it.getCname=_w;it.applyCodecParameters=yw;const Lm=ke;function gw({sdpObject:e}){const t=new Map,r=[];let n=!1,s=!1;for(const o of e.media){const a=o.type;switch(a){case"audio":{if(n)continue;n=!0;break}case"video":{if(s)continue;s=!0;break}default:continue}for(const c of o.rtp){const l={kind:a,mimeType:`${a}/${c.codec}`,preferredPayloadType:c.payload,clockRate:c.rate,channels:c.encoding,parameters:{},rtcpFeedback:[]};t.set(l.preferredPayloadType,l)}for(const c of o.fmtp??[]){const l=Lm.parseParams(c.config),u=t.get(c.payload);u&&(l!=null&&l.hasOwnProperty("profile-level-id")&&(l["profile-level-id"]=String(l["profile-level-id"])),u.parameters=l)}for(const c of o.rtcpFb??[]){const l={type:c.type,parameter:c.subtype};if(l.parameter||delete l.parameter,c.payload!=="*"){const u=t.get(c.payload);if(!u)continue;u.rtcpFeedback.push(l)}else for(const u of t.values())u.kind===a&&!/.+\/rtx$/i.test(u.mimeType)&&u.rtcpFeedback.push(l)}for(const c of o.ext??[]){if(c["encrypt-uri"])continue;const l={kind:a,uri:c.uri,preferredId:c.value};r.push(l)}}return{codecs:Array.from(t.values()),headerExtensions:r}}function vw({sdpObject:e}){let t=e.setup,r=e.fingerprint;if(!t||!r){const i=(e.media??[]).find(o=>o.port!==0);i&&(t??(t=i.setup),r??(r=i.fingerprint))}if(t){if(!r)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let n;switch(t){case"active":{n="client";break}case"passive":{n="server";break}case"actpass":{n="auto";break}}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}}function _w({offerMediaObject:e}){const t=(e.ssrcs??[]).find(r=>r.attribute==="cname");return t?t.value:""}function yw({offerRtpParameters:e,answerMediaObject:t}){for(const r of e.codecs){const n=r.mimeType.toLowerCase();if(n!=="audio/opus"||!(t.rtp??[]).find(a=>a.payload===r.payloadType))continue;t.fmtp=t.fmtp??[];let i=t.fmtp.find(a=>a.payload===r.payloadType);i||(i={payload:r.payloadType,config:""},t.fmtp.push(i));const o=Lm.parseParams(i.config);switch(n){case"audio/opus":{const a=r.parameters["sprop-stereo"];a!==void 0&&(o.stereo=Number(a)?1:0);break}}i.config="";for(const a of Object.keys(o))i.config&&(i.config+=";"),i.config+=`${a}=${o[a]}`}}var ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.getRtpEncodings=ww;ur.addLegacySimulcast=Sw;function ww({offerMediaObject:e}){const t=new Set;for(const s of e.ssrcs??[]){const i=s.id;t.add(i)}if(t.size===0)throw new Error("no a=ssrc lines found");const r=new Map;for(const s of e.ssrcGroups??[]){if(s.semantics!=="FID")continue;let[i,o]=s.ssrcs.split(/\s+/);i=Number(i),o=Number(o),t.has(i)&&(t.delete(i),t.delete(o),r.set(i,o))}for(const s of t)r.set(s,null);const n=[];for(const[s,i]of r){const o={ssrc:s};i&&(o.rtx={ssrc:i}),n.push(o)}return n}function Sw({offerMediaObject:e,numStreams:t}){if(t<=1)throw new TypeError("numStreams must be greater than 1");const r=(e.ssrcs??[]).find(d=>d.attribute==="msid");if(!r)throw new Error("a=ssrc line with msid information not found");const[n,s]=r.value.split(" "),i=Number(r.id);let o;(e.ssrcGroups??[]).some(d=>{if(d.semantics!=="FID")return!1;const p=d.ssrcs.split(/\s+/);return Number(p[0])===i?(o=Number(p[1]),!0):!1});const a=e.ssrcs.find(d=>d.attribute==="cname");if(!a)throw new Error("a=ssrc line with cname information not found");const c=a.value,l=[],u=[];for(let d=0;d<t;++d)l.push(i+d),o&&u.push(o+d);e.ssrcGroups=[],e.ssrcs=[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const d of l)e.ssrcs.push({id:d,attribute:"cname",value:c}),e.ssrcs.push({id:d,attribute:"msid",value:`${n} ${s}`});for(let d=0;d<u.length;++d){const p=l[d],f=u[d];e.ssrcs.push({id:f,attribute:"cname",value:c}),e.ssrcs.push({id:f,attribute:"msid",value:`${n} ${s}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${p} ${f}`})}}var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.addNackSupportForOpus=Rw;function Rw(e){var t;for(const r of e.codecs??[])(r.mimeType.toLowerCase()==="audio/opus"||r.mimeType.toLowerCase()==="audio/multiopus")&&!((t=r.rtcpFeedback)!=null&&t.some(n=>n.type==="nack"&&!n.parameter))&&(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}var We={};Object.defineProperty(We,"__esModule",{value:!0});We.HandlerInterface=void 0;const bw=Ht;class Cw extends bw.EnhancedEventEmitter{constructor(){super()}}We.HandlerInterface=Cw;var gt={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.OfferMediaSection=Xr.AnswerMediaSection=Xr.MediaSection=void 0;const kw=ke,of=Ce;class Jd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:s=!1}){v(this,"_mediaObject");v(this,"_planB");if(this._mediaObject={},this._planB=s,t&&this.setIceParameters(t),r){this._mediaObject.candidates=[];for(const i of r){const o={};o.component=1,o.foundation=i.foundation,o.ip=i.address??i.ip,o.port=i.port,o.priority=i.priority,o.transport=i.protocol,o.type=i.type,i.tcpType&&(o.tcptype=i.tcpType),this._mediaObject.candidates.push(o)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}n&&this.setDtlsRole(n.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(t){this._mediaObject.iceUfrag=t.usernameFragment,this._mediaObject.icePwd=t.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}Xr.MediaSection=Jd;class Tw extends Jd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1,offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:u}){switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a.mid),this._mediaObject.type=a.type,this._mediaObject.protocol=a.protocol,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),a.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const d of l.codecs){const p={payload:d.payloadType,codec:Fl(d),rate:d.clockRate};d.channels>1&&(p.encoding=d.channels),this._mediaObject.rtp.push(p);const f=of.clone(d.parameters)??{};let y=of.clone(d.rtcpFeedback)??[];if(u){const{opusStereo:b,opusFec:h,opusDtx:g,opusMaxPlaybackRate:m,opusMaxAverageBitrate:_,opusPtime:S,opusNack:R,videoGoogleStartBitrate:E,videoGoogleMaxBitrate:P,videoGoogleMinBitrate:C}=u,A=c.codecs.find(x=>x.payloadType===d.payloadType);switch(d.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{b!==void 0&&(A.parameters["sprop-stereo"]=b?1:0,f.stereo=b?1:0),h!==void 0&&(A.parameters.useinbandfec=h?1:0,f.useinbandfec=h?1:0),g!==void 0&&(A.parameters.usedtx=g?1:0,f.usedtx=g?1:0),m!==void 0&&(f.maxplaybackrate=m),_!==void 0&&(f.maxaveragebitrate=_),S!==void 0&&(A.parameters.ptime=S,f.ptime=S),R||(A.rtcpFeedback=A.rtcpFeedback.filter(x=>x.type!=="nack"||x.parameter),y=y.filter(x=>x.type!=="nack"||x.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{E!==void 0&&(f["x-google-start-bitrate"]=E),P!==void 0&&(f["x-google-max-bitrate"]=P),C!==void 0&&(f["x-google-min-bitrate"]=C);break}}}const w={payload:d.payloadType,config:""};for(const b of Object.keys(f))w.config&&(w.config+=";"),w.config+=`${b}=${f[b]}`;w.config&&this._mediaObject.fmtp.push(w);for(const b of y)this._mediaObject.rtcpFb.push({payload:d.payloadType,type:b.type,subtype:b.parameter})}this._mediaObject.payloads=l.codecs.map(d=>d.payloadType).join(" "),this._mediaObject.ext=[];for(const d of l.headerExtensions)(a.ext??[]).some(f=>f.uri===d.uri)&&this._mediaObject.ext.push({uri:d.uri,value:d.id});if(a.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),a.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:a.simulcast.list1},this._mediaObject.rids=[];for(const d of a.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}else if(a.simulcast_03){this._mediaObject.simulcast_03={value:a.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const d of a.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof a.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize):a.sctpmap&&(this._mediaObject.payloads=s.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize});break}}}setDtlsRole(t){switch(t){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(t){var i,o;if(!((i=this._mediaObject.simulcast)!=null&&i.list1))return;const r={};for(const a of t)a.rid&&(r[a.rid]=a);const n=this._mediaObject.simulcast.list1,s=kw.parseSimulcastStreamList(n);for(const a of s)for(const c of a)c.paused=!((o=r[c.scid])!=null&&o.active);this._mediaObject.simulcast.list1=s.map(a=>a.map(c=>`${c.paused?"~":""}${c.scid}`).join(",")).join(";")}}Xr.AnswerMediaSection=Tw;class Ew extends Jd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1,mid:a,kind:c,offerRtpParameters:l,streamId:u,trackId:d,oldDataChannelSpec:p=!1}){var f;switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a),this._mediaObject.type=c,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},s?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",c){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${u??"-"} ${d}`);for(const h of l.codecs){const g={payload:h.payloadType,codec:Fl(h),rate:h.clockRate};h.channels>1&&(g.encoding=h.channels),this._mediaObject.rtp.push(g);const m={payload:h.payloadType,config:""};for(const _ of Object.keys(h.parameters))m.config&&(m.config+=";"),m.config+=`${_}=${h.parameters[_]}`;m.config&&this._mediaObject.fmtp.push(m);for(const _ of h.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:h.payloadType,type:_.type,subtype:_.parameter})}this._mediaObject.payloads=l.codecs.map(h=>h.payloadType).join(" "),this._mediaObject.ext=[];for(const h of l.headerExtensions)this._mediaObject.ext.push({uri:h.uri,value:h.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const y=l.encodings[0],w=y.ssrc,b=(f=y.rtx)==null?void 0:f.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:w,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:w,attribute:"msid",value:`${u??"-"} ${d}`}),b&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:b,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:b,attribute:"msid",value:`${u??"-"} ${d}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${w} ${b}`}));break}case"application":{p?(this._mediaObject.payloads=s.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize);break}}}setDtlsRole(t){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:t,streamId:r,trackId:n}){var c;const s=t.encodings[0],i=s.ssrc,o=(c=s.rtx)==null?void 0:c.ssrc,a=this._mediaObject.payloads.split(" ");for(const l of t.codecs){if(a.includes(String(l.payloadType)))continue;const u={payload:l.payloadType,codec:Fl(l),rate:l.clockRate};l.channels>1&&(u.encoding=l.channels),this._mediaObject.rtp.push(u);const d={payload:l.payloadType,config:""};for(const p of Object.keys(l.parameters))d.config&&(d.config+=";"),d.config+=`${p}=${l.parameters[p]}`;d.config&&this._mediaObject.fmtp.push(d);for(const p of l.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:l.payloadType,type:p.type,subtype:p.parameter})}this._mediaObject.payloads+=` ${t.codecs.filter(l=>!this._mediaObject.payloads.includes(l.payloadType)).map(l=>l.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),t.rtcp.cname&&this._mediaObject.ssrcs.push({id:i,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:i,attribute:"msid",value:`${r??"-"} ${n}`}),o&&(t.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:`${r??"-"} ${n}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${i} ${o}`}))}planBStopReceiving({offerRtpParameters:t}){var i;const r=t.encodings[0],n=r.ssrc,s=(i=r.rtx)==null?void 0:i.ssrc;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(o=>o.id!==n&&o.id!==s),s&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(o=>o.ssrcs!==`${n} ${s}`))}}Xr.OfferMediaSection=Ew;function Fl(e){const r=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");return r[2]}Object.defineProperty(gt,"__esModule",{value:!0});gt.RemoteSdp=void 0;const xw=ke,Pw=we,ko=Xr,To=new Pw.Logger("RemoteSdp");class Dw{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1}){v(this,"_iceParameters");v(this,"_iceCandidates");v(this,"_dtlsParameters");v(this,"_sctpParameters");v(this,"_plainRtpParameters");v(this,"_planB");v(this,"_mediaSections",[]);v(this,"_midToIndex",new Map);v(this,"_firstMid");v(this,"_sdpObject");if(this._iceParameters=t,this._iceCandidates=r,this._dtlsParameters=n,this._sctpParameters=s,this._plainRtpParameters=i,this._planB=o,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},t!=null&&t.iceLite&&(this._sdpObject.icelite="ice-lite"),n){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const a=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:n.fingerprints[a-1].algorithm,hash:n.fingerprints[a-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}i&&(this._sdpObject.origin.address=i.ip,this._sdpObject.origin.ipVer=i.ipVersion)}updateIceParameters(t){To.debug("updateIceParameters() [iceParameters:%o]",t),this._iceParameters=t,this._sdpObject.icelite=t.iceLite?"ice-lite":void 0;for(const r of this._mediaSections)r.setIceParameters(t)}updateDtlsRole(t){To.debug("updateDtlsRole() [role:%s]",t),this._dtlsParameters.role=t;for(const r of this._mediaSections)r.setDtlsRole(t)}setSessionExtmapAllowMixed(){To.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let t=0;t<this._mediaSections.length;++t){const r=this._mediaSections[t];if(r.closed)return{idx:t,reuseMid:r.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:t,reuseMid:r,offerRtpParameters:n,answerRtpParameters:s,codecOptions:i}){const o=new ko.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:n,answerRtpParameters:s,codecOptions:i});r?this._replaceMediaSection(o,r):this._midToIndex.has(o.mid)?this._replaceMediaSection(o):this._addMediaSection(o)}receive({mid:t,kind:r,offerRtpParameters:n,streamId:s,trackId:i}){const o=this._midToIndex.get(t);let a;if(o!==void 0&&(a=this._mediaSections[o]),this.setSessionExtmapAllowMixed(),a)a.planBReceive({offerRtpParameters:n,streamId:s,trackId:i}),this._replaceMediaSection(a);else{a=new ko.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:t,kind:r,offerRtpParameters:n,streamId:s,trackId:i});const c=this._mediaSections.find(l=>l.closed);c?this._replaceMediaSection(a,c.mid):this._addMediaSection(a)}}pauseMediaSection(t){this._findMediaSection(t).pause()}resumeSendingMediaSection(t){this._findMediaSection(t).resume()}resumeReceivingMediaSection(t){this._findMediaSection(t).resume()}disableMediaSection(t){this._findMediaSection(t).disable()}closeMediaSection(t){const r=this._findMediaSection(t);return t===this._firstMid?(To.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",t),this.disableMediaSection(t),!1):(r.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(t,r){const n=this._findMediaSection(t);n.muxSimulcastStreams(r),this._replaceMediaSection(n)}planBStopReceiving({mid:t,offerRtpParameters:r}){const n=this._findMediaSection(t);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}sendSctpAssociation({offerMediaObject:t}){const r=new ko.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(r)}receiveSctpAssociation({oldDataChannelSpec:t=!1}={}){const r=new ko.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:t});this._addMediaSection(r)}getSdp(){return this._sdpObject.origin.sessionVersion++,xw.write(this._sdpObject)}_addMediaSection(t){this._firstMid||(this._firstMid=t.mid),this._mediaSections.push(t),this._midToIndex.set(t.mid,this._mediaSections.length-1),this._sdpObject.media.push(t.getObject()),this._regenerateBundleMids()}_replaceMediaSection(t,r){if(typeof r=="string"){const n=this._midToIndex.get(r);if(n===void 0)throw new Error(`no media section found for reuseMid '${r}'`);const s=this._mediaSections[n];this._mediaSections[n]=t,this._midToIndex.delete(s.mid),this._midToIndex.set(t.mid,n),this._sdpObject.media[n]=t.getObject(),this._regenerateBundleMids()}else{const n=this._midToIndex.get(t.mid);if(n===void 0)throw new Error(`no media section found with mid '${t.mid}'`);this._mediaSections[n]=t,this._sdpObject.media[n]=t.getObject()}}_findMediaSection(t){const r=this._midToIndex.get(t);if(r===void 0)throw new Error(`no media section found with mid '${t}'`);return this._mediaSections[r]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(t=>!t.closed).map(t=>t.mid).join(" "))}}gt.RemoteSdp=Dw;var pr={};Object.defineProperty(pr,"__esModule",{value:!0});pr.parse=Iw;const Lw=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function Iw(e){const t=Lw.exec(e??"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}Object.defineProperty(Ja,"__esModule",{value:!0});Ja.Chrome111=void 0;const $r=ke,Mw=we,af=Ce,ns=de,Eo=it,cf=ur,Ow=Gs,Nw=Le,Aw=We,jw=gt,$w=pr,V=new Mw.Logger("Chrome111"),Fw="Chrome111",lf={OS:1024,MIS:1024};class Zd extends Aw.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new Zd}get name(){return Fw}close(){if(V.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){V.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=$r.parse(n.sdp),i=Eo.extractRtpCapabilities({sdpObject:s});return Ow.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return V.debug("getNativeSctpCapabilities()"),{numStreams:lf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),V.debug("run()"),this._direction=r,this._remoteSdp=new jw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ns.getSendingRtpParameters("audio",d),video:ns.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ns.getSendingRemoteRtpParameters("audio",d),video:ns.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(V.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(r){this.assertNotClosed(),V.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),V.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});V.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){if(this.assertNotClosed(),this.assertSendDirection(),V.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1){let b=1;for(const h of n){const g=h.scalabilityMode?(0,$w.parse)(h.scalabilityMode).temporalLayers:3;g>b&&(b=g)}n.forEach((h,g)=>{h.rid=`r${g}`,h.scalabilityMode=`L1T${b}`})}const a=af.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=ns.reduceCodecs(a.codecs,i);const c=af.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=ns.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(u.sender);const d=await this._pc.createOffer();let p=$r.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p}),V.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const f=u.mid;a.mid=f,p=$r.parse(this._pc.localDescription.sdp);const y=p.media[l.idx];if(a.rtcp.cname=Eo.getCname({offerMediaObject:y}),!n)a.encodings=cf.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const b=cf.getRtpEncodings({offerMediaObject:y});Object.assign(b[0],n[0]),a.encodings=b}else a.encodings=n;this._remoteSdp.send({offerMediaObject:y,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return V.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(f,u),{localId:f,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),V.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();V.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),V.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();V.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),V.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();V.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?V.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):V.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),V.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();V.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),V.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();V.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};V.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%lf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=$r.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),V.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;V.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=$r.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Eo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:$r.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),V.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){V.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){V.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){V.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};V.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=$r.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=$r.parse(this._pc.localDescription.sdp));const s=Eo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Nw.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ja.Chrome111=Zd;var Za={};Object.defineProperty(Za,"__esModule",{value:!0});Za.Chrome74=void 0;const Gt=ke,zw=we,df=Ce,ss=de,xo=it,Xc=ur,Bw=Gs,Uw=Le,Vw=We,Hw=gt,Kw=pr,F=new zw.Logger("Chrome74"),Qw="Chrome74",uf={OS:1024,MIS:1024};class eu extends Vw.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new eu}get name(){return Qw}close(){if(F.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){F.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=Gt.parse(n.sdp),i=xo.extractRtpCapabilities({sdpObject:s});return Bw.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return F.debug("getNativeSctpCapabilities()"),{numStreams:uf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){F.debug("run()"),this._direction=r,this._remoteSdp=new Hw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ss.getSendingRtpParameters("audio",d),video:ss.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ss.getSendingRemoteRtpParameters("audio",d),video:ss.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(F.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(r){this.assertNotClosed(),F.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),F.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});F.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();F.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),this.assertSendDirection(),F.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((h,g)=>{h.rid=`r${g}`});const o=df.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=ss.reduceCodecs(o.codecs,i);const a=df.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=ss.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});let u=await this._pc.createOffer(),d=Gt.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d});let f=!1;const y=(0,Kw.parse)((n??[{}])[0].scalabilityMode);n&&n.length===1&&y.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(F.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,d=Gt.parse(u.sdp),p=d.media[c.idx],Xc.addLegacySimulcast({offerMediaObject:p,numStreams:y.spatialLayers}),u={type:"offer",sdp:Gt.write(d)}),F.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u);const w=l.mid;if(o.mid=w,d=Gt.parse(this._pc.localDescription.sdp),p=d.media[c.idx],o.rtcp.cname=xo.getCname({offerMediaObject:p}),!n)o.encodings=Xc.getRtpEncodings({offerMediaObject:p});else if(n.length===1){let h=Xc.getRtpEncodings({offerMediaObject:p});Object.assign(h[0],n[0]),f&&(h=[h[0]]),o.encodings=h}else o.encodings=n;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const h of o.encodings)h.scalabilityMode?h.scalabilityMode=`L1T${y.temporalLayers}`:h.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return F.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,l),{localId:w,rtpParameters:o,rtpSender:l.sender}}async stopSending(r){if(this.assertSendDirection(),F.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();F.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),F.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();F.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),F.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();F.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?F.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):F.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),F.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();F.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),F.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();F.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};F.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%uf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Gt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),F.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};F.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;F.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=Gt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);xo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:Gt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),F.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){F.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();F.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){F.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();F.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){F.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();F.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};F.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};F.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Gt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}F.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Gt.parse(this._pc.localDescription.sdp));const s=xo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Uw.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Za.Chrome74=eu;var ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.Chrome70=void 0;const Ct=ke,Ww=we,pf=Ce,is=de,Po=it,Jc=ur,qw=We,Gw=gt,Yw=pr,Y=new Ww.Logger("Chrome70"),Xw="Chrome70",ff={OS:1024,MIS:1024};class tu extends qw.HandlerInterface{constructor(){super();v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new tu}get name(){return Xw}close(){if(Y.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){Y.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=Ct.parse(n.sdp);return Po.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return Y.debug("getNativeSctpCapabilities()"),{numStreams:ff}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){Y.debug("run()"),this._direction=r,this._remoteSdp=new Gw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:is.getSendingRtpParameters("audio",d),video:is.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:is.getSendingRemoteRtpParameters("audio",d),video:is.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Y.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){Y.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(Y.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});Y.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Y.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),Y.debug("send() [kind:%s, track.id:%s]",r.kind,r.id);const o=pf.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=is.reduceCodecs(o.codecs,i);const a=pf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=is.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});let u=await this._pc.createOffer(),d=Ct.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),n&&n.length>1&&(Y.debug("send() | enabling legacy simulcast"),d=Ct.parse(u.sdp),p=d.media[c.idx],Jc.addLegacySimulcast({offerMediaObject:p,numStreams:n.length}),u={type:"offer",sdp:Ct.write(d)});let f=!1;const y=(0,Yw.parse)((n??[{}])[0].scalabilityMode);if(n&&n.length===1&&y.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(Y.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,d=Ct.parse(u.sdp),p=d.media[c.idx],Jc.addLegacySimulcast({offerMediaObject:p,numStreams:y.spatialLayers}),u={type:"offer",sdp:Ct.write(d)}),Y.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),n){Y.debug("send() | applying given encodings");const h=l.sender.getParameters();for(let g=0;g<(h.encodings??[]).length;++g){const m=h.encodings[g],_=n[g];if(!_)break;h.encodings[g]=Object.assign(m,_)}await l.sender.setParameters(h)}const w=l.mid;if(o.mid=w,d=Ct.parse(this._pc.localDescription.sdp),p=d.media[c.idx],o.rtcp.cname=Po.getCname({offerMediaObject:p}),o.encodings=Jc.getRtpEncodings({offerMediaObject:p}),n)for(let h=0;h<o.encodings.length;++h)n[h]&&Object.assign(o.encodings[h],n[h]);if(f&&(o.encodings=[o.encodings[0]]),o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const h of o.encodings)h.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return Y.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,l),{localId:w,rtpParameters:o,rtpSender:l.sender}}async stopSending(r){this.assertSendDirection(),Y.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();Y.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?Y.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Y.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),Y.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();Y.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),Y.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();Y.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};Y.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%ff.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Ct.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),Y.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;Y.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=Ct.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Po.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:Ct.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),Y.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){Y.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Y.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};Y.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Ct.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}Y.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Ct.parse(this._pc.localDescription.sdp));const s=Po.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ec.Chrome70=tu;var tc={},Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.getRtpEncodings=Jw;Bn.addLegacySimulcast=Zw;function Jw({offerMediaObject:e,track:t}){const r=new Set;for(const i of e.ssrcs??[]){if(i.attribute!=="msid")continue;if(i.value.split(" ")[1]===t.id){const a=i.id;r.add(a)}}if(r.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);const n=new Map;for(const i of e.ssrcGroups??[]){if(i.semantics!=="FID")continue;let[o,a]=i.ssrcs.split(/\s+/);o=Number(o),a=Number(a),r.has(o)&&(r.delete(o),r.delete(a),n.set(o,a))}for(const i of r)n.set(i,null);const s=[];for(const[i,o]of n){const a={ssrc:i};o&&(a.rtx={ssrc:o}),s.push(a)}return s}function Zw({offerMediaObject:e,track:t,numStreams:r}){if(r<=1)throw new TypeError("numStreams must be greater than 1");let n,s,i;if(!(e.ssrcs??[]).find(d=>d.attribute!=="msid"?!1:d.value.split(" ")[1]===t.id?(n=d.id,i=d.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);(e.ssrcGroups??[]).some(d=>{if(d.semantics!=="FID")return!1;const p=d.ssrcs.split(/\s+/);return Number(p[0])===n?(s=Number(p[1]),!0):!1});const a=e.ssrcs.find(d=>d.attribute==="cname"&&d.id===n);if(!a)throw new Error(`a=ssrc line with cname information not found [track.id:${t.id}]`);const c=a.value,l=[],u=[];for(let d=0;d<r;++d)l.push(n+d),s&&u.push(s+d);e.ssrcGroups=e.ssrcGroups??[],e.ssrcs=e.ssrcs??[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const d of l)e.ssrcs.push({id:d,attribute:"cname",value:c}),e.ssrcs.push({id:d,attribute:"msid",value:`${i} ${t.id}`});for(let d=0;d<u.length;++d){const p=l[d],f=u[d];e.ssrcs.push({id:f,attribute:"cname",value:c}),e.ssrcs.push({id:f,attribute:"msid",value:`${i} ${t.id}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${p} ${f}`})}}Object.defineProperty(tc,"__esModule",{value:!0});tc.Chrome67=void 0;const Yt=ke,eS=we,hf=Ce,os=de,Do=it,mf=Bn,tS=We,rS=gt,Z=new eS.Logger("Chrome67"),nS="Chrome67",gf={OS:1024,MIS:1024};class ru extends tS.HandlerInterface{constructor(){super();v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_sendStream",new MediaStream);v(this,"_mapSendLocalIdRtpSender",new Map);v(this,"_nextSendLocalId",0);v(this,"_mapRecvLocalIdInfo",new Map);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new ru}get name(){return nS}close(){if(Z.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){Z.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Yt.parse(n.sdp);return Do.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return Z.debug("getNativeSctpCapabilities()"),{numStreams:gf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){Z.debug("run()"),this._direction=r,this._remoteSdp=new rS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:os.getSendingRtpParameters("audio",d),video:os.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:os.getSendingRemoteRtpParameters("audio",d),video:os.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Z.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){Z.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(Z.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});Z.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};Z.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};Z.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Z.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),Z.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&Z.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream);let o=await this._pc.createOffer(),a=Yt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=hf.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=os.reduceCodecs(l.codecs);const u=hf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=os.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(Z.debug("send() | enabling simulcast"),a=Yt.parse(o.sdp),c=a.media.find(y=>y.type==="video"),mf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Yt.write(a)}),Z.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Yt.parse(this._pc.localDescription.sdp),c=a.media.find(y=>y.type===r.kind),l.rtcp.cname=Do.getCname({offerMediaObject:c}),l.encodings=mf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let y=0;y<l.encodings.length;++y)n[y]&&Object.assign(l.encodings[y],n[y]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const y of l.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};Z.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const f=this._pc.getSenders().find(y=>y.track===r);return this._mapSendLocalIdRtpSender.set(p,f),{localId:p,rtpParameters:l,rtpSender:f}}async stopSending(r){this.assertSendDirection(),Z.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(n),n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(r);const s=await this._pc.createOffer();Z.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){Z.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};Z.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?Z.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Z.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.track;await s.replaceTrack(n),i&&this._sendStream.removeTrack(i),n&&this._sendStream.addTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),Z.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),Z.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");return n.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};Z.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%gf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Yt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),Z.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};Z.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;Z.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};Z.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Yt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);Do.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Yt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),Z.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=l,p=c,f=this._pc.getReceivers().find(y=>y.track&&y.track.id===d);if(!f)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(d,{mid:p,rtpParameters:u,rtpReceiver:f}),n.push({localId:d,track:f.track,rtpReceiver:f})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){Z.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Z.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Z.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){this.assertRecvDirection();const{rtpReceiver:n}=this._mapRecvLocalIdInfo.get(r)??{};if(!n)throw new Error("associated RTCRtpReceiver not found");return n.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};Z.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};Z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Yt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}Z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Yt.parse(this._pc.localDescription.sdp));const s=Do.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}tc.Chrome67=ru;var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.Chrome55=void 0;const Xt=ke,sS=we,hi=Le,vf=Ce,as=de,Lo=it,_f=Bn,iS=We,oS=gt,ie=new sS.Logger("Chrome55"),aS="Chrome55",yf={OS:1024,MIS:1024};class nu extends iS.HandlerInterface{constructor(){super();v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_sendStream",new MediaStream);v(this,"_mapSendLocalIdTrack",new Map);v(this,"_nextSendLocalId",0);v(this,"_mapRecvLocalIdInfo",new Map);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new nu}get name(){return aS}close(){if(ie.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){ie.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Xt.parse(n.sdp);return Lo.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return ie.debug("getNativeSctpCapabilities()"),{numStreams:yf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ie.debug("run()"),this._direction=r,this._remoteSdp=new oS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:as.getSendingRtpParameters("audio",d),video:as.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:as.getSendingRemoteRtpParameters("audio",d),video:as.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(ie.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){ie.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(ie.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ie.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ie.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),ie.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&ie.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream);let o=await this._pc.createOffer(),a=Xt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=vf.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=as.reduceCodecs(l.codecs);const u=vf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=as.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(ie.debug("send() | enabling simulcast"),a=Xt.parse(o.sdp),c=a.media.find(f=>f.type==="video"),_f.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Xt.write(a)}),ie.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Xt.parse(this._pc.localDescription.sdp),c=a.media.find(f=>f.type===r.kind),l.rtcp.cname=Lo.getCname({offerMediaObject:c}),l.encodings=_f.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let f=0;f<l.encodings.length;++f)n[f]&&Object.assign(l.encodings[f],n[f]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of l.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,r),{localId:p,rtpParameters:l}}async stopSending(r){this.assertSendDirection(),ie.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdTrack.get(r);if(!n)throw new Error("track not found");this._mapSendLocalIdTrack.delete(r),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();ie.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){ie.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){throw new hi.UnsupportedError("not implemented")}async setMaxSpatialLayer(r,n){throw new hi.UnsupportedError(" not implemented")}async setRtpEncodingParameters(r,n){throw new hi.UnsupportedError("not supported")}async getSenderStats(r){throw new hi.UnsupportedError("not implemented")}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};ie.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%yf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Xt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ie.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ie.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;ie.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Xt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);Lo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Xt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),ie.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=c,p=l,f=a.streamId??u.rtcp.cname,w=this._pc.getRemoteStreams().find(b=>b.id===f).getTrackById(p);if(!w)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:u}),n.push({localId:p,track:w})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){ie.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ie.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){throw new hi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};ie.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};ie.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Xt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ie.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Xt.parse(this._pc.localDescription.sdp));const s=Lo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}rc.Chrome55=nu;var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.Firefox120=void 0;const Fr=ke,cS=we,wf=Le,Sf=Ce,cs=de,Io=it,Rf=ur,lS=We,dS=gt,uS=pr,K=new cS.Logger("Firefox120"),pS="Firefox120",bf={OS:16,MIS:2048};class su extends lS.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new su}get name(){return pS}close(){if(K.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){K.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),n=document.createElement("canvas");n.getContext("2d");const i=n.captureStream().getVideoTracks()[0];try{r.addTransceiver("audio",{direction:"sendrecv"}),r.addTransceiver(i,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const o=await r.createOffer();try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}const a=Fr.parse(o.sdp);return Io.extractRtpCapabilities({sdpObject:a})}catch(o){try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}throw o}}async getNativeSctpCapabilities(){return K.debug("getNativeSctpCapabilities()"),{numStreams:bf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),K.debug("run()"),this._direction=r,this._remoteSdp=new dS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:cs.getSendingRtpParameters("audio",d),video:cs.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:cs.getSendingRemoteRtpParameters("audio",d),video:cs.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(K.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){throw this.assertNotClosed(),new wf.UnsupportedError("not supported")}async restartIce(r){if(this.assertNotClosed(),K.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});K.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();K.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),K.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((b,h)=>{b.rid=`r${h}`});const a=Sf.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=cs.reduceCodecs(a.codecs,i);const c=Sf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=cs.reduceCodecs(c.codecs,i);const l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(l.sender);const u=await this._pc.createOffer();let d=Fr.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d});const p=(0,uS.parse)((n??[{}])[0].scalabilityMode);K.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u);const f=l.mid;a.mid=f,d=Fr.parse(this._pc.localDescription.sdp);const y=d.media[d.media.length-1];if(a.rtcp.cname=Io.getCname({offerMediaObject:y}),!n)a.encodings=Rf.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const b=Rf.getRtpEncodings({offerMediaObject:y});Object.assign(b[0],n[0]),a.encodings=b}else a.encodings=n;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const b of a.encodings)b.scalabilityMode?b.scalabilityMode=`L1T${p.temporalLayers}`:b.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return K.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(f,l),{localId:f,rtpParameters:a,rtpSender:l.sender}}async stopSending(r){if(this.assertSendDirection(),K.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated transceiver not found");n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid);const s=await this._pc.createOffer();K.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),K.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();K.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),K.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();K.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?K.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):K.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),K.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated transceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();K.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),K.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();K.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};K.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%bf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Fr.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),K.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;K.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=Fr.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Io.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p}),o={type:"answer",sdp:Fr.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),K.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){K.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();K.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){K.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();K.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){K.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();K.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};K.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Fr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:f})}K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Fr.parse(this._pc.localDescription.sdp));const s=Io.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new wf.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}nc.Firefox120=su;var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.Firefox60=void 0;const zr=ke,fS=we,Cf=Le,Zc=Ce,ls=de,Mo=it,kf=ur,hS=We,mS=gt,gS=pr,Q=new fS.Logger("Firefox60"),vS="Firefox60",Tf={OS:16,MIS:2048};class iu extends hS.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new iu}get name(){return vS}close(){if(Q.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){Q.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),n=document.createElement("canvas");n.getContext("2d");const i=n.captureStream().getVideoTracks()[0];try{r.addTransceiver("audio",{direction:"sendrecv"});const o=r.addTransceiver(i,{direction:"sendrecv"}),a=o.sender.getParameters(),c=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];a.encodings=c,await o.sender.setParameters(a);const l=await r.createOffer();try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}const u=zr.parse(l.sdp);return Mo.extractRtpCapabilities({sdpObject:u})}catch(o){try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}throw o}}async getNativeSctpCapabilities(){return Q.debug("getNativeSctpCapabilities()"),{numStreams:Tf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),Q.debug("run()"),this._direction=r,this._remoteSdp=new mS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ls.getSendingRtpParameters("audio",d),video:ls.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ls.getSendingRemoteRtpParameters("audio",d),video:ls.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Q.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){throw this.assertNotClosed(),new Cf.UnsupportedError("not supported")}async restartIce(r){if(this.assertNotClosed(),Q.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});Q.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Q.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),this.assertSendDirection(),Q.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&(n=Zc.clone(n),n.forEach((w,b)=>{w.rid=`r${b}`}),n.reverse());const o=Zc.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=ls.reduceCodecs(o.codecs,i);const a=Zc.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=ls.reduceCodecs(a.codecs,i);const c=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});if(n){const w=c.sender.getParameters();w.encodings=n,await c.sender.setParameters(w)}const l=await this._pc.createOffer();let u=zr.parse(l.sdp);u.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:u});const d=(0,gS.parse)((n??[{}])[0].scalabilityMode);Q.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const p=c.mid;o.mid=p,u=zr.parse(this._pc.localDescription.sdp);const f=u.media[u.media.length-1];if(o.rtcp.cname=Mo.getCname({offerMediaObject:f}),!n)o.encodings=kf.getRtpEncodings({offerMediaObject:f});else if(n.length===1){const w=kf.getRtpEncodings({offerMediaObject:f});Object.assign(w[0],n[0]),o.encodings=w}else o.encodings=n.reverse();if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const w of o.encodings)w.scalabilityMode?w.scalabilityMode=`L1T${d.temporalLayers}`:w.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const y={type:"answer",sdp:this._remoteSdp.getSdp()};return Q.debug("send() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),this._mapMidTransceiver.set(p,c),{localId:p,rtpParameters:o,rtpSender:c.sender}}async stopSending(r){if(this.assertSendDirection(),Q.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated transceiver not found");n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid);const s=await this._pc.createOffer();Q.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),Q.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();Q.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),Q.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();Q.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?Q.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Q.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),Q.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated transceiver not found");const i=s.sender.getParameters();n=i.encodings.length-1-n,i.encodings.forEach((c,l)=>{l>=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();Q.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),Q.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();Q.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};Q.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Tf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=zr.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),Q.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;Q.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=zr.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Mo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p}),o={type:"answer",sdp:zr.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),Q.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){Q.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Q.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){Q.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Q.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){Q.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Q.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};Q.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=zr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:f})}Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=zr.parse(this._pc.localDescription.sdp));const s=Mo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Cf.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}sc.Firefox60=iu;var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.Safari12=void 0;const Jt=ke,_S=we,Ef=Ce,ds=de,Oo=it,xf=ur,yS=Gs,wS=Le,SS=We,RS=gt,bS=pr,z=new _S.Logger("Safari12"),CS="Safari12",Pf={OS:1024,MIS:1024};class ou extends SS.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new ou}get name(){return CS}close(){if(z.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){z.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=Jt.parse(n.sdp),i=Oo.extractRtpCapabilities({sdpObject:s});return yS.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return z.debug("getNativeSctpCapabilities()"),{numStreams:Pf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),z.debug("run()"),this._direction=r,this._remoteSdp=new RS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ds.getSendingRtpParameters("audio",d),video:ds.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ds.getSendingRemoteRtpParameters("audio",d),video:ds.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(z.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){this.assertNotClosed(),z.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),z.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});z.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),z.debug("send() [kind:%s, track.id:%s]",r.kind,r.id);const a=Ef.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=ds.reduceCodecs(a.codecs,i);const c=Ef.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=ds.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});o&&o(u.sender);let d=await this._pc.createOffer(),p=Jt.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let f;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});const y=(0,bS.parse)((n??[{}])[0].scalabilityMode);n&&n.length>1&&(z.debug("send() | enabling legacy simulcast"),p=Jt.parse(d.sdp),f=p.media[l.idx],xf.addLegacySimulcast({offerMediaObject:f,numStreams:n.length}),d={type:"offer",sdp:Jt.write(p)}),z.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const w=u.mid;if(a.mid=w,p=Jt.parse(this._pc.localDescription.sdp),f=p.media[l.idx],a.rtcp.cname=Oo.getCname({offerMediaObject:f}),a.encodings=xf.getRtpEncodings({offerMediaObject:f}),n)for(let h=0;h<a.encodings.length;++h)n[h]&&Object.assign(a.encodings[h],n[h]);if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const h of a.encodings)h.scalabilityMode?h.scalabilityMode=`L1T${y.temporalLayers}`:h.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return z.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,u),{localId:w,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),this._closed)return;z.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();z.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),z.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();z.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),z.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();z.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?z.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):z.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),z.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();z.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),z.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();z.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};z.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Pf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Jt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),z.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;z.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=Jt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Oo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:Jt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),z.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){z.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){z.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){z.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};z.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Jt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Jt.parse(this._pc.localDescription.sdp));const s=Oo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new wS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ic.Safari12=ou;var oc={};Object.defineProperty(oc,"__esModule",{value:!0});oc.Safari11=void 0;const Zt=ke,kS=we,Df=Ce,us=de,No=it,Lf=Bn,TS=We,ES=gt,ee=new kS.Logger("Safari11"),xS="Safari11",If={OS:1024,MIS:1024};class au extends TS.HandlerInterface{constructor(){super();v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_sendStream",new MediaStream);v(this,"_mapSendLocalIdRtpSender",new Map);v(this,"_nextSendLocalId",0);v(this,"_mapRecvLocalIdInfo",new Map);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new au}get name(){return xS}close(){if(ee.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){ee.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Zt.parse(n.sdp);return No.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return ee.debug("getNativeSctpCapabilities()"),{numStreams:If}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ee.debug("run()"),this._direction=r,this._remoteSdp=new ES.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:us.getSendingRtpParameters("audio",d),video:us.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:us.getSendingRemoteRtpParameters("audio",d),video:us.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(ee.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){ee.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(ee.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ee.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ee.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),ee.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&ee.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream);let o=await this._pc.createOffer(),a=Zt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=Df.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=us.reduceCodecs(l.codecs);const u=Df.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=us.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(ee.debug("send() | enabling simulcast"),a=Zt.parse(o.sdp),c=a.media.find(y=>y.type==="video"),Lf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Zt.write(a)}),ee.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Zt.parse(this._pc.localDescription.sdp),c=a.media.find(y=>y.type===r.kind),l.rtcp.cname=No.getCname({offerMediaObject:c}),l.encodings=Lf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let y=0;y<l.encodings.length;++y)n[y]&&Object.assign(l.encodings[y],n[y]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const y of l.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const f=this._pc.getSenders().find(y=>y.track===r);return this._mapSendLocalIdRtpSender.set(p,f),{localId:p,rtpParameters:l,rtpSender:f}}async stopSending(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(r);const s=await this._pc.createOffer();ee.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){ee.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?ee.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):ee.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.track;await s.replaceTrack(n),i&&this._sendStream.removeTrack(i),n&&this._sendStream.addTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),ee.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),ee.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");return n.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};ee.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%If.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Zt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ee.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;ee.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Zt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);No.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Zt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),ee.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=c,p=l,f=this._pc.getReceivers().find(y=>y.track&&y.track.id===p);if(!f)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:u,rtpReceiver:f}),n.push({localId:p,track:f.track,rtpReceiver:f})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){ee.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ee.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const{rtpReceiver:n}=this._mapRecvLocalIdInfo.get(r)??{};if(!n)throw new Error("associated RTCRtpReceiver not found");return n.getStats()}async pauseReceiving(r){}async resumeReceiving(r){}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};ee.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Zt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ee.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Zt.parse(this._pc.localDescription.sdp));const s=No.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}oc.Safari11=au;var ac={},cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.getCapabilities=PS;cc.mangleRtpParameters=DS;const Im=Ce;function PS(){const e=RTCRtpReceiver.getCapabilities(),t=Im.clone(e);for(const r of t.codecs??[]){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType??`${r.kind}/${r.name}`,r.parameters){const n=r.parameters;n.apt&&(n.apt=Number(n.apt)),n["packetization-mode"]&&(n["packetization-mode"]=Number(n["packetization-mode"]))}for(const n of r.rtcpFeedback??[])n.parameter||(n.parameter="")}return t}function DS(e){const t=Im.clone(e);t.mid&&(t.muxId=t.mid,delete t.mid);for(const r of t.codecs)r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return t}Object.defineProperty(ac,"__esModule",{value:!0});ac.Edge11=void 0;const LS=we,el=Le,Ao=Ce,tl=de,rl=cc,IS=We,ae=new LS.Logger("Edge11"),MS="Edge11";class cu extends IS.HandlerInterface{constructor(){super();v(this,"_sendingRtpParametersByKind");v(this,"_remoteIceParameters");v(this,"_remoteIceCandidates");v(this,"_remoteDtlsParameters");v(this,"_iceGatherer");v(this,"_iceTransport");v(this,"_dtlsTransport");v(this,"_rtpSenders",new Map);v(this,"_rtpReceivers",new Map);v(this,"_nextSendLocalId",0);v(this,"_cname");v(this,"_transportReady",!1)}static createFactory(){return()=>new cu}get name(){return MS}close(){ae.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const r of this._rtpSenders.values())try{r.stop()}catch{}for(const r of this._rtpReceivers.values())try{r.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return ae.debug("getNativeRtpCapabilities()"),rl.getCapabilities()}async getNativeSctpCapabilities(){return ae.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ae.debug("run()"),this._sendingRtpParametersByKind={audio:tl.getSendingRtpParameters("audio",d),video:tl.getSendingRtpParameters("video",d)},this._remoteIceParameters=n,this._remoteIceCandidates=s,this._remoteDtlsParameters=i,this._cname=`CNAME-${Ao.generateRandomNumber()}`,this.setIceGatherer({iceServers:a,iceTransportPolicy:c}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(r){throw new el.UnsupportedError("not supported")}async restartIce(r){if(ae.debug("restartIce()"),this._remoteIceParameters=r,!!this._transportReady){ae.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,r,"controlling");for(const n of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(n);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){ae.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),ae.debug("send() | calling new RTCRtpSender()");const o=new RTCRtpSender(r,this._dtlsTransport),a=Ao.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=tl.reduceCodecs(a.codecs,i);const c=a.codecs.some(d=>/.+\/rtx$/i.test(d.mimeType));n||(n=[{}]);for(const d of n)d.ssrc=Ao.generateRandomNumber(),c&&(d.rtx={ssrc:Ao.generateRandomNumber()});a.encodings=n,a.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const l=rl.mangleRtpParameters(a);ae.debug("send() | calling rtpSender.send() [params:%o]",l),await o.send(l);const u=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(u,o),{localId:u,rtpParameters:a,rtpSender:o}}async stopSending(r){ae.debug("stopSending() [localId:%s]",r);const n=this._rtpSenders.get(r);if(!n)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(r);try{ae.debug("stopSending() | calling rtpSender.stop()"),n.stop()}catch(s){throw ae.warn("stopSending() | rtpSender.stop() failed:%o",s),s}}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){n?ae.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):ae.debug("replaceTrack() [localId:%s, no track]",r);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");s.setTrack(n)}async setMaxSpatialLayer(r,n){ae.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){ae.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){const n=this._rtpSenders.get(r);if(!n)throw new Error("RTCRtpSender not found");return n.getStats()}async sendDataChannel(r){throw new el.UnsupportedError("not implemented")}async receive(r){const n=[];for(const s of r){const{trackId:i,kind:o}=s;ae.debug("receive() [trackId:%s, kind:%s]",i,o)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const s of r){const{trackId:i,kind:o,rtpParameters:a}=s;ae.debug("receive() | calling new RTCRtpReceiver()");const c=new RTCRtpReceiver(this._dtlsTransport,o);c.addEventListener("error",d=>{ae.error('rtpReceiver "error" event [event:%o]',d)});const l=rl.mangleRtpParameters(a);ae.debug("receive() | calling rtpReceiver.receive() [params:%o]",l),await c.receive(l);const u=i;this._rtpReceivers.set(u,c),n.push({localId:u,track:c.track,rtpReceiver:c})}return n}async stopReceiving(r){for(const n of r){ae.debug("stopReceiving() [localId:%s]",n);const s=this._rtpReceivers.get(n);if(!s)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(n);try{ae.debug("stopReceiving() | calling rtpReceiver.stop()"),s.stop()}catch(i){ae.warn("stopReceiving() | rtpReceiver.stop() failed:%o",i)}}}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){const n=this._rtpReceivers.get(r);if(!n)throw new Error("RTCRtpReceiver not found");return n.getStats()}async receiveDataChannel(r){throw new el.UnsupportedError("not implemented")}setIceGatherer({iceServers:r,iceTransportPolicy:n}){const s=new RTCIceGatherer({iceServers:r??[],gatherPolicy:n??"all"});s.addEventListener("error",i=>{ae.error('iceGatherer "error" event [event:%o]',i)});try{s.gather()}catch(i){ae.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=s}setIceTransport(){const r=new RTCIceTransport(this._iceGatherer);r.addEventListener("statechange",()=>{switch(r.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),r.addEventListener("icestatechange",()=>{switch(r.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),r.addEventListener("candidatepairchange",n=>{ae.debug('iceTransport "candidatepairchange" event [pair:%o]',n.pair)}),this._iceTransport=r}setDtlsTransport(){const r=new RTCDtlsTransport(this._iceTransport);r.addEventListener("statechange",()=>{ae.debug('dtlsTransport "statechange" event [state:%s]',r.state)}),r.addEventListener("dtlsstatechange",()=>{ae.debug('dtlsTransport "dtlsstatechange" event [state:%s]',r.state),r.state==="closed"&&this.emit("@connectionstatechange","closed")}),r.addEventListener("error",n=>{ae.error('dtlsTransport "error" event [event:%o]',n)}),this._dtlsTransport=r}async setupTransport({localDtlsRole:r}){ae.debug("setupTransport()");const n=this._dtlsTransport.getLocalParameters();n.role=r,await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:n},s,i)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const s of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(s);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(s=>s.algorithm==="sha-256"||s.algorithm==="sha-384"||s.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}ac.Edge11=cu;var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.ReactNativeUnifiedPlan=void 0;const er=ke,OS=we,Mf=Ce,ps=de,jo=it,nl=ur,NS=Gs,AS=Le,jS=We,$S=gt,FS=pr,$=new OS.Logger("ReactNativeUnifiedPlan"),zS="ReactNativeUnifiedPlan",Of={OS:1024,MIS:1024};class lu extends jS.HandlerInterface{constructor(){super();v(this,"_closed",!1);v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_mapMidTransceiver",new Map);v(this,"_sendStream",new MediaStream);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new lu}get name(){return zS}close(){if($.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){$.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=er.parse(n.sdp),i=jo.extractRtpCapabilities({sdpObject:s});return NS.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return $.debug("getNativeSctpCapabilities()"),{numStreams:Of}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),$.debug("run()"),this._direction=r,this._remoteSdp=new $S.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ps.getSendingRtpParameters("audio",d),video:ps.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ps.getSendingRemoteRtpParameters("audio",d),video:ps.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch($.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){this.assertNotClosed(),$.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),$.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});$.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),$.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((g,m)=>{g.rid=`r${m}`});const a=Mf.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=ps.reduceCodecs(a.codecs,i);const c=Mf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=ps.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(u.sender);let d=await this._pc.createOffer(),p=er.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let f;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});let y=!1;const w=(0,FS.parse)((n??[{}])[0].scalabilityMode);n&&n.length===1&&w.spatialLayers>1&&a.codecs[0].mimeType.toLowerCase()==="video/vp9"&&($.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,p=er.parse(d.sdp),f=p.media[l.idx],nl.addLegacySimulcast({offerMediaObject:f,numStreams:w.spatialLayers}),d={type:"offer",sdp:er.write(p)}),$.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);let b=u.mid??void 0;if(b||$.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),a.mid=b,p=er.parse(this._pc.localDescription.sdp),f=p.media[l.idx],a.rtcp.cname=jo.getCname({offerMediaObject:f}),!n)a.encodings=nl.getRtpEncodings({offerMediaObject:f});else if(n.length===1){let g=nl.getRtpEncodings({offerMediaObject:f});Object.assign(g[0],n[0]),y&&(g=[g[0]]),a.encodings=g}else a.encodings=n;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const g of a.encodings)g.scalabilityMode?g.scalabilityMode=`L1T${w.temporalLayers}`:g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const h={type:"answer",sdp:this._remoteSdp.getSdp()};return $.debug("send() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),b||(b=u.mid,a.mid=b),this._mapMidTransceiver.set(b,u),{localId:b,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),this._closed)return;$.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();$.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),$.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();$.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),$.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();$.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?$.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):$.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),$.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();$.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),$.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();$.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};$.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Of.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=er.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),$.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;$.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=er.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);jo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:er.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),$.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){$.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){$.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){$.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};$.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=er.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=er.parse(this._pc.localDescription.sdp));const s=jo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new AS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}lc.ReactNativeUnifiedPlan=lu;var dc={};Object.defineProperty(dc,"__esModule",{value:!0});dc.ReactNative=void 0;const tr=ke,BS=we,mi=Le,sl=Ce,fs=de,$o=it,Nf=Bn,US=We,VS=gt,ne=new BS.Logger("ReactNative"),HS="ReactNative",Af={OS:1024,MIS:1024};class du extends US.HandlerInterface{constructor(){super();v(this,"_direction");v(this,"_remoteSdp");v(this,"_sendingRtpParametersByKind");v(this,"_sendingRemoteRtpParametersByKind");v(this,"_forcedLocalDtlsRole");v(this,"_pc");v(this,"_sendStream",new MediaStream);v(this,"_mapSendLocalIdTrack",new Map);v(this,"_nextSendLocalId",0);v(this,"_mapRecvLocalIdInfo",new Map);v(this,"_hasDataChannelMediaSection",!1);v(this,"_nextSendSctpStreamId",0);v(this,"_transportReady",!1)}static createFactory(){return()=>new du}get name(){return HS}close(){if(ne.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){ne.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=tr.parse(n.sdp);return $o.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return ne.debug("getNativeSctpCapabilities()"),{numStreams:Af}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ne.debug("run()"),this._direction=r,this._remoteSdp=new VS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:fs.getSendingRtpParameters("audio",d),video:fs.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:fs.getSendingRemoteRtpParameters("audio",d),video:fs.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(ne.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){ne.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(ne.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ne.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ne.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ne.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ne.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),ne.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&ne.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream);let o=await this._pc.createOffer(),a=tr.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=sl.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=fs.reduceCodecs(l.codecs);const u=sl.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=fs.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(ne.debug("send() | enabling simulcast"),a=tr.parse(o.sdp),c=a.media.find(f=>f.type==="video"),Nf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:tr.write(a)}),ne.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=tr.parse(this._pc.localDescription.sdp),c=a.media.find(f=>f.type===r.kind),l.rtcp.cname=$o.getCname({offerMediaObject:c}),l.encodings=Nf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let f=0;f<l.encodings.length;++f)n[f]&&Object.assign(l.encodings[f],n[f]);if(l.encodings.length>1&&(l.codecs[0].mimeType.toLowerCase()==="video/vp8"||l.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const f of l.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};ne.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,r),{localId:p,rtpParameters:l}}async stopSending(r){this.assertSendDirection(),ne.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdTrack.get(r);if(!n)throw new Error("track not found");this._mapSendLocalIdTrack.delete(r),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();ne.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){ne.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};ne.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){throw new mi.UnsupportedError("not implemented")}async setMaxSpatialLayer(r,n){throw new mi.UnsupportedError("not implemented")}async setRtpEncodingParameters(r,n){throw new mi.UnsupportedError("not implemented")}async getSenderStats(r){throw new mi.UnsupportedError("not implemented")}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};ne.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Af.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=tr.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ne.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ne.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d}=c;ne.debug("receive() [trackId:%s, kind:%s]",l,u);const p=u;let f=c.streamId??d.rtcp.cname;ne.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),f+=`-hack-${sl.generateRandomNumber()}`,s.set(l,f),this._remoteSdp.receive({mid:p,kind:u,offerRtpParameters:d,streamId:f,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};ne.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=tr.parse(o.sdp);for(const c of r){const{kind:l,rtpParameters:u}=c,d=l,p=a.media.find(f=>String(f.mid)===d);$o.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:tr.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),ne.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{kind:l,trackId:u,rtpParameters:d}=c,p=u,f=l,y=s.get(u),b=this._pc.getRemoteStreams().find(h=>h.id===y).getTrackById(p);if(!b)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:f,rtpParameters:d}),n.push({localId:p,track:b})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){ne.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ne.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ne.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){throw new mi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};ne.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};ne.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=tr.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ne.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=tr.parse(this._pc.localDescription.sdp));const s=$o.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}dc.ReactNative=du;Object.defineProperty(Fn,"__esModule",{value:!0});Fn.Device=void 0;Fn.detectDeviceAsync=Om;Fn.detectDevice=Nm;const Mm=K_,KS=we,QS=Ht,mn=Le,jf=Ce,Br=de,WS=io,qS=Ja,GS=Za,YS=ec,XS=tc,JS=rc,ZS=nc,e0=sc,t0=ic,r0=oc,n0=ac,s0=lc,i0=dc,Me=new KS.Logger("Device");async function Om(e){Me.debug("detectDeviceAsync() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=await(0,Mm.UAParser)(e).withFeatureCheck();return Am(t)}function Nm(e){Me.debug("detectDevice() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=(0,Mm.UAParser)(e);return Am(t)}class uu{constructor({handlerName:t,handlerFactory:r}={}){v(this,"_handlerFactory");v(this,"_handlerName");v(this,"_loaded",!1);v(this,"_extendedRtpCapabilities");v(this,"_recvRtpCapabilities");v(this,"_canProduceByKind");v(this,"_sctpCapabilities");v(this,"_observer",new QS.EnhancedEventEmitter);if(Me.debug("constructor()"),t&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(t)Me.debug("constructor() | handler given: %s",t);else if(t=Nm(),t)Me.debug("constructor() | detected handler: %s",t);else throw new mn.UnsupportedError("device not supported");switch(t){case"Chrome111":{this._handlerFactory=qS.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=GS.Chrome74.createFactory();break}case"Chrome70":{this._handlerFactory=YS.Chrome70.createFactory();break}case"Chrome67":{this._handlerFactory=XS.Chrome67.createFactory();break}case"Chrome55":{this._handlerFactory=JS.Chrome55.createFactory();break}case"Firefox120":{this._handlerFactory=ZS.Firefox120.createFactory();break}case"Firefox60":{this._handlerFactory=e0.Firefox60.createFactory();break}case"Safari12":{this._handlerFactory=t0.Safari12.createFactory();break}case"Safari11":{this._handlerFactory=r0.Safari11.createFactory();break}case"Edge11":{this._handlerFactory=n0.Edge11.createFactory();break}case"ReactNativeUnifiedPlan":{this._handlerFactory=s0.ReactNativeUnifiedPlan.createFactory();break}case"ReactNative":{this._handlerFactory=i0.ReactNative.createFactory();break}default:throw new TypeError(`unknown handlerName "${t}"`)}}const n=this._handlerFactory();this._handlerName=n.name,n.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}static async factory({handlerName:t,handlerFactory:r}={}){if(Me.debug("factory()"),t&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!t&&!r&&(t=await Om(),!t))throw new mn.UnsupportedError("device not supported");return new uu({handlerName:t,handlerFactory:r})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new mn.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new mn.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:t,preferLocalCodecsOrder:r=!1}){Me.debug("load() [routerRtpCapabilities:%o]",t);let n;try{if(this._loaded)throw new mn.InvalidStateError("already loaded");const s=jf.clone(t);Br.validateRtpCapabilities(s),n=this._handlerFactory();const i=await n.getNativeRtpCapabilities();Me.debug("load() | got native RTP capabilities:%o",i);const o=jf.clone(i);Br.validateRtpCapabilities(o),this._extendedRtpCapabilities=Br.getExtendedRtpCapabilities(o,s,r),Me.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=Br.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=Br.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=Br.getRecvRtpCapabilities(this._extendedRtpCapabilities),Br.validateRtpCapabilities(this._recvRtpCapabilities),Me.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await n.getNativeSctpCapabilities(),Me.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),Br.validateSctpCapabilities(this._sctpCapabilities),Me.debug("load() succeeded"),this._loaded=!0,n.close()}catch(s){throw n&&n.close(),s}}canProduce(t){if(this._loaded){if(t!=="audio"&&t!=="video")throw new TypeError(`invalid kind "${t}"`)}else throw new mn.InvalidStateError("not loaded");return this._canProduceByKind[t]}createSendTransport({id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u}){return Me.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u})}createRecvTransport({id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u}){return Me.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u})}createTransport({direction:t,id:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:d}){if(this._loaded){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="object")throw new TypeError("missing iceParameters");if(Array.isArray(s)){if(typeof i!="object")throw new TypeError("missing dtlsParameters");if(o&&typeof o!="object")throw new TypeError("wrong sctpParameters");if(d&&typeof d!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new mn.InvalidStateError("not loaded");const p=new WS.Transport({direction:t,id:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:d,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",p),p}}Fn.Device=uu;function Am(e){var t,r,n,s;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(Me.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"){Me.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(Me.debug("detectDeviceImpl() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(Me.debug("detectDeviceImpl() | ReactNative PlanB handler chosen"),"ReactNative")}else{Me.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",e.ua,e);const i=e.browser,o=(t=i.name)==null?void 0:t.toLowerCase(),a=parseInt(i.major??"0"),l=(r=e.engine.name)==null?void 0:r.toLowerCase(),u=e.os,d=(n=u.name)==null?void 0:n.toLowerCase(),p=parseFloat(u.version??"0"),y=(s=e.device.model)==null?void 0:s.toLowerCase(),w=d==="ios"||y==="ipad",b=o&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(o),h=o&&["firefox","mobile firefox","mobile focus"].includes(o),g=o&&["safari","mobile safari"].includes(o),m=o&&["edge"].includes(o);if((b||m)&&!w&&a>=111)return"Chrome111";if(b&&!w&&a>=74||m&&!w&&a>=88)return"Chrome74";if(b&&!w&&a>=70)return"Chrome70";if(b&&!w&&a>=67)return"Chrome67";if(b&&!w&&a>=55)return"Chrome55";if(h&&!w&&a>=120)return"Firefox120";if(h&&!w&&a>=60)return"Firefox60";if(h&&w&&p>=14.3)return"Safari12";if(g&&a>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(g&&a>=11)return"Safari11";if(m&&!w&&a>=11&&a<=18)return"Edge11";if(l==="webkit"&&w&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(l==="blink"){const _=e.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(_){const S=Number(_[1]);return S>=111?"Chrome111":S>=74?"Chrome74":S>=70?"Chrome70":S>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{Me.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",o,a);return}}}var jm={};Object.defineProperty(jm,"__esModule",{value:!0});var $m={};Object.defineProperty($m,"__esModule",{value:!0});(function(e){var t=_n&&_n.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=_n&&_n.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(Fn,e),r(io,e),r(oo,e),r(ao,e),r(co,e),r(lo,e),r(jm,e),r($m,e),r(We,e),r(Le,e)})(mm);var uc={},pc={},Fm={},pu={};Object.defineProperty(pu,"__esModule",{value:!0});pu.default="ffffffff-ffff-ffff-ffff-ffffffffffff";var fu={};Object.defineProperty(fu,"__esModule",{value:!0});fu.default="00000000-0000-0000-0000-000000000000";var Ys={},Xs={},hu={};Object.defineProperty(hu,"__esModule",{value:!0});hu.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;Object.defineProperty(Xs,"__esModule",{value:!0});const o0=hu;function a0(e){return typeof e=="string"&&o0.default.test(e)}Xs.default=a0;Object.defineProperty(Ys,"__esModule",{value:!0});const c0=Xs;function l0(e){if(!(0,c0.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,t&255,(t=parseInt(e.slice(9,13),16))>>>8,t&255,(t=parseInt(e.slice(14,18),16))>>>8,t&255,(t=parseInt(e.slice(19,23),16))>>>8,t&255,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255)}Ys.default=l0;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.unsafeStringify=void 0;const d0=Xs,Ue=[];for(let e=0;e<256;++e)Ue.push((e+256).toString(16).slice(1));function zm(e,t=0){return(Ue[e[t+0]]+Ue[e[t+1]]+Ue[e[t+2]]+Ue[e[t+3]]+"-"+Ue[e[t+4]]+Ue[e[t+5]]+"-"+Ue[e[t+6]]+Ue[e[t+7]]+"-"+Ue[e[t+8]]+Ue[e[t+9]]+"-"+Ue[e[t+10]]+Ue[e[t+11]]+Ue[e[t+12]]+Ue[e[t+13]]+Ue[e[t+14]]+Ue[e[t+15]]).toLowerCase()}Mt.unsafeStringify=zm;function u0(e,t=0){const r=zm(e,t);if(!(0,d0.default)(r))throw TypeError("Stringified UUID is invalid");return r}Mt.default=u0;var Js={},uo={};Object.defineProperty(uo,"__esModule",{value:!0});let il;const p0=new Uint8Array(16);function f0(){if(!il){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");il=crypto.getRandomValues.bind(crypto)}return il(p0)}uo.default=f0;Object.defineProperty(Js,"__esModule",{value:!0});Js.updateV1State=void 0;const $f=uo,h0=Mt,gi={};function m0(e,t,r){var i;let n;const s=(e==null?void 0:e._v6)??!1;if(e){const o=Object.keys(e);o.length===1&&o[0]==="_v6"&&(e=void 0)}if(e)n=Ff(e.random??((i=e.rng)==null?void 0:i.call(e))??(0,$f.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,r);else{const o=Date.now(),a=(0,$f.default)();Bm(gi,o,a),n=Ff(a,gi.msecs,gi.nsecs,s?void 0:gi.clockseq,s?void 0:gi.node,t,r)}return t??(0,h0.unsafeStringify)(n)}function Bm(e,t,r){return e.msecs??(e.msecs=-1/0),e.nsecs??(e.nsecs=0),t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=(r[8]<<8|r[9])&16383),e.msecs=t,e}Js.updateV1State=Bm;function Ff(e,t,r,n,s,i,o=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),o=0;else if(o<0||o+16>i.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);t??(t=Date.now()),r??(r=0),n??(n=(e[8]<<8|e[9])&16383),s??(s=e.slice(10,16)),t+=122192928e5;const a=((t&268435455)*1e4+r)%4294967296;i[o++]=a>>>24&255,i[o++]=a>>>16&255,i[o++]=a>>>8&255,i[o++]=a&255;const c=t/4294967296*1e4&268435455;i[o++]=c>>>8&255,i[o++]=c&255,i[o++]=c>>>24&15|16,i[o++]=c>>>16&255,i[o++]=n>>>8|128,i[o++]=n&255;for(let l=0;l<6;++l)i[o++]=s[l];return i}Js.default=m0;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});const g0=Ys,v0=Mt;function _0(e){const t=typeof e=="string"?(0,g0.default)(e):e,r=y0(t);return typeof e=="string"?(0,v0.unsafeStringify)(r):r}fc.default=_0;function y0(e){return Uint8Array.of((e[6]&15)<<4|e[7]>>4&15,(e[7]&15)<<4|(e[4]&240)>>4,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,(e[1]&15)<<4|(e[2]&240)>>4,96|e[2]&15,e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var Um={},mu={};Object.defineProperty(mu,"__esModule",{value:!0});function w0(e){const t=b0(e),r=R0(t,e.length*8);return S0(r)}function S0(e){const t=new Uint8Array(e.length*4);for(let r=0;r<e.length*4;r++)t[r]=e[r>>2]>>>r%4*8&255;return t}function Vm(e){return(e+64>>>9<<4)+14+1}function R0(e,t){const r=new Uint32Array(Vm(t)).fill(0);r.set(e),r[t>>5]|=128<<t%32,r[r.length-1]=t,e=r;let n=1732584193,s=-271733879,i=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const c=n,l=s,u=i,d=o;n=Ge(n,s,i,o,e[a],7,-680876936),o=Ge(o,n,s,i,e[a+1],12,-389564586),i=Ge(i,o,n,s,e[a+2],17,606105819),s=Ge(s,i,o,n,e[a+3],22,-1044525330),n=Ge(n,s,i,o,e[a+4],7,-176418897),o=Ge(o,n,s,i,e[a+5],12,1200080426),i=Ge(i,o,n,s,e[a+6],17,-1473231341),s=Ge(s,i,o,n,e[a+7],22,-45705983),n=Ge(n,s,i,o,e[a+8],7,1770035416),o=Ge(o,n,s,i,e[a+9],12,-1958414417),i=Ge(i,o,n,s,e[a+10],17,-42063),s=Ge(s,i,o,n,e[a+11],22,-1990404162),n=Ge(n,s,i,o,e[a+12],7,1804603682),o=Ge(o,n,s,i,e[a+13],12,-40341101),i=Ge(i,o,n,s,e[a+14],17,-1502002290),s=Ge(s,i,o,n,e[a+15],22,1236535329),n=Ye(n,s,i,o,e[a+1],5,-165796510),o=Ye(o,n,s,i,e[a+6],9,-1069501632),i=Ye(i,o,n,s,e[a+11],14,643717713),s=Ye(s,i,o,n,e[a],20,-373897302),n=Ye(n,s,i,o,e[a+5],5,-701558691),o=Ye(o,n,s,i,e[a+10],9,38016083),i=Ye(i,o,n,s,e[a+15],14,-660478335),s=Ye(s,i,o,n,e[a+4],20,-405537848),n=Ye(n,s,i,o,e[a+9],5,568446438),o=Ye(o,n,s,i,e[a+14],9,-1019803690),i=Ye(i,o,n,s,e[a+3],14,-187363961),s=Ye(s,i,o,n,e[a+8],20,1163531501),n=Ye(n,s,i,o,e[a+13],5,-1444681467),o=Ye(o,n,s,i,e[a+2],9,-51403784),i=Ye(i,o,n,s,e[a+7],14,1735328473),s=Ye(s,i,o,n,e[a+12],20,-1926607734),n=Xe(n,s,i,o,e[a+5],4,-378558),o=Xe(o,n,s,i,e[a+8],11,-2022574463),i=Xe(i,o,n,s,e[a+11],16,1839030562),s=Xe(s,i,o,n,e[a+14],23,-35309556),n=Xe(n,s,i,o,e[a+1],4,-1530992060),o=Xe(o,n,s,i,e[a+4],11,1272893353),i=Xe(i,o,n,s,e[a+7],16,-155497632),s=Xe(s,i,o,n,e[a+10],23,-1094730640),n=Xe(n,s,i,o,e[a+13],4,681279174),o=Xe(o,n,s,i,e[a],11,-358537222),i=Xe(i,o,n,s,e[a+3],16,-722521979),s=Xe(s,i,o,n,e[a+6],23,76029189),n=Xe(n,s,i,o,e[a+9],4,-640364487),o=Xe(o,n,s,i,e[a+12],11,-421815835),i=Xe(i,o,n,s,e[a+15],16,530742520),s=Xe(s,i,o,n,e[a+2],23,-995338651),n=Je(n,s,i,o,e[a],6,-198630844),o=Je(o,n,s,i,e[a+7],10,1126891415),i=Je(i,o,n,s,e[a+14],15,-1416354905),s=Je(s,i,o,n,e[a+5],21,-57434055),n=Je(n,s,i,o,e[a+12],6,1700485571),o=Je(o,n,s,i,e[a+3],10,-1894986606),i=Je(i,o,n,s,e[a+10],15,-1051523),s=Je(s,i,o,n,e[a+1],21,-2054922799),n=Je(n,s,i,o,e[a+8],6,1873313359),o=Je(o,n,s,i,e[a+15],10,-30611744),i=Je(i,o,n,s,e[a+6],15,-1560198380),s=Je(s,i,o,n,e[a+13],21,1309151649),n=Je(n,s,i,o,e[a+4],6,-145523070),o=Je(o,n,s,i,e[a+11],10,-1120210379),i=Je(i,o,n,s,e[a+2],15,718787259),s=Je(s,i,o,n,e[a+9],21,-343485551),n=qr(n,c),s=qr(s,l),i=qr(i,u),o=qr(o,d)}return Uint32Array.of(n,s,i,o)}function b0(e){if(e.length===0)return new Uint32Array;const t=new Uint32Array(Vm(e.length*8)).fill(0);for(let r=0;r<e.length;r++)t[r>>2]|=(e[r]&255)<<r%4*8;return t}function qr(e,t){const r=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(r>>16)<<16|r&65535}function C0(e,t){return e<<t|e>>>32-t}function hc(e,t,r,n,s,i){return qr(C0(qr(qr(t,e),qr(n,i)),s),r)}function Ge(e,t,r,n,s,i,o){return hc(t&r|~t&n,e,t,s,i,o)}function Ye(e,t,r,n,s,i,o){return hc(t&n|r&~n,e,t,s,i,o)}function Xe(e,t,r,n,s,i,o){return hc(t^r^n,e,t,s,i,o)}function Je(e,t,r,n,s,i,o){return hc(r^(t|~n),e,t,s,i,o)}mu.default=w0;var Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.URL=Pt.DNS=Pt.stringToBytes=void 0;const zf=Ys,k0=Mt;function Hm(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}Pt.stringToBytes=Hm;Pt.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Pt.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function T0(e,t,r,n,s,i){const o=typeof r=="string"?Hm(r):r,a=typeof n=="string"?(0,zf.default)(n):n;if(typeof n=="string"&&(n=(0,zf.default)(n)),(n==null?void 0:n.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+o.length);if(c.set(a),c.set(o,a.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){i=i||0;for(let l=0;l<16;++l)s[i+l]=c[l];return s}return(0,k0.unsafeStringify)(c)}Pt.default=T0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=mu,r=Pt;var n=Pt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return n.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return n.URL}});function s(i,o,a,c){return(0,r.default)(48,t.default,i,o,a,c)}s.DNS=r.DNS,s.URL=r.URL,e.default=s})(Um);var gu={},vu={};Object.defineProperty(vu,"__esModule",{value:!0});const E0=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);vu.default={randomUUID:E0};Object.defineProperty(gu,"__esModule",{value:!0});const Bf=vu,x0=uo,P0=Mt;function D0(e,t,r){var s;if(Bf.default.randomUUID&&!t&&!e)return Bf.default.randomUUID();e=e||{};const n=e.random??((s=e.rng)==null?void 0:s.call(e))??(0,x0.default)();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let i=0;i<16;++i)t[r+i]=n[i];return t}return(0,P0.unsafeStringify)(n)}gu.default=D0;var Km={},_u={};Object.defineProperty(_u,"__esModule",{value:!0});function L0(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function ol(e,t){return e<<t|e>>>32-t}function I0(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520],n=new Uint8Array(e.length+1);n.set(e),n[e.length]=128,e=n;const s=e.length/4+2,i=Math.ceil(s/16),o=new Array(i);for(let a=0;a<i;++a){const c=new Uint32Array(16);for(let l=0;l<16;++l)c[l]=e[a*64+l*4]<<24|e[a*64+l*4+1]<<16|e[a*64+l*4+2]<<8|e[a*64+l*4+3];o[a]=c}o[i-1][14]=(e.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<i;++a){const c=new Uint32Array(80);for(let y=0;y<16;++y)c[y]=o[a][y];for(let y=16;y<80;++y)c[y]=ol(c[y-3]^c[y-8]^c[y-14]^c[y-16],1);let l=r[0],u=r[1],d=r[2],p=r[3],f=r[4];for(let y=0;y<80;++y){const w=Math.floor(y/20),b=ol(l,5)+L0(w,u,d,p)+f+t[w]+c[y]>>>0;f=p,p=d,d=ol(u,30)>>>0,u=l,l=b}r[0]=r[0]+l>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+d>>>0,r[3]=r[3]+p>>>0,r[4]=r[4]+f>>>0}return Uint8Array.of(r[0]>>24,r[0]>>16,r[0]>>8,r[0],r[1]>>24,r[1]>>16,r[1]>>8,r[1],r[2]>>24,r[2]>>16,r[2]>>8,r[2],r[3]>>24,r[3]>>16,r[3]>>8,r[3],r[4]>>24,r[4]>>16,r[4]>>8,r[4])}_u.default=I0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=_u,r=Pt;var n=Pt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return n.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return n.URL}});function s(i,o,a,c){return(0,r.default)(80,t.default,i,o,a,c)}s.DNS=r.DNS,s.URL=r.URL,e.default=s})(Km);var yu={};Object.defineProperty(yu,"__esModule",{value:!0});const M0=Mt,O0=Js,N0=fc;function A0(e,t,r){e??(e={}),r??(r=0);let n=(0,O0.default)({...e,_v6:!0},new Uint8Array(16));if(n=(0,N0.default)(n),t){for(let s=0;s<16;s++)t[r+s]=n[s];return t}return(0,M0.unsafeStringify)(n)}yu.default=A0;var wu={};Object.defineProperty(wu,"__esModule",{value:!0});const j0=Ys,$0=Mt;function F0(e){const t=typeof e=="string"?(0,j0.default)(e):e,r=z0(t);return typeof e=="string"?(0,$0.unsafeStringify)(r):r}wu.default=F0;function z0(e){return Uint8Array.of((e[3]&15)<<4|e[4]>>4&15,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|e[6]&15,e[7],(e[1]&15)<<4|(e[2]&240)>>4,(e[2]&15)<<4|(e[3]&240)>>4,16|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var po={};Object.defineProperty(po,"__esModule",{value:!0});po.updateV7State=void 0;const Uf=uo,B0=Mt,al={};function U0(e,t,r){var s;let n;if(e)n=Vf(e.random??((s=e.rng)==null?void 0:s.call(e))??(0,Uf.default)(),e.msecs,e.seq,t,r);else{const i=Date.now(),o=(0,Uf.default)();Qm(al,i,o),n=Vf(o,al.msecs,al.seq,t,r)}return t??(0,B0.unsafeStringify)(n)}function Qm(e,t,r){return e.msecs??(e.msecs=-1/0),e.seq??(e.seq=0),t>e.msecs?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,e.seq===0&&e.msecs++),e}po.updateV7State=Qm;function Vf(e,t,r,n,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!n)n=new Uint8Array(16),s=0;else if(s<0||s+16>n.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);return t??(t=Date.now()),r??(r=e[6]*127<<24|e[7]<<16|e[8]<<8|e[9]),n[s++]=t/1099511627776&255,n[s++]=t/4294967296&255,n[s++]=t/16777216&255,n[s++]=t/65536&255,n[s++]=t/256&255,n[s++]=t&255,n[s++]=112|r>>>28&15,n[s++]=r>>>20&255,n[s++]=128|r>>>14&63,n[s++]=r>>>6&255,n[s++]=r<<2&255|e[10]&3,n[s++]=e[11],n[s++]=e[12],n[s++]=e[13],n[s++]=e[14],n[s++]=e[15],n}po.default=U0;var Su={};Object.defineProperty(Su,"__esModule",{value:!0});const V0=Xs;function H0(e){if(!(0,V0.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}Su.default=H0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=pu;Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var r=fu;Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return r.default}});var n=Ys;Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return n.default}});var s=Mt;Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.default}});var i=Js;Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return i.default}});var o=fc;Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var a=Um;Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return a.default}});var c=gu;Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return c.default}});var l=Km;Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return l.default}});var u=yu;Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return u.default}});var d=wu;Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return d.default}});var p=po;Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return p.default}});var f=Xs;Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return f.default}});var y=Su;Object.defineProperty(e,"version",{enumerable:!0,get:function(){return y.default}})})(Fm);var mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.FakeEventTarget=void 0;class K0{constructor(){v(this,"listeners",{})}addEventListener(t,r,n={}){var s;r&&((s=this.listeners)[t]??(s[t]=[]),this.listeners[t].push({callback:r,once:n.once===!0}))}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(n=>n.callback!==r))}dispatchEvent(t){if(!t||typeof t.type!="string")throw new Error("invalid event object");const r=this.listeners[t.type];if(!r)return!0;for(const n of[...r]){try{n.callback.call(this,t)}catch(s){setTimeout(()=>{throw s},0)}n.once&&this.removeEventListener(t.type,n.callback)}return!t.defaultPrevented}}mc.FakeEventTarget=K0;var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});Ru.clone=Q0;function Q0(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}Object.defineProperty(pc,"__esModule",{value:!0});pc.FakeMediaStreamTrack=void 0;const Hf=Fm,W0=mc,Fo=Ru;var no,js,$s,sr,Wr,ir,Rn,Fs,bn,zs,Cn,kn,Tn,En,xn,Pn;const yp=class yp extends W0.FakeEventTarget{constructor({kind:r,id:n,label:s,contentHint:i,enabled:o,muted:a,readyState:c,capabilities:l,constraints:u,settings:d,data:p}){super();Be(this,no);Be(this,js);Be(this,$s);Be(this,sr);Be(this,Wr);Be(this,ir);Be(this,Rn);Be(this,Fs);Be(this,bn);Be(this,zs);Be(this,Cn);Be(this,kn,null);Be(this,Tn,null);Be(this,En,null);Be(this,xn,null);Be(this,Pn,null);ge(this,no,n??(0,Hf.v4)()),ge(this,js,r),ge(this,$s,s??""),ge(this,Rn,i??""),ge(this,Wr,o??!0),ge(this,ir,a??!1),ge(this,sr,c??"live"),ge(this,Fs,l??{}),ge(this,bn,u??{}),ge(this,zs,d??{}),ge(this,Cn,p??{})}get id(){return G(this,no)}get kind(){return G(this,js)}get label(){return G(this,$s)}get contentHint(){return G(this,Rn)}set contentHint(r){ge(this,Rn,r)}get enabled(){return G(this,Wr)}set enabled(r){const n=G(this,Wr)!==r;ge(this,Wr,r),n&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return G(this,ir)}get readyState(){return G(this,sr)}get data(){return G(this,Cn)}set data(r){ge(this,Cn,r)}get onmute(){return G(this,kn)}set onmute(r){G(this,kn)&&this.removeEventListener("mute",G(this,kn)),ge(this,kn,r),r&&this.addEventListener("mute",r)}get onunmute(){return G(this,Tn)}set onunmute(r){G(this,Tn)&&this.removeEventListener("unmute",G(this,Tn)),ge(this,Tn,r),r&&this.addEventListener("unmute",r)}get onended(){return G(this,En)}set onended(r){G(this,En)&&this.removeEventListener("ended",G(this,En)),ge(this,En,r),r&&this.addEventListener("ended",r)}get onenabledchange(){return G(this,xn)}set onenabledchange(r){G(this,xn)&&this.removeEventListener("enabledchange",G(this,xn)),ge(this,xn,r),r&&this.addEventListener("enabledchange",r)}get onstopped(){return G(this,Pn)}set onstopped(r){G(this,Pn)&&this.removeEventListener("stopped",G(this,Pn)),ge(this,Pn,r),r&&this.addEventListener("stopped",r)}addEventListener(r,n,s){super.addEventListener(r,n,s)}removeEventListener(r,n){super.removeEventListener(r,n)}stop(){G(this,sr)!=="ended"&&(ge(this,sr,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:r,data:n}={}){return new yp({id:r??(0,Hf.v4)(),kind:G(this,js),label:G(this,$s),contentHint:G(this,Rn),enabled:G(this,Wr),muted:G(this,ir),readyState:G(this,sr),capabilities:(0,Fo.clone)(G(this,Fs)),constraints:(0,Fo.clone)(G(this,bn)),settings:(0,Fo.clone)(G(this,zs)),data:n??(0,Fo.clone)(G(this,Cn))})}getCapabilities(){return G(this,Fs)}getConstraints(){return G(this,bn)}async applyConstraints(r={}){return ge(this,bn,r),Promise.resolve()}getSettings(){return G(this,zs)}remoteStop(){G(this,sr)!=="ended"&&(ge(this,sr,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){G(this,ir)||(ge(this,ir,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){G(this,ir)&&(ge(this,ir,!1),this.dispatchEvent(new Event("unmute")))}};no=new WeakMap,js=new WeakMap,$s=new WeakMap,sr=new WeakMap,Wr=new WeakMap,ir=new WeakMap,Rn=new WeakMap,Fs=new WeakMap,bn=new WeakMap,zs=new WeakMap,Cn=new WeakMap,kn=new WeakMap,Tn=new WeakMap,En=new WeakMap,xn=new WeakMap,Pn=new WeakMap;let zl=yp;pc.FakeMediaStreamTrack=zl;Object.defineProperty(uc,"__esModule",{value:!0});uc.FakeHandler=void 0;const q0=pc,G0=Ht,Y0=we,hs=Ce,Kf=de,X0=Le,J0=We,Ze=new Y0.Logger("FakeHandler"),Z0="FakeHandler";class Qf extends G0.EnhancedEventEmitter{constructor({id:r,ordered:n,maxPacketLifeTime:s,maxRetransmits:i,label:o,protocol:a}){super();v(this,"id");v(this,"ordered");v(this,"maxPacketLifeTime");v(this,"maxRetransmits");v(this,"label");v(this,"protocol");this.id=r,this.ordered=n,this.maxPacketLifeTime=s,this.maxRetransmits=i,this.label=o,this.protocol=a}close(){this.safeEmit("close"),this.emit("@close")}send(r){this.safeEmit("message",r)}addEventListener(r,n){this.on(r,n)}}class bu extends J0.HandlerInterface{constructor(r){super();v(this,"_closed",!1);v(this,"fakeParameters");v(this,"_rtpParametersByKind");v(this,"_cname",`CNAME-${hs.generateRandomNumber()}`);v(this,"_transportReady",!1);v(this,"_nextLocalId",1);v(this,"_tracks",new Map);v(this,"_nextSctpStreamId",0);this.fakeParameters=r}static createFactory(r){return()=>new bu(r)}get name(){return Z0}close(){Ze.debug("close()"),!this._closed&&(this._closed=!0)}setIceGatheringState(r){this.emit("@icegatheringstatechange",r)}setConnectionState(r){this.emit("@connectionstatechange",r)}async getNativeRtpCapabilities(){return Ze.debug("getNativeRtpCapabilities()"),this.fakeParameters.generateNativeRtpCapabilities()}async getNativeSctpCapabilities(){return Ze.debug("getNativeSctpCapabilities()"),this.fakeParameters.generateNativeSctpCapabilities()}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,proprietaryConstraints:l,extendedRtpCapabilities:u}){this.assertNotClosed(),Ze.debug("run()"),this._rtpParametersByKind={audio:Kf.getSendingRtpParameters("audio",u),video:Kf.getSendingRtpParameters("video",u)}}async updateIceServers(r){this.assertNotClosed(),Ze.debug("updateIceServers()")}async restartIce(r){this.assertNotClosed(),Ze.debug("restartIce()")}async getTransportStats(){return this.assertNotClosed(),new Map}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),Ze.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"});const o=hs.clone(this._rtpParametersByKind[r.kind]),a=o.codecs.some(l=>/.+\/rtx$/i.test(l.mimeType));o.mid=`mid-${hs.generateRandomNumber()}`,n||(n=[{}]);for(const l of n)l.ssrc=hs.generateRandomNumber(),a&&(l.rtx={ssrc:hs.generateRandomNumber()});o.encodings=n,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const c=this._nextLocalId++;return this._tracks.set(c,r),{localId:String(c),rtpParameters:o}}async stopSending(r){if(Ze.debug("stopSending() [localId:%s]",r),!this._closed){if(!this._tracks.has(Number(r)))throw new Error("local track not found");this._tracks.delete(Number(r))}}async pauseSending(r){this.assertNotClosed()}async resumeSending(r){this.assertNotClosed()}async replaceTrack(r,n){this.assertNotClosed(),n?Ze.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Ze.debug("replaceTrack() [localId:%s, no track]",r),this._tracks.delete(Number(r)),this._tracks.set(Number(r),n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),Ze.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),Ze.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n)}async getSenderStats(r){return this.assertNotClosed(),new Map}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),Ze.debug("sendDataChannel()");const a=new Qf({id:this._nextSctpStreamId++,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}),c={streamId:this._nextSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s};return{dataChannel:a,sctpStreamParameters:c}}async receive(r){this.assertNotClosed();const n=[];for(const s of r){const{trackId:i,kind:o}=s;this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Ze.debug("receive() [trackId:%s, kind:%s]",i,o);const a=this._nextLocalId++,c=new q0.FakeMediaStreamTrack({kind:o});this._tracks.set(a,c),n.push({localId:String(a),track:c})}return n}async stopReceiving(r){if(!this._closed)for(const n of r)Ze.debug("stopReceiving() [localId:%s]",n),this._tracks.delete(Number(n))}async pauseReceiving(r){this.assertNotClosed()}async resumeReceiving(r){this.assertNotClosed()}async getReceiverStats(r){return this.assertNotClosed(),new Map}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){return this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Ze.debug("receiveDataChannel()"),{dataChannel:new Qf({id:r.streamId,ordered:r.ordered,maxPacketLifeTime:r.maxPacketLifeTime,maxRetransmits:r.maxRetransmits,label:n,protocol:s})}}async setupTransport({localDtlsRole:r,localSdpObject:n}){const s=hs.clone(this.fakeParameters.generateLocalDtlsParameters());r&&(s.role=r),this.emit("@connectionstatechange","connecting"),await new Promise((i,o)=>this.emit("@connect",{dtlsParameters:s},i,o)),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new X0.InvalidStateError("method called in a closed handler")}}uc.FakeHandler=bu;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.generateRouterRtpCapabilities=eR;Kt.generateNativeRtpCapabilities=tR;Kt.generateNativeSctpCapabilities=rR;Kt.generateLocalDtlsParameters=nR;Kt.generateTransportRemoteParameters=sR;Kt.generateProducerRemoteParameters=iR;Kt.generateConsumerRemoteParameters=oR;Kt.generateDataProducerRemoteParameters=aR;Kt.generateDataConsumerRemoteParameters=cR;const nt=Ce;function vt(){return String(nt.generateRandomNumber())}function eR(){return nt.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://tools.ietf.org/html/draft-ietf-avtext-framemarking-07",preferredId:6,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:framemarking",preferredId:7,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function tR(){return nt.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function rR(){return nt.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function nR(){return nt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function sR(){return{id:vt(),iceParameters:nt.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:nt.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:nt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:nt.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function iR(){return nt.deepFreeze({id:vt()})}function oR({id:e,codecMimeType:t}={}){switch(t){case"audio/opus":return{id:e??vt(),producerId:vt(),kind:"audio",rtpParameters:nt.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:e??vt(),producerId:vt(),kind:"audio",rtpParameters:nt.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:e??vt(),producerId:vt(),kind:"video",rtpParameters:nt.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:e??vt(),producerId:vt(),kind:"video",rtpParameters:nt.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${t}'`)}}function aR(){return nt.deepFreeze({id:vt()})}function cR({id:e}={}){return{id:e??vt(),dataProducerId:vt(),sctpStreamParameters:nt.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;const t=Qa;e.debug=t.default,e.types=mm,e.version="3.11.0";var r=Fn;Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return r.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return r.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return r.detectDeviceAsync}});var n=pr;Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return n.parse}}),e.ortc=de;var s=uc;Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return s.FakeHandler}}),e.testFakeParameters=Kt})(Hd);const dr=Object.create(null);dr.open="0";dr.close="1";dr.ping="2";dr.pong="3";dr.message="4";dr.upgrade="5";dr.noop="6";const ca=Object.create(null);Object.keys(dr).forEach(e=>{ca[dr[e]]=e});const Bl={type:"error",data:"parser error"},Wm=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",qm=typeof ArrayBuffer=="function",Gm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Cu=({type:e,data:t},r,n)=>Wm&&t instanceof Blob?r?n(t):Wf(t,n):qm&&(t instanceof ArrayBuffer||Gm(t))?r?n(t):Wf(new Blob([t]),n):n(dr[e]+(t||"")),Wf=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function qf(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let cl;function lR(e,t){if(Wm&&e.data instanceof Blob)return e.data.arrayBuffer().then(qf).then(t);if(qm&&(e.data instanceof ArrayBuffer||Gm(e.data)))return t(qf(e.data));Cu(e,!1,r=>{cl||(cl=new TextEncoder),t(cl.encode(r))})}const Gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ti=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<Gf.length;e++)Ti[Gf.charCodeAt(e)]=e;const dR=e=>{let t=e.length*.75,r=e.length,n,s=0,i,o,a,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const l=new ArrayBuffer(t),u=new Uint8Array(l);for(n=0;n<r;n+=4)i=Ti[e.charCodeAt(n)],o=Ti[e.charCodeAt(n+1)],a=Ti[e.charCodeAt(n+2)],c=Ti[e.charCodeAt(n+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|a>>2,u[s++]=(a&3)<<6|c&63;return l},uR=typeof ArrayBuffer=="function",ku=(e,t)=>{if(typeof e!="string")return{type:"message",data:Ym(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:pR(e.substring(1),t)}:ca[r]?e.length>1?{type:ca[r],data:e.substring(1)}:{type:ca[r]}:Bl},pR=(e,t)=>{if(uR){const r=dR(e);return Ym(r,t)}else return{base64:!0,data:e}},Ym=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Xm="",fR=(e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach((i,o)=>{Cu(i,!1,a=>{n[o]=a,++s===r&&t(n.join(Xm))})})},hR=(e,t)=>{const r=e.split(Xm),n=[];for(let s=0;s<r.length;s++){const i=ku(r[s],t);if(n.push(i),i.type==="error")break}return n};function mR(){return new TransformStream({transform(e,t){lR(e,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const i=new DataView(s.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{s=new Uint8Array(9);const i=new DataView(s.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let ll;function zo(e){return e.reduce((t,r)=>t+r.length,0)}function Bo(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function gR(e,t){ll||(ll=new TextDecoder);const r=[];let n=0,s=-1,i=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(n===0){if(zo(r)<1)break;const c=Bo(r,1);i=(c[0]&128)===128,s=c[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(zo(r)<2)break;const c=Bo(r,2);s=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(zo(r)<8)break;const c=Bo(r,8),l=new DataView(c.buffer,c.byteOffset,c.length),u=l.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(Bl);break}s=u*Math.pow(2,32)+l.getUint32(4),n=3}else{if(zo(r)<s)break;const c=Bo(r,s);a.enqueue(ku(i?c:ll.decode(c),t)),n=0}if(s===0||s>e){a.enqueue(Bl);break}}}})}const Jm=4;function Ne(e){if(e)return vR(e)}function vR(e){for(var t in Ne.prototype)e[t]=Ne.prototype[t];return e}Ne.prototype.on=Ne.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Ne.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Ne.prototype.off=Ne.prototype.removeListener=Ne.prototype.removeAllListeners=Ne.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Ne.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,t)}return this};Ne.prototype.emitReserved=Ne.prototype.emit;Ne.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Ne.prototype.hasListeners=function(e){return!!this.listeners(e).length};const gc=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),kt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),_R="arraybuffer";function Zm(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const yR=kt.setTimeout,wR=kt.clearTimeout;function vc(e,t){t.useNativeTimers?(e.setTimeoutFn=yR.bind(kt),e.clearTimeoutFn=wR.bind(kt)):(e.setTimeoutFn=kt.setTimeout.bind(kt),e.clearTimeoutFn=kt.clearTimeout.bind(kt))}const SR=1.33;function RR(e){return typeof e=="string"?bR(e):Math.ceil((e.byteLength||e.size)*SR)}function bR(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function eg(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function CR(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function kR(e){let t={},r=e.split("&");for(let n=0,s=r.length;n<s;n++){let i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class TR extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class Tu extends Ne{constructor(t){super(),this.writable=!1,vc(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new TR(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=ku(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=CR(t);return r.length?"?"+r:""}}class ER extends Tu{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};hR(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,fR(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=eg()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let tg=!1;try{tg=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const xR=tg;function PR(){}class DR extends ER{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class ar extends Ne{constructor(t,r,n){super(),this.createRequest=t,vc(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=Zm(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=ar.requestsCount++,ar.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=PR,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete ar.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}ar.requestsCount=0;ar.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Yf);else if(typeof addEventListener=="function"){const e="onpagehide"in kt?"pagehide":"unload";addEventListener(e,Yf,!1)}}function Yf(){for(let e in ar.requests)ar.requests.hasOwnProperty(e)&&ar.requests[e].abort()}const LR=function(){const e=rg({xdomain:!1});return e&&e.responseType!==null}();class IR extends DR{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=LR&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new ar(rg,this.uri(),t)}}function rg(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||xR))return new XMLHttpRequest}catch{}if(!t)try{return new kt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const ng=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class MR extends Tu{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=ng?{}:Zm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;Cu(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}s&&gc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=eg()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const dl=kt.WebSocket||kt.MozWebSocket;class OR extends MR{createSocket(t,r,n){return ng?new dl(t,r,n):r?new dl(t,r):new dl(t)}doWrite(t,r){this.ws.send(r)}}class NR extends Tu{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=gR(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),s=mR();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const i=()=>{n.read().then(({done:a,value:c})=>{a||(this.onPacket(c),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;this._writer.write(n).then(()=>{s&&gc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const AR={websocket:OR,webtransport:NR,polling:IR},jR=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,$R=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ul(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=jR.exec(e||""),i={},o=14;for(;o--;)i[$R[o]]=s[o]||"";return r!=-1&&n!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=FR(i,i.path),i.queryKey=zR(i,i.query),i}function FR(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function zR(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,i){s&&(r[s]=i)}),r}const Vl=typeof addEventListener=="function"&&typeof removeEventListener=="function",la=[];Vl&&addEventListener("offline",()=>{la.forEach(e=>e())},!1);class Jr extends Ne{constructor(t,r){if(super(),this.binaryType=_R,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=Ul(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=Ul(r.host).host);vc(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=kR(this.opts.query)),Vl&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},la.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Jm,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Jr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Jr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=RR(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,gc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:t,data:r,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(Jr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Vl&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=la.indexOf(this._offlineEventListener);n!==-1&&la.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}Jr.protocol=Jm;class BR extends Jr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;Jr.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!n)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Jr.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function i(){n||(n=!0,u(),r.close(),r=null)}const o=d=>{const p=new Error("probe error: "+d);p.transport=r.name,i(),this.emitReserved("upgradeError",p)};function a(){o("transport closed")}function c(){o("socket closed")}function l(d){r&&d.name!==r.name&&i()}const u=()=>{r.removeListener("open",s),r.removeListener("error",o),r.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};r.once("open",s),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",l),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let UR=class extends BR{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>AR[s]).filter(s=>!!s)),super(t,n)}};function VR(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=Ul(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}const HR=typeof ArrayBuffer=="function",KR=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,sg=Object.prototype.toString,QR=typeof Blob=="function"||typeof Blob<"u"&&sg.call(Blob)==="[object BlobConstructor]",WR=typeof File=="function"||typeof File<"u"&&sg.call(File)==="[object FileConstructor]";function Eu(e){return HR&&(e instanceof ArrayBuffer||KR(e))||QR&&e instanceof Blob||WR&&e instanceof File}function da(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(da(e[r]))return!0;return!1}if(Eu(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return da(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&da(e[r]))return!0;return!1}function qR(e){const t=[],r=e.data,n=e;return n.data=Hl(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Hl(e,t){if(!e)return e;if(Eu(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Hl(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Hl(e[n],t));return r}return e}function GR(e,t){return e.data=Kl(e.data,t),delete e.attachments,e}function Kl(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Kl(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Kl(e[r],t));return e}const YR=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],XR=5;var te;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(te||(te={}));class JR{constructor(t){this.replacer=t}encode(t){return(t.type===te.EVENT||t.type===te.ACK)&&da(t)?this.encodeAsBinary({type:t.type===te.EVENT?te.BINARY_EVENT:te.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===te.BINARY_EVENT||t.type===te.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=qR(t),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function Xf(e){return Object.prototype.toString.call(e)==="[object Object]"}class xu extends Ne{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===te.BINARY_EVENT;n||r.type===te.BINARY_ACK?(r.type=n?te.EVENT:te.ACK,this.reconstructor=new ZR(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Eu(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(te[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===te.BINARY_EVENT||n.type===te.BINARY_ACK){const i=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(i,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(t.charAt(r+1)==="/"){const i=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(i,r)}else n.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const i=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}n.id=Number(t.substring(i,r+1))}if(t.charAt(++r)){const i=this.tryParse(t.substr(r));if(xu.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case te.CONNECT:return Xf(r);case te.DISCONNECT:return r===void 0;case te.CONNECT_ERROR:return typeof r=="string"||Xf(r);case te.EVENT:case te.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&YR.indexOf(r[0])===-1);case te.ACK:case te.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ZR{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=GR(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const e1=Object.freeze(Object.defineProperty({__proto__:null,Decoder:xu,Encoder:JR,get PacketType(){return te},protocol:XR},Symbol.toStringTag,{value:"Module"}));function jt(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const t1=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ig extends Ne{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[jt(t,"open",this.onopen.bind(this)),jt(t,"packet",this.onpacket.bind(this)),jt(t,"error",this.onerror.bind(this)),jt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,s,i;if(t1.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:te.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,d=r.pop();this._registerAckCallback(u,d),o.id=u}const a=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},s),o=(...a)=>{this.io.clearTimeoutFn(i),r.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((n,s)=>{const i=(o,a)=>o?s(o):n(a);i.withError=!0,r.push(i),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...i)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:te.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case te.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case te.EVENT:case te.BINARY_EVENT:this.onevent(t);break;case te.ACK:case te.BINARY_ACK:this.onack(t);break;case te.DISCONNECT:this.ondisconnect();break;case te.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:te.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:te.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Zs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Zs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Zs.prototype.reset=function(){this.attempts=0};Zs.prototype.setMin=function(e){this.ms=e};Zs.prototype.setMax=function(e){this.max=e};Zs.prototype.setJitter=function(e){this.jitter=e};class Ql extends Ne{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,vc(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Zs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||e1;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new UR(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=jt(r,"open",function(){n.onopen(),t&&t()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=jt(r,"error",i);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{s(),i(new Error("timeout")),r.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(s),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(jt(t,"ping",this.onping.bind(this)),jt(t,"data",this.ondata.bind(this)),jt(t,"error",this.onerror.bind(this)),jt(t,"close",this.onclose.bind(this)),jt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){gc(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new ig(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const vi={};function Ds(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=VR(e,t.path||"/socket.io"),n=r.source,s=r.id,i=r.path,o=vi[s]&&i in vi[s].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return a?c=new Ql(n,t):(vi[s]||(vi[s]=new Ql(n,t)),c=vi[s]),r.query&&!t.query&&(t.query=r.queryKey),c.socket(r.path,t)}Object.assign(Ds,{Manager:Ql,Socket:ig,io:Ds,connect:Ds});function r1({onStart:e,onStop:t,isSharing:r}){const[n,s]=re.useState(""),i=async()=>{s("");try{const o=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1});e(o)}catch{s("Screen sharing cancelled or failed")}};return D.jsxs("div",{className:"my-2",children:[D.jsx("button",{className:`px-4 py-2 rounded font-semibold ${r?"bg-red-600":"bg-green-600"} text-white`,onClick:r?t:i,children:r?"Stop Sharing":"Share Screen"}),n&&D.jsx("div",{className:"text-red-400 text-sm mt-1",children:n})]})}const n1="https://mediasoup-server.victoriouswater-bf2045fa.centralindia.azurecontainerapps.io";function s1({roomId:e,token:t}){const[r,n]=re.useState("Idle"),[s,i]=re.useState(null),[o,a]=re.useState(null),[c,l]=re.useState(!1),u=re.useRef(null),d=re.useRef(null),p=re.useRef(null),f=re.useRef(null),y=re.useRef(null);re.useEffect(()=>{async function h(){try{n("Requesting media...");const g=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});u.current&&(u.current.srcObject=g),n("Connecting to server...");const m=new Hd.Device;d.current=m;const _=Ds(n1,{query:{token:t}});p.current=_,await new Promise((x,B)=>{_.emit("joinRoom",{roomId:e},W=>{W&&W.success?x():B(new Error((W==null?void 0:W.error)||"Failed to join room"))})}),console.log("Getting RTP capabilities...");const S=await new Promise((x,B)=>{_.emit("getRtpCapabilities",W=>{W.error?B(new Error(W.error)):x(W)})});console.log("Loading device..."),await m.load({routerRtpCapabilities:S}),console.log("Creating producer transport...");const R=await new Promise((x,B)=>{_.emit("createProducerTransport",W=>{W.error?B(new Error(W.error)):x(W)})});console.log("Setting up transport...");const E=m.createSendTransport(R);E.on("connect",({dtlsParameters:x},B,W)=>{console.log("Transport connect event"),_.emit("connectTransport",{dtlsParameters:x},Ie=>{Ie&&Ie.error?W&&W(new Error(Ie.error)):B()})}),E.on("produce",({kind:x,rtpParameters:B},W,Ie)=>{console.log(`Producing ${x}...`),_.emit("produce",{kind:x,rtpParameters:B},Qt=>{Qt&&Qt.error?Ie&&Ie(new Error(Qt.error)):W({id:Qt.id})})}),E.on("connectionstatechange",x=>{console.log("Transport connection state:",x),(x==="failed"||x==="closed")&&n(`❌ Transport ${x}`)});const P=g.getVideoTracks()[0],C=g.getAudioTracks()[0];if(!P)throw new Error("No video track available");n("Sending video..."),console.log("Video track:",{enabled:P.enabled,muted:P.muted,readyState:P.readyState});const A=await E.produce({track:P,encodings:[{maxBitrate:1e5},{maxBitrate:3e5},{maxBitrate:9e5}],codecOptions:{videoGoogleStartBitrate:1e3}});if(i(A.id),console.log("Video producer created:",A.id),A.on("transportclose",()=>{console.log("Video transport closed"),n("❌ Video transport closed")}),C){n("Sending audio..."),console.log("Audio track:",{enabled:C.enabled,muted:C.muted,readyState:C.readyState});const x=await E.produce({track:C,codecOptions:{opusStereo:!0,opusDtx:!0}});console.log("Audio producer created:",x.id),x.on("transportclose",()=>{console.log("Audio transport closed")})}else console.warn("No audio track available");n("✅ AV streaming started."),n("✅ AV streaming started."),console.log("Streaming setup completed successfully")}catch(g){console.error("Error in sender:",g),g instanceof Error?n(`❌ Error: ${g.message}`):n("❌ Error: Unknown error")}}h()},[e,t]);const w=async h=>{l(!0),n("Sharing screen...");try{const g=d.current,m=p.current,_=await new Promise((P,C)=>{m.emit("createProducerTransport",A=>{A.error?C(new Error(A.error)):P(A)})}),S=g.createSendTransport(_);f.current=S,S.on("connect",({dtlsParameters:P},C,A)=>{m.emit("connectTransport",{dtlsParameters:P},x=>{x&&x.error?A(new Error(x.error)):C()})}),S.on("produce",({kind:P,rtpParameters:C},A,x)=>{m.emit("produce",{kind:P,rtpParameters:C},B=>{B&&B.error?x(new Error(B.error)):A({id:B.id})})});const R=h.getVideoTracks()[0];if(!R)throw new Error("No video track in screen stream");const E=await S.produce({track:R,appData:{screen:!0}});a(E.id),y.current=E,E.on("transportclose",()=>{l(!1),a(null),n("Screen share stopped")}),R.onended=()=>{E.close(),l(!1),a(null),n("Screen share stopped")}}catch{n("❌ Screen share error"),l(!1)}},b=()=>{y.current&&(y.current.close(),l(!1),a(null),n("Screen share stopped"))};return D.jsxs("div",{children:[D.jsx("h2",{children:"AV Sender"}),D.jsxs("p",{children:["Status: ",r]}),s&&D.jsxs("p",{children:["Video Producer ID: ",s]}),o&&D.jsxs("p",{children:["Screen Producer ID: ",o]}),D.jsx("video",{ref:u,autoPlay:!0,playsInline:!0,muted:!0,style:{width:320}}),D.jsx(r1,{onStart:w,onStop:b,isSharing:c})]})}const i1="https://mediasoup-server.victoriouswater-bf2045fa.centralindia.azurecontainerapps.io",o1=10,a1=1e3;let Uo=null;function c1({roomId:e,token:t}){const[r,n]=re.useState("Idle"),s=re.useRef(null),i=re.useRef(null),o=re.useRef(null);return re.useEffect(()=>{let a=!0;async function c(){try{n("Connecting to server...");const l=new Hd.Device,u=Ds(i1,{query:{token:t}});if(o.current=u,u.on("connect_error",w=>{a&&(console.error("Socket connection error:",w),n(`❌ Connection error: ${w.message}`))}),u.on("connect_timeout",()=>{a&&(console.error("Socket connection timeout"),n("❌ Connection timeout"))}),u.on("disconnect",w=>{a&&(console.log("Socket disconnected:",w),n(`Disconnected: ${w}`))}),await new Promise((w,b)=>{const h=setTimeout(()=>{b(new Error("Connection timeout"))},7e3);u.on("connect",()=>{clearTimeout(h),w()})}),!a||(n("Connected to server."),await new Promise((w,b)=>{u.emit("joinRoom",{roomId:e},h=>{h&&h.success?w():b(new Error((h==null?void 0:h.error)||"Failed to join room"))})}),!a))return;n("Joined room.");const d=await new Promise((w,b)=>u.emit("getRtpCapabilities",h=>{h!=null&&h.error?b(new Error(h.error)):w(h)}));if(!a)return;await l.load({routerRtpCapabilities:d});const p=await new Promise((w,b)=>u.emit("createConsumerTransport",{rtpCapabilities:l.rtpCapabilities},h=>{h!=null&&h.error?b(new Error(h.error)):w(h)})),f=l.createRecvTransport(p);f.on("connect",({dtlsParameters:w},b)=>{u.emit("connectConsumerTransport",{dtlsParameters:w},b)}),f.on("connectionstatechange",w=>{(w==="failed"||w==="closed")&&n("❌ Transport connection failed")});async function y(w,b,h=1){if(!a)return;const g=await new Promise(S=>u.emit("consume",{kind:w,rtpCapabilities:l.rtpCapabilities},R=>S(R)));if(g.error){h<o1?(n(`Retrying to consume ${w}... (attempt ${h+1})`),Uo=setTimeout(()=>y(w,b,h+1),a1)):n(`❌ Error: Failed to consume ${w}: ${g.error}`);return}const m=await f.consume(g),_=new MediaStream([m.track]);b.current&&(b.current.srcObject=_),n(`Playing received ${w}.`)}y("video",s),y("screen",i)}catch(l){n(`❌ Error: ${l instanceof Error?l.message:"Unknown error"}`)}return()=>{var l;a=!1,Uo&&(clearTimeout(Uo),Uo=null),(l=o.current)==null||l.disconnect(),n("Idle")}}return c(),()=>{var l;(l=o.current)==null||l.disconnect()}},[e,t]),D.jsxs("div",{children:[D.jsx("h1",{children:"AV Receiver"}),D.jsxs("p",{children:["Status: ",r]}),D.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,style:{width:"100%"}}),D.jsxs("div",{className:"mt-2",children:[D.jsx("h3",{className:"text-sm text-gray-400",children:"Screen Share"}),D.jsx("video",{ref:i,autoPlay:!0,playsInline:!0,style:{width:"100%",border:"2px solid #4f46e5"}})]})]})}const l1="https://auth-streaming-server.victoriouswater-bf2045fa.centralindia.azurecontainerapps.io/api";function d1({onAuth:e}){const[t,r]=re.useState("login"),[n,s]=re.useState(""),[i,o]=re.useState(""),[a,c]=re.useState(""),[l,u]=re.useState(!1),d=async p=>{p.preventDefault(),u(!0),c("");try{const f=await fetch(`${l1}/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:i})});if(!f.ok)throw new Error(await f.text());const y=await f.json();e({username:n,streamId:y.streamId})}catch(f){c(f.message||"Unknown error")}finally{u(!1)}};return D.jsxs("div",{className:"max-w-md mx-auto bg-gray-800 p-6 rounded-lg mt-8",children:[D.jsxs("h2",{className:"text-xl font-bold mb-4 text-center",children:[t==="login"?"Login":"Register"," to CrossStream"]}),D.jsxs("form",{onSubmit:d,className:"space-y-4",children:[D.jsx("input",{className:"w-full p-2 rounded bg-gray-700 text-white",placeholder:"Username",value:n,onChange:p=>s(p.target.value),required:!0}),D.jsx("input",{className:"w-full p-2 rounded bg-gray-700 text-white",placeholder:"Password",type:"password",value:i,onChange:p=>o(p.target.value),required:!0}),a&&D.jsx("div",{className:"text-red-400 text-sm",children:a}),D.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-semibold",disabled:l,children:l?"Processing...":t==="login"?"Login":"Register"})]}),D.jsx("div",{className:"text-center mt-4",children:D.jsx("button",{className:"text-blue-400 hover:underline text-sm",onClick:()=>r(t==="login"?"register":"login"),children:t==="login"?"Need an account? Register":"Already have an account? Login"})})]})}const u1="https://mediasoup-server.victoriouswater-bf2045fa.centralindia.azurecontainerapps.io";function p1({roomId:e,token:t,username:r}){const[n,s]=re.useState([]),[i,o]=re.useState(""),a=re.useRef(null),c=re.useRef(null);re.useEffect(()=>{const u=Ds(u1,{query:{token:t}});return a.current=u,u.emit("joinRoom",{roomId:e},()=>{}),u.on("chatMessage",d=>{s(p=>[...p,d])}),()=>{u.disconnect()}},[e,t]),re.useEffect(()=>{var u;(u=c.current)==null||u.scrollIntoView({behavior:"smooth"})},[n]);const l=u=>{var d;u.preventDefault(),i.trim()&&((d=a.current)==null||d.emit("chatMessage",{roomId:e,message:i,username:r}),o(""))};return D.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 max-w-md mx-auto mt-4",children:[D.jsxs("div",{className:"h-48 overflow-y-auto mb-2 bg-gray-900 rounded p-2",children:[n.map((u,d)=>D.jsxs("div",{className:"mb-1",children:[D.jsxs("span",{className:"font-bold text-blue-400",children:[u.username,": "]}),D.jsx("span",{children:u.message})]},d)),D.jsx("div",{ref:c})]}),D.jsxs("form",{onSubmit:l,className:"flex gap-2",children:[D.jsx("input",{className:"flex-1 p-2 rounded bg-gray-700 text-white",value:i,onChange:u=>o(u.target.value),placeholder:"Type a message..."}),D.jsx("button",{type:"submit",className:"bg-blue-600 px-4 py-2 rounded text-white font-semibold",children:"Send"})]})]})}const f1=()=>{const[e,t]=re.useState(null),[r,n]=re.useState(""),[s,i]=re.useState(!1);return e?s?D.jsxs("div",{className:"container mx-auto px-6 py-8",children:[D.jsxs("div",{className:"text-center mb-8",children:[D.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"🎥 CrossStream"}),D.jsxs("p",{className:"text-gray-400 text-lg",children:["Welcome, ",e.username,"! Room:"," ",D.jsx("span",{className:"font-mono text-green-400",children:r})]})]}),D.jsx("div",{className:"max-w-md mx-auto",children:D.jsx(B_,{})}),D.jsx("div",{className:"mt-8 text-center text-sm text-gray-500",children:D.jsx("p",{children:"Ready to stream audio and video across platforms"})}),D.jsx(p1,{roomId:r,token:e.token||e.streamId,username:e.username}),D.jsxs("div",{className:"mt-8 flex flex-col md:flex-row justify-center gap-8",children:[D.jsx(s1,{roomId:r,token:e.token||e.streamId}),D.jsx(c1,{roomId:r,token:e.token||e.streamId})]})]}):D.jsxs("div",{className:"container mx-auto px-6 py-8",children:[D.jsxs("div",{className:"text-center mb-8",children:[D.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"🎥 CrossStream"}),D.jsxs("p",{className:"text-gray-400 text-lg",children:["Welcome, ",e.username,"! Your Stream ID:"," ",D.jsx("span",{className:"font-mono text-green-400",children:e.streamId})]})]}),D.jsxs("div",{className:"max-w-md mx-auto bg-gray-800 p-6 rounded-lg mt-8",children:[D.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Join or Create a Room"}),D.jsxs("form",{onSubmit:o=>{o.preventDefault(),r&&i(!0)},className:"space-y-4",children:[D.jsx("input",{className:"w-full p-2 rounded bg-gray-700 text-white",placeholder:"Room ID (any string)",value:r,onChange:o=>n(o.target.value),required:!0}),D.jsx("button",{type:"submit",className:"w-full py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-semibold",children:"Join Room"})]})]})]}):D.jsx(d1,{onAuth:t})},h1=()=>D.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:D.jsx(f1,{})});var Wl={},og={exports:{}},Rt={},ag={exports:{}},cg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(L,U){var q=L.length;L.push(U);e:for(;0<q;){var ue=q-1>>>1,Te=L[ue];if(0<s(Te,U))L[ue]=U,L[q]=Te,q=ue;else break e}}function r(L){return L.length===0?null:L[0]}function n(L){if(L.length===0)return null;var U=L[0],q=L.pop();if(q!==U){L[0]=q;e:for(var ue=0,Te=L.length,mr=Te>>>1;ue<mr;){var qe=2*(ue+1)-1,ri=L[qe],gr=qe+1,Hn=L[gr];if(0>s(ri,q))gr<Te&&0>s(Hn,ri)?(L[ue]=Hn,L[gr]=q,ue=gr):(L[ue]=ri,L[qe]=q,ue=qe);else if(gr<Te&&0>s(Hn,q))L[ue]=Hn,L[gr]=q,ue=gr;else break e}}return U}function s(L,U){var q=L.sortIndex-U.sortIndex;return q!==0?q:L.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,p=3,f=!1,y=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(L){for(var U=r(l);U!==null;){if(U.callback===null)n(l);else if(U.startTime<=L)n(l),U.sortIndex=U.expirationTime,t(c,U);else break;U=r(l)}}function _(L){if(w=!1,m(L),!y)if(r(c)!==null)y=!0,fr(S);else{var U=r(l);U!==null&&hr(_,U.startTime-L)}}function S(L,U){y=!1,w&&(w=!1,h(P),P=-1),f=!0;var q=p;try{for(m(U),d=r(c);d!==null&&(!(d.expirationTime>U)||L&&!x());){var ue=d.callback;if(typeof ue=="function"){d.callback=null,p=d.priorityLevel;var Te=ue(d.expirationTime<=U);U=e.unstable_now(),typeof Te=="function"?d.callback=Te:d===r(c)&&n(c),m(U)}else n(c);d=r(c)}if(d!==null)var mr=!0;else{var qe=r(l);qe!==null&&hr(_,qe.startTime-U),mr=!1}return mr}finally{d=null,p=q,f=!1}}var R=!1,E=null,P=-1,C=5,A=-1;function x(){return!(e.unstable_now()-A<C)}function B(){if(E!==null){var L=e.unstable_now();A=L;var U=!0;try{U=E(!0,L)}finally{U?W():(R=!1,E=null)}}else R=!1}var W;if(typeof g=="function")W=function(){g(B)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,Qt=Ie.port2;Ie.port1.onmessage=B,W=function(){Qt.postMessage(null)}}else W=function(){b(B,0)};function fr(L){E=L,R||(R=!0,W())}function hr(L,U){P=b(function(){L(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){y||f||(y=!0,fr(S))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(L){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var q=p;p=U;try{return L()}finally{p=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,U){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var q=p;p=L;try{return U()}finally{p=q}},e.unstable_scheduleCallback=function(L,U,q){var ue=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?ue+q:ue):q=ue,L){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=q+Te,L={id:u++,callback:U,priorityLevel:L,startTime:q,expirationTime:Te,sortIndex:-1},q>ue?(L.sortIndex=q,t(l,L),r(c)===null&&L===r(l)&&(w?(h(P),P=-1):w=!0,hr(_,q-ue))):(L.sortIndex=Te,t(c,L),y||f||(y=!0,fr(S))),L},e.unstable_shouldYield=x,e.unstable_wrapCallback=function(L){var U=p;return function(){var q=p;p=U;try{return L.apply(this,arguments)}finally{p=q}}}})(cg);ag.exports=cg;var m1=ag.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1=re,St=m1;function k(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lg=new Set,zi={};function Un(e,t){Bs(e,t),Bs(e+"Capture",t)}function Bs(e,t){for(zi[e]=t,e=0;e<t.length;e++)lg.add(t[e])}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ql=Object.prototype.hasOwnProperty,v1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jf={},Zf={};function _1(e){return ql.call(Zf,e)?!0:ql.call(Jf,e)?!1:v1.test(e)?Zf[e]=!0:(Jf[e]=!0,!1)}function y1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function w1(e,t,r,n){if(t===null||typeof t>"u"||y1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function lt(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qe[e]=new lt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qe[t]=new lt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qe[e]=new lt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qe[e]=new lt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qe[e]=new lt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qe[e]=new lt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qe[e]=new lt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qe[e]=new lt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qe[e]=new lt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Pu=/[\-:]([a-z])/g;function Du(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Pu,Du);Qe[t]=new lt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Pu,Du);Qe[t]=new lt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Pu,Du);Qe[t]=new lt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qe[e]=new lt(e,1,!1,e.toLowerCase(),null,!1,!1)});Qe.xlinkHref=new lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qe[e]=new lt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Lu(e,t,r,n){var s=Qe.hasOwnProperty(t)?Qe[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(w1(t,r,s,n)&&(r=null),n||s===null?_1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Mr=g1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vo=Symbol.for("react.element"),vs=Symbol.for("react.portal"),_s=Symbol.for("react.fragment"),Iu=Symbol.for("react.strict_mode"),Gl=Symbol.for("react.profiler"),dg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),Mu=Symbol.for("react.forward_ref"),Yl=Symbol.for("react.suspense"),Xl=Symbol.for("react.suspense_list"),Ou=Symbol.for("react.memo"),Vr=Symbol.for("react.lazy"),pg=Symbol.for("react.offscreen"),eh=Symbol.iterator;function _i(e){return e===null||typeof e!="object"?null:(e=eh&&e[eh]||e["@@iterator"],typeof e=="function"?e:null)}var be=Object.assign,ul;function Ei(e){if(ul===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ul=t&&t[1]||""}return`
`+ul+e}var pl=!1;function fl(e,t){if(!e||pl)return"";pl=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{pl=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ei(e):""}function S1(e){switch(e.tag){case 5:return Ei(e.type);case 16:return Ei("Lazy");case 13:return Ei("Suspense");case 19:return Ei("SuspenseList");case 0:case 2:case 15:return e=fl(e.type,!1),e;case 11:return e=fl(e.type.render,!1),e;case 1:return e=fl(e.type,!0),e;default:return""}}function Jl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _s:return"Fragment";case vs:return"Portal";case Gl:return"Profiler";case Iu:return"StrictMode";case Yl:return"Suspense";case Xl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ug:return(e.displayName||"Context")+".Consumer";case dg:return(e._context.displayName||"Context")+".Provider";case Mu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ou:return t=e.displayName||null,t!==null?t:Jl(e.type)||"Memo";case Vr:t=e._payload,e=e._init;try{return Jl(e(t))}catch{}}return null}function R1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Jl(t);case 8:return t===Iu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function cn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function b1(e){var t=fg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ho(e){e._valueTracker||(e._valueTracker=b1(e))}function hg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=fg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Sa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Zl(e,t){var r=t.checked;return be({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function th(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=cn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function mg(e,t){t=t.checked,t!=null&&Lu(e,"checked",t,!1)}function ed(e,t){mg(e,t);var r=cn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?td(e,t.type,r):t.hasOwnProperty("defaultValue")&&td(e,t.type,cn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function rh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function td(e,t,r){(t!=="number"||Sa(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var xi=Array.isArray;function Ls(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+cn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function rd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(k(91));return be({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function nh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(k(92));if(xi(r)){if(1<r.length)throw Error(k(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:cn(r)}}function gg(e,t){var r=cn(t.value),n=cn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function sh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function vg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?vg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ko,_g=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ko=Ko||document.createElement("div"),Ko.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ko.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Bi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C1=["Webkit","ms","Moz","O"];Object.keys(Li).forEach(function(e){C1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Li[t]=Li[e]})});function yg(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Li.hasOwnProperty(e)&&Li[e]?(""+t).trim():t+"px"}function wg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=yg(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var k1=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sd(e,t){if(t){if(k1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(k(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(k(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(k(61))}if(t.style!=null&&typeof t.style!="object")throw Error(k(62))}}function id(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var od=null;function Nu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ad=null,Is=null,Ms=null;function ih(e){if(e=mo(e)){if(typeof ad!="function")throw Error(k(280));var t=e.stateNode;t&&(t=Rc(t),ad(e.stateNode,e.type,t))}}function Sg(e){Is?Ms?Ms.push(e):Ms=[e]:Is=e}function Rg(){if(Is){var e=Is,t=Ms;if(Ms=Is=null,ih(e),t)for(e=0;e<t.length;e++)ih(t[e])}}function bg(e,t){return e(t)}function Cg(){}var hl=!1;function kg(e,t,r){if(hl)return e(t,r);hl=!0;try{return bg(e,t,r)}finally{hl=!1,(Is!==null||Ms!==null)&&(Cg(),Rg())}}function Ui(e,t){var r=e.stateNode;if(r===null)return null;var n=Rc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(k(231,t,typeof r));return r}var cd=!1;if(Pr)try{var yi={};Object.defineProperty(yi,"passive",{get:function(){cd=!0}}),window.addEventListener("test",yi,yi),window.removeEventListener("test",yi,yi)}catch{cd=!1}function T1(e,t,r,n,s,i,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var Ii=!1,Ra=null,ba=!1,ld=null,E1={onError:function(e){Ii=!0,Ra=e}};function x1(e,t,r,n,s,i,o,a,c){Ii=!1,Ra=null,T1.apply(E1,arguments)}function P1(e,t,r,n,s,i,o,a,c){if(x1.apply(this,arguments),Ii){if(Ii){var l=Ra;Ii=!1,Ra=null}else throw Error(k(198));ba||(ba=!0,ld=l)}}function Vn(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Tg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function oh(e){if(Vn(e)!==e)throw Error(k(188))}function D1(e){var t=e.alternate;if(!t){if(t=Vn(e),t===null)throw Error(k(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return oh(s),e;if(i===n)return oh(s),t;i=i.sibling}throw Error(k(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o)throw Error(k(189))}}if(r.alternate!==n)throw Error(k(190))}if(r.tag!==3)throw Error(k(188));return r.stateNode.current===r?e:t}function Eg(e){return e=D1(e),e!==null?xg(e):null}function xg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xg(e);if(t!==null)return t;e=e.sibling}return null}var Pg=St.unstable_scheduleCallback,ah=St.unstable_cancelCallback,L1=St.unstable_shouldYield,I1=St.unstable_requestPaint,De=St.unstable_now,M1=St.unstable_getCurrentPriorityLevel,Au=St.unstable_ImmediatePriority,Dg=St.unstable_UserBlockingPriority,Ca=St.unstable_NormalPriority,O1=St.unstable_LowPriority,Lg=St.unstable_IdlePriority,_c=null,cr=null;function N1(e){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot(_c,e,void 0,(e.current.flags&128)===128)}catch{}}var Bt=Math.clz32?Math.clz32:$1,A1=Math.log,j1=Math.LN2;function $1(e){return e>>>=0,e===0?32:31-(A1(e)/j1|0)|0}var Qo=64,Wo=4194304;function Pi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ka(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~s;a!==0?n=Pi(a):(i&=o,i!==0&&(n=Pi(i)))}else o=r&~s,o!==0?n=Pi(o):i!==0&&(n=Pi(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Bt(t),s=1<<r,n|=e[r],t&=~s;return n}function F1(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z1(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Bt(i),a=1<<o,c=s[o];c===-1?(!(a&r)||a&n)&&(s[o]=F1(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}function dd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ig(){var e=Qo;return Qo<<=1,!(Qo&4194240)&&(Qo=64),e}function ml(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bt(t),e[t]=r}function B1(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Bt(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function ju(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Bt(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var le=0;function Mg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Og,$u,Ng,Ag,jg,ud=!1,qo=[],Zr=null,en=null,tn=null,Vi=new Map,Hi=new Map,Kr=[],U1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ch(e,t){switch(e){case"focusin":case"focusout":Zr=null;break;case"dragenter":case"dragleave":en=null;break;case"mouseover":case"mouseout":tn=null;break;case"pointerover":case"pointerout":Vi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(t.pointerId)}}function wi(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=mo(t),t!==null&&$u(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function V1(e,t,r,n,s){switch(t){case"focusin":return Zr=wi(Zr,e,t,r,n,s),!0;case"dragenter":return en=wi(en,e,t,r,n,s),!0;case"mouseover":return tn=wi(tn,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Vi.set(i,wi(Vi.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Hi.set(i,wi(Hi.get(i)||null,e,t,r,n,s)),!0}return!1}function $g(e){var t=yn(e.target);if(t!==null){var r=Vn(t);if(r!==null){if(t=r.tag,t===13){if(t=Tg(r),t!==null){e.blockedOn=t,jg(e.priority,function(){Ng(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ua(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=pd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);od=n,r.target.dispatchEvent(n),od=null}else return t=mo(r),t!==null&&$u(t),e.blockedOn=r,!1;t.shift()}return!0}function lh(e,t,r){ua(e)&&r.delete(t)}function H1(){ud=!1,Zr!==null&&ua(Zr)&&(Zr=null),en!==null&&ua(en)&&(en=null),tn!==null&&ua(tn)&&(tn=null),Vi.forEach(lh),Hi.forEach(lh)}function Si(e,t){e.blockedOn===t&&(e.blockedOn=null,ud||(ud=!0,St.unstable_scheduleCallback(St.unstable_NormalPriority,H1)))}function Ki(e){function t(s){return Si(s,e)}if(0<qo.length){Si(qo[0],e);for(var r=1;r<qo.length;r++){var n=qo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Zr!==null&&Si(Zr,e),en!==null&&Si(en,e),tn!==null&&Si(tn,e),Vi.forEach(t),Hi.forEach(t),r=0;r<Kr.length;r++)n=Kr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Kr.length&&(r=Kr[0],r.blockedOn===null);)$g(r),r.blockedOn===null&&Kr.shift()}var Os=Mr.ReactCurrentBatchConfig,Ta=!0;function K1(e,t,r,n){var s=le,i=Os.transition;Os.transition=null;try{le=1,Fu(e,t,r,n)}finally{le=s,Os.transition=i}}function Q1(e,t,r,n){var s=le,i=Os.transition;Os.transition=null;try{le=4,Fu(e,t,r,n)}finally{le=s,Os.transition=i}}function Fu(e,t,r,n){if(Ta){var s=pd(e,t,r,n);if(s===null)kl(e,t,n,Ea,r),ch(e,n);else if(V1(s,e,t,r,n))n.stopPropagation();else if(ch(e,n),t&4&&-1<U1.indexOf(e)){for(;s!==null;){var i=mo(s);if(i!==null&&Og(i),i=pd(e,t,r,n),i===null&&kl(e,t,n,Ea,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else kl(e,t,n,null,r)}}var Ea=null;function pd(e,t,r,n){if(Ea=null,e=Nu(n),e=yn(e),e!==null)if(t=Vn(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Tg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ea=e,null}function Fg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M1()){case Au:return 1;case Dg:return 4;case Ca:case O1:return 16;case Lg:return 536870912;default:return 16}default:return 16}}var Gr=null,zu=null,pa=null;function zg(){if(pa)return pa;var e,t=zu,r=t.length,n,s="value"in Gr?Gr.value:Gr.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return pa=s.slice(e,1<n?1-n:void 0)}function fa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Go(){return!0}function dh(){return!1}function bt(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Go:dh,this.isPropagationStopped=dh,this}return be(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Go)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Go)},persist:function(){},isPersistent:Go}),t}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bu=bt(ei),ho=be({},ei,{view:0,detail:0}),W1=bt(ho),gl,vl,Ri,yc=be({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ri&&(Ri&&e.type==="mousemove"?(gl=e.screenX-Ri.screenX,vl=e.screenY-Ri.screenY):vl=gl=0,Ri=e),gl)},movementY:function(e){return"movementY"in e?e.movementY:vl}}),uh=bt(yc),q1=be({},yc,{dataTransfer:0}),G1=bt(q1),Y1=be({},ho,{relatedTarget:0}),_l=bt(Y1),X1=be({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),J1=bt(X1),Z1=be({},ei,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),eb=bt(Z1),tb=be({},ei,{data:0}),ph=bt(tb),rb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ib(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=sb[e])?!!t[e]:!1}function Uu(){return ib}var ob=be({},ho,{key:function(e){if(e.key){var t=rb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?nb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uu,charCode:function(e){return e.type==="keypress"?fa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ab=bt(ob),cb=be({},yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fh=bt(cb),lb=be({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uu}),db=bt(lb),ub=be({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),pb=bt(ub),fb=be({},yc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),hb=bt(fb),mb=[9,13,27,32],Vu=Pr&&"CompositionEvent"in window,Mi=null;Pr&&"documentMode"in document&&(Mi=document.documentMode);var gb=Pr&&"TextEvent"in window&&!Mi,Bg=Pr&&(!Vu||Mi&&8<Mi&&11>=Mi),hh=" ",mh=!1;function Ug(e,t){switch(e){case"keyup":return mb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ys=!1;function vb(e,t){switch(e){case"compositionend":return Vg(t);case"keypress":return t.which!==32?null:(mh=!0,hh);case"textInput":return e=t.data,e===hh&&mh?null:e;default:return null}}function _b(e,t){if(ys)return e==="compositionend"||!Vu&&Ug(e,t)?(e=zg(),pa=zu=Gr=null,ys=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bg&&t.locale!=="ko"?null:t.data;default:return null}}var yb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yb[e.type]:t==="textarea"}function Hg(e,t,r,n){Sg(n),t=xa(t,"onChange"),0<t.length&&(r=new Bu("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oi=null,Qi=null;function wb(e){tv(e,0)}function wc(e){var t=Rs(e);if(hg(t))return e}function Sb(e,t){if(e==="change")return t}var Kg=!1;if(Pr){var yl;if(Pr){var wl="oninput"in document;if(!wl){var vh=document.createElement("div");vh.setAttribute("oninput","return;"),wl=typeof vh.oninput=="function"}yl=wl}else yl=!1;Kg=yl&&(!document.documentMode||9<document.documentMode)}function _h(){Oi&&(Oi.detachEvent("onpropertychange",Qg),Qi=Oi=null)}function Qg(e){if(e.propertyName==="value"&&wc(Qi)){var t=[];Hg(t,Qi,e,Nu(e)),kg(wb,t)}}function Rb(e,t,r){e==="focusin"?(_h(),Oi=t,Qi=r,Oi.attachEvent("onpropertychange",Qg)):e==="focusout"&&_h()}function bb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wc(Qi)}function Cb(e,t){if(e==="click")return wc(t)}function kb(e,t){if(e==="input"||e==="change")return wc(t)}function Tb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vt=typeof Object.is=="function"?Object.is:Tb;function Wi(e,t){if(Vt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!ql.call(t,s)||!Vt(e[s],t[s]))return!1}return!0}function yh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wh(e,t){var r=yh(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yh(r)}}function Wg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Wg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qg(){for(var e=window,t=Sa();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sa(e.document)}return t}function Hu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Eb(e){var t=qg(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Wg(r.ownerDocument.documentElement,r)){if(n!==null&&Hu(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=wh(r,i);var o=wh(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xb=Pr&&"documentMode"in document&&11>=document.documentMode,ws=null,fd=null,Ni=null,hd=!1;function Sh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;hd||ws==null||ws!==Sa(n)||(n=ws,"selectionStart"in n&&Hu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ni&&Wi(Ni,n)||(Ni=n,n=xa(fd,"onSelect"),0<n.length&&(t=new Bu("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ws)))}function Yo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ss={animationend:Yo("Animation","AnimationEnd"),animationiteration:Yo("Animation","AnimationIteration"),animationstart:Yo("Animation","AnimationStart"),transitionend:Yo("Transition","TransitionEnd")},Sl={},Gg={};Pr&&(Gg=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function Sc(e){if(Sl[e])return Sl[e];if(!Ss[e])return e;var t=Ss[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Gg)return Sl[e]=t[r];return e}var Yg=Sc("animationend"),Xg=Sc("animationiteration"),Jg=Sc("animationstart"),Zg=Sc("transitionend"),ev=new Map,Rh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dn(e,t){ev.set(e,t),Un(t,[e])}for(var Rl=0;Rl<Rh.length;Rl++){var bl=Rh[Rl],Pb=bl.toLowerCase(),Db=bl[0].toUpperCase()+bl.slice(1);dn(Pb,"on"+Db)}dn(Yg,"onAnimationEnd");dn(Xg,"onAnimationIteration");dn(Jg,"onAnimationStart");dn("dblclick","onDoubleClick");dn("focusin","onFocus");dn("focusout","onBlur");dn(Zg,"onTransitionEnd");Bs("onMouseEnter",["mouseout","mouseover"]);Bs("onMouseLeave",["mouseout","mouseover"]);Bs("onPointerEnter",["pointerout","pointerover"]);Bs("onPointerLeave",["pointerout","pointerover"]);Un("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Un("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Un("onBeforeInput",["compositionend","keypress","textInput","paste"]);Un("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Un("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Un("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function bh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,P1(n,t,void 0,e),e.currentTarget=null}function tv(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;bh(s,a,l),i=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;bh(s,a,l),i=c}}}if(ba)throw e=ld,ba=!1,ld=null,e}function ve(e,t){var r=t[yd];r===void 0&&(r=t[yd]=new Set);var n=e+"__bubble";r.has(n)||(rv(t,e,2,!1),r.add(n))}function Cl(e,t,r){var n=0;t&&(n|=4),rv(r,e,n,t)}var Xo="_reactListening"+Math.random().toString(36).slice(2);function qi(e){if(!e[Xo]){e[Xo]=!0,lg.forEach(function(r){r!=="selectionchange"&&(Lb.has(r)||Cl(r,!1,e),Cl(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xo]||(t[Xo]=!0,Cl("selectionchange",!1,t))}}function rv(e,t,r,n){switch(Fg(t)){case 1:var s=K1;break;case 4:s=Q1;break;default:s=Fu}r=s.bind(null,t,r,e),s=void 0,!cd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function kl(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=yn(a),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}a=a.parentNode}}n=n.return}kg(function(){var l=i,u=Nu(r),d=[];e:{var p=ev.get(e);if(p!==void 0){var f=Bu,y=e;switch(e){case"keypress":if(fa(r)===0)break e;case"keydown":case"keyup":f=ab;break;case"focusin":y="focus",f=_l;break;case"focusout":y="blur",f=_l;break;case"beforeblur":case"afterblur":f=_l;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=uh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=G1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=db;break;case Yg:case Xg:case Jg:f=J1;break;case Zg:f=pb;break;case"scroll":f=W1;break;case"wheel":f=hb;break;case"copy":case"cut":case"paste":f=eb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=fh}var w=(t&4)!==0,b=!w&&e==="scroll",h=w?p!==null?p+"Capture":null:p;w=[];for(var g=l,m;g!==null;){m=g;var _=m.stateNode;if(m.tag===5&&_!==null&&(m=_,h!==null&&(_=Ui(g,h),_!=null&&w.push(Gi(g,_,m)))),b)break;g=g.return}0<w.length&&(p=new f(p,y,null,r,u),d.push({event:p,listeners:w}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&r!==od&&(y=r.relatedTarget||r.fromElement)&&(yn(y)||y[Dr]))break e;if((f||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,f?(y=r.relatedTarget||r.toElement,f=l,y=y?yn(y):null,y!==null&&(b=Vn(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=l),f!==y)){if(w=uh,_="onMouseLeave",h="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(w=fh,_="onPointerLeave",h="onPointerEnter",g="pointer"),b=f==null?p:Rs(f),m=y==null?p:Rs(y),p=new w(_,g+"leave",f,r,u),p.target=b,p.relatedTarget=m,_=null,yn(u)===l&&(w=new w(h,g+"enter",y,r,u),w.target=m,w.relatedTarget=b,_=w),b=_,f&&y)t:{for(w=f,h=y,g=0,m=w;m;m=ms(m))g++;for(m=0,_=h;_;_=ms(_))m++;for(;0<g-m;)w=ms(w),g--;for(;0<m-g;)h=ms(h),m--;for(;g--;){if(w===h||h!==null&&w===h.alternate)break t;w=ms(w),h=ms(h)}w=null}else w=null;f!==null&&Ch(d,p,f,w,!1),y!==null&&b!==null&&Ch(d,b,y,w,!0)}}e:{if(p=l?Rs(l):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=Sb;else if(gh(p))if(Kg)S=kb;else{S=bb;var R=Rb}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=Cb);if(S&&(S=S(e,l))){Hg(d,S,r,u);break e}R&&R(e,p,l),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&td(p,"number",p.value)}switch(R=l?Rs(l):window,e){case"focusin":(gh(R)||R.contentEditable==="true")&&(ws=R,fd=l,Ni=null);break;case"focusout":Ni=fd=ws=null;break;case"mousedown":hd=!0;break;case"contextmenu":case"mouseup":case"dragend":hd=!1,Sh(d,r,u);break;case"selectionchange":if(xb)break;case"keydown":case"keyup":Sh(d,r,u)}var E;if(Vu)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else ys?Ug(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(Bg&&r.locale!=="ko"&&(ys||P!=="onCompositionStart"?P==="onCompositionEnd"&&ys&&(E=zg()):(Gr=u,zu="value"in Gr?Gr.value:Gr.textContent,ys=!0)),R=xa(l,P),0<R.length&&(P=new ph(P,e,null,r,u),d.push({event:P,listeners:R}),E?P.data=E:(E=Vg(r),E!==null&&(P.data=E)))),(E=gb?vb(e,r):_b(e,r))&&(l=xa(l,"onBeforeInput"),0<l.length&&(u=new ph("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:l}),u.data=E))}tv(d,t)})}function Gi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function xa(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ui(e,r),i!=null&&n.unshift(Gi(e,i,s)),i=Ui(e,t),i!=null&&n.push(Gi(e,i,s))),e=e.return}return n}function ms(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ch(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,l=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&l!==null&&(a=l,s?(c=Ui(r,i),c!=null&&o.unshift(Gi(r,c,a))):s||(c=Ui(r,i),c!=null&&o.push(Gi(r,c,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Ib=/\r\n?/g,Mb=/\u0000|\uFFFD/g;function kh(e){return(typeof e=="string"?e:""+e).replace(Ib,`
`).replace(Mb,"")}function Jo(e,t,r){if(t=kh(t),kh(e)!==t&&r)throw Error(k(425))}function Pa(){}var md=null,gd=null;function vd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _d=typeof setTimeout=="function"?setTimeout:void 0,Ob=typeof clearTimeout=="function"?clearTimeout:void 0,Th=typeof Promise=="function"?Promise:void 0,Nb=typeof queueMicrotask=="function"?queueMicrotask:typeof Th<"u"?function(e){return Th.resolve(null).then(e).catch(Ab)}:_d;function Ab(e){setTimeout(function(){throw e})}function Tl(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ki(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ki(t)}function rn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Eh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ti=Math.random().toString(36).slice(2),or="__reactFiber$"+ti,Yi="__reactProps$"+ti,Dr="__reactContainer$"+ti,yd="__reactEvents$"+ti,jb="__reactListeners$"+ti,$b="__reactHandles$"+ti;function yn(e){var t=e[or];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Dr]||r[or]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Eh(e);e!==null;){if(r=e[or])return r;e=Eh(e)}return t}e=r,r=e.parentNode}return null}function mo(e){return e=e[or]||e[Dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(k(33))}function Rc(e){return e[Yi]||null}var wd=[],bs=-1;function un(e){return{current:e}}function _e(e){0>bs||(e.current=wd[bs],wd[bs]=null,bs--)}function me(e,t){bs++,wd[bs]=e.current,e.current=t}var ln={},st=un(ln),ft=un(!1),On=ln;function Us(e,t){var r=e.type.contextTypes;if(!r)return ln;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ht(e){return e=e.childContextTypes,e!=null}function Da(){_e(ft),_e(st)}function xh(e,t,r){if(st.current!==ln)throw Error(k(168));me(st,t),me(ft,r)}function nv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(k(108,R1(e)||"Unknown",s));return be({},r,n)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ln,On=st.current,me(st,e),me(ft,ft.current),!0}function Ph(e,t,r){var n=e.stateNode;if(!n)throw Error(k(169));r?(e=nv(e,t,On),n.__reactInternalMemoizedMergedChildContext=e,_e(ft),_e(st),me(st,e)):_e(ft),me(ft,r)}var kr=null,bc=!1,El=!1;function sv(e){kr===null?kr=[e]:kr.push(e)}function Fb(e){bc=!0,sv(e)}function pn(){if(!El&&kr!==null){El=!0;var e=0,t=le;try{var r=kr;for(le=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}kr=null,bc=!1}catch(s){throw kr!==null&&(kr=kr.slice(e+1)),Pg(Au,pn),s}finally{le=t,El=!1}}return null}var Cs=[],ks=0,Ia=null,Ma=0,Tt=[],Et=0,Nn=null,Tr=1,Er="";function gn(e,t){Cs[ks++]=Ma,Cs[ks++]=Ia,Ia=e,Ma=t}function iv(e,t,r){Tt[Et++]=Tr,Tt[Et++]=Er,Tt[Et++]=Nn,Nn=e;var n=Tr;e=Er;var s=32-Bt(n)-1;n&=~(1<<s),r+=1;var i=32-Bt(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Tr=1<<32-Bt(t)+s|r<<s|n,Er=i+e}else Tr=1<<i|r<<s|n,Er=e}function Ku(e){e.return!==null&&(gn(e,1),iv(e,1,0))}function Qu(e){for(;e===Ia;)Ia=Cs[--ks],Cs[ks]=null,Ma=Cs[--ks],Cs[ks]=null;for(;e===Nn;)Nn=Tt[--Et],Tt[Et]=null,Er=Tt[--Et],Tt[Et]=null,Tr=Tt[--Et],Tt[Et]=null}var wt=null,yt=null,ye=!1,Ft=null;function ov(e,t){var r=xt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Dh(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,wt=e,yt=rn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,wt=e,yt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Nn!==null?{id:Tr,overflow:Er}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=xt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,wt=e,yt=null,!0):!1;default:return!1}}function Sd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Rd(e){if(ye){var t=yt;if(t){var r=t;if(!Dh(e,t)){if(Sd(e))throw Error(k(418));t=rn(r.nextSibling);var n=wt;t&&Dh(e,t)?ov(n,r):(e.flags=e.flags&-4097|2,ye=!1,wt=e)}}else{if(Sd(e))throw Error(k(418));e.flags=e.flags&-4097|2,ye=!1,wt=e}}}function Lh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wt=e}function Zo(e){if(e!==wt)return!1;if(!ye)return Lh(e),ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!vd(e.type,e.memoizedProps)),t&&(t=yt)){if(Sd(e))throw av(),Error(k(418));for(;t;)ov(e,t),t=rn(t.nextSibling)}if(Lh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(k(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){yt=rn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}yt=null}}else yt=wt?rn(e.stateNode.nextSibling):null;return!0}function av(){for(var e=yt;e;)e=rn(e.nextSibling)}function Vs(){yt=wt=null,ye=!1}function Wu(e){Ft===null?Ft=[e]:Ft.push(e)}var zb=Mr.ReactCurrentBatchConfig;function bi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(k(309));var n=r.stateNode}if(!n)throw Error(k(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(k(284));if(!r._owner)throw Error(k(290,e))}return e}function ea(e,t){throw e=Object.prototype.toString.call(t),Error(k(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ih(e){var t=e._init;return t(e._payload)}function cv(e){function t(h,g){if(e){var m=h.deletions;m===null?(h.deletions=[g],h.flags|=16):m.push(g)}}function r(h,g){if(!e)return null;for(;g!==null;)t(h,g),g=g.sibling;return null}function n(h,g){for(h=new Map;g!==null;)g.key!==null?h.set(g.key,g):h.set(g.index,g),g=g.sibling;return h}function s(h,g){return h=an(h,g),h.index=0,h.sibling=null,h}function i(h,g,m){return h.index=m,e?(m=h.alternate,m!==null?(m=m.index,m<g?(h.flags|=2,g):m):(h.flags|=2,g)):(h.flags|=1048576,g)}function o(h){return e&&h.alternate===null&&(h.flags|=2),h}function a(h,g,m,_){return g===null||g.tag!==6?(g=Ol(m,h.mode,_),g.return=h,g):(g=s(g,m),g.return=h,g)}function c(h,g,m,_){var S=m.type;return S===_s?u(h,g,m.props.children,_,m.key):g!==null&&(g.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vr&&Ih(S)===g.type)?(_=s(g,m.props),_.ref=bi(h,g,m),_.return=h,_):(_=wa(m.type,m.key,m.props,null,h.mode,_),_.ref=bi(h,g,m),_.return=h,_)}function l(h,g,m,_){return g===null||g.tag!==4||g.stateNode.containerInfo!==m.containerInfo||g.stateNode.implementation!==m.implementation?(g=Nl(m,h.mode,_),g.return=h,g):(g=s(g,m.children||[]),g.return=h,g)}function u(h,g,m,_,S){return g===null||g.tag!==7?(g=Ln(m,h.mode,_,S),g.return=h,g):(g=s(g,m),g.return=h,g)}function d(h,g,m){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Ol(""+g,h.mode,m),g.return=h,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Vo:return m=wa(g.type,g.key,g.props,null,h.mode,m),m.ref=bi(h,null,g),m.return=h,m;case vs:return g=Nl(g,h.mode,m),g.return=h,g;case Vr:var _=g._init;return d(h,_(g._payload),m)}if(xi(g)||_i(g))return g=Ln(g,h.mode,m,null),g.return=h,g;ea(h,g)}return null}function p(h,g,m,_){var S=g!==null?g.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return S!==null?null:a(h,g,""+m,_);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Vo:return m.key===S?c(h,g,m,_):null;case vs:return m.key===S?l(h,g,m,_):null;case Vr:return S=m._init,p(h,g,S(m._payload),_)}if(xi(m)||_i(m))return S!==null?null:u(h,g,m,_,null);ea(h,m)}return null}function f(h,g,m,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return h=h.get(m)||null,a(g,h,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vo:return h=h.get(_.key===null?m:_.key)||null,c(g,h,_,S);case vs:return h=h.get(_.key===null?m:_.key)||null,l(g,h,_,S);case Vr:var R=_._init;return f(h,g,m,R(_._payload),S)}if(xi(_)||_i(_))return h=h.get(m)||null,u(g,h,_,S,null);ea(g,_)}return null}function y(h,g,m,_){for(var S=null,R=null,E=g,P=g=0,C=null;E!==null&&P<m.length;P++){E.index>P?(C=E,E=null):C=E.sibling;var A=p(h,E,m[P],_);if(A===null){E===null&&(E=C);break}e&&E&&A.alternate===null&&t(h,E),g=i(A,g,P),R===null?S=A:R.sibling=A,R=A,E=C}if(P===m.length)return r(h,E),ye&&gn(h,P),S;if(E===null){for(;P<m.length;P++)E=d(h,m[P],_),E!==null&&(g=i(E,g,P),R===null?S=E:R.sibling=E,R=E);return ye&&gn(h,P),S}for(E=n(h,E);P<m.length;P++)C=f(E,h,P,m[P],_),C!==null&&(e&&C.alternate!==null&&E.delete(C.key===null?P:C.key),g=i(C,g,P),R===null?S=C:R.sibling=C,R=C);return e&&E.forEach(function(x){return t(h,x)}),ye&&gn(h,P),S}function w(h,g,m,_){var S=_i(m);if(typeof S!="function")throw Error(k(150));if(m=S.call(m),m==null)throw Error(k(151));for(var R=S=null,E=g,P=g=0,C=null,A=m.next();E!==null&&!A.done;P++,A=m.next()){E.index>P?(C=E,E=null):C=E.sibling;var x=p(h,E,A.value,_);if(x===null){E===null&&(E=C);break}e&&E&&x.alternate===null&&t(h,E),g=i(x,g,P),R===null?S=x:R.sibling=x,R=x,E=C}if(A.done)return r(h,E),ye&&gn(h,P),S;if(E===null){for(;!A.done;P++,A=m.next())A=d(h,A.value,_),A!==null&&(g=i(A,g,P),R===null?S=A:R.sibling=A,R=A);return ye&&gn(h,P),S}for(E=n(h,E);!A.done;P++,A=m.next())A=f(E,h,P,A.value,_),A!==null&&(e&&A.alternate!==null&&E.delete(A.key===null?P:A.key),g=i(A,g,P),R===null?S=A:R.sibling=A,R=A);return e&&E.forEach(function(B){return t(h,B)}),ye&&gn(h,P),S}function b(h,g,m,_){if(typeof m=="object"&&m!==null&&m.type===_s&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Vo:e:{for(var S=m.key,R=g;R!==null;){if(R.key===S){if(S=m.type,S===_s){if(R.tag===7){r(h,R.sibling),g=s(R,m.props.children),g.return=h,h=g;break e}}else if(R.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Vr&&Ih(S)===R.type){r(h,R.sibling),g=s(R,m.props),g.ref=bi(h,R,m),g.return=h,h=g;break e}r(h,R);break}else t(h,R);R=R.sibling}m.type===_s?(g=Ln(m.props.children,h.mode,_,m.key),g.return=h,h=g):(_=wa(m.type,m.key,m.props,null,h.mode,_),_.ref=bi(h,g,m),_.return=h,h=_)}return o(h);case vs:e:{for(R=m.key;g!==null;){if(g.key===R)if(g.tag===4&&g.stateNode.containerInfo===m.containerInfo&&g.stateNode.implementation===m.implementation){r(h,g.sibling),g=s(g,m.children||[]),g.return=h,h=g;break e}else{r(h,g);break}else t(h,g);g=g.sibling}g=Nl(m,h.mode,_),g.return=h,h=g}return o(h);case Vr:return R=m._init,b(h,g,R(m._payload),_)}if(xi(m))return y(h,g,m,_);if(_i(m))return w(h,g,m,_);ea(h,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,g!==null&&g.tag===6?(r(h,g.sibling),g=s(g,m),g.return=h,h=g):(r(h,g),g=Ol(m,h.mode,_),g.return=h,h=g),o(h)):r(h,g)}return b}var Hs=cv(!0),lv=cv(!1),Oa=un(null),Na=null,Ts=null,qu=null;function Gu(){qu=Ts=Na=null}function Yu(e){var t=Oa.current;_e(Oa),e._currentValue=t}function bd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ns(e,t){Na=e,qu=Ts=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(pt=!0),e.firstContext=null)}function Lt(e){var t=e._currentValue;if(qu!==e)if(e={context:e,memoizedValue:t,next:null},Ts===null){if(Na===null)throw Error(k(308));Ts=e,Na.dependencies={lanes:0,firstContext:e}}else Ts=Ts.next=e;return t}var wn=null;function Xu(e){wn===null?wn=[e]:wn.push(e)}function dv(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Xu(t)):(r.next=s.next,s.next=r),t.interleaved=r,Lr(e,n)}function Lr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hr=!1;function Ju(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function nn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,se&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Lr(e,r)}return s=n.interleaved,s===null?(t.next=t,Xu(n)):(t.next=s.next,s.next=t),n.interleaved=t,Lr(e,r)}function ha(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ju(e,r)}}function Mh(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Aa(e,t,r,n){var s=e.updateQueue;Hr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?i=l:o.next=l,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(i!==null){var d=s.baseState;o=0,u=l=c=null,a=i;do{var p=a.lane,f=a.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,w=a;switch(p=t,f=r,w.tag){case 1:if(y=w.payload,typeof y=="function"){d=y.call(f,d,p);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,p=typeof y=="function"?y.call(f,d,p):y,p==null)break e;d=be({},d,p);break e;case 2:Hr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else f={eventTime:f,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=f,c=d):u=u.next=f,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=d),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);jn|=o,e.lanes=o,e.memoizedState=d}}function Oh(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(k(191,s));s.call(n)}}}var go={},lr=un(go),Xi=un(go),Ji=un(go);function Sn(e){if(e===go)throw Error(k(174));return e}function Zu(e,t){switch(me(Ji,t),me(Xi,e),me(lr,go),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:nd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=nd(t,e)}_e(lr),me(lr,t)}function Ks(){_e(lr),_e(Xi),_e(Ji)}function pv(e){Sn(Ji.current);var t=Sn(lr.current),r=nd(t,e.type);t!==r&&(me(Xi,e),me(lr,r))}function ep(e){Xi.current===e&&(_e(lr),_e(Xi))}var Se=un(0);function ja(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xl=[];function tp(){for(var e=0;e<xl.length;e++)xl[e]._workInProgressVersionPrimary=null;xl.length=0}var ma=Mr.ReactCurrentDispatcher,Pl=Mr.ReactCurrentBatchConfig,An=0,Re=null,je=null,Fe=null,$a=!1,Ai=!1,Zi=0,Bb=0;function et(){throw Error(k(321))}function rp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vt(e[r],t[r]))return!1;return!0}function np(e,t,r,n,s,i){if(An=i,Re=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ma.current=e===null||e.memoizedState===null?Kb:Qb,e=r(n,s),Ai){i=0;do{if(Ai=!1,Zi=0,25<=i)throw Error(k(301));i+=1,Fe=je=null,t.updateQueue=null,ma.current=Wb,e=r(n,s)}while(Ai)}if(ma.current=Fa,t=je!==null&&je.next!==null,An=0,Fe=je=Re=null,$a=!1,t)throw Error(k(300));return e}function sp(){var e=Zi!==0;return Zi=0,e}function nr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fe===null?Re.memoizedState=Fe=e:Fe=Fe.next=e,Fe}function It(){if(je===null){var e=Re.alternate;e=e!==null?e.memoizedState:null}else e=je.next;var t=Fe===null?Re.memoizedState:Fe.next;if(t!==null)Fe=t,je=e;else{if(e===null)throw Error(k(310));je=e,e={memoizedState:je.memoizedState,baseState:je.baseState,baseQueue:je.baseQueue,queue:je.queue,next:null},Fe===null?Re.memoizedState=Fe=e:Fe=Fe.next=e}return Fe}function eo(e,t){return typeof t=="function"?t(e):t}function Dl(e){var t=It(),r=t.queue;if(r===null)throw Error(k(311));r.lastRenderedReducer=e;var n=je,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,c=null,l=i;do{var u=l.lane;if((An&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=n):c=c.next=d,Re.lanes|=u,jn|=u}l=l.next}while(l!==null&&l!==i);c===null?o=n:c.next=a,Vt(n,t.memoizedState)||(pt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Re.lanes|=i,jn|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ll(e){var t=It(),r=t.queue;if(r===null)throw Error(k(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Vt(i,t.memoizedState)||(pt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function fv(){}function hv(e,t){var r=Re,n=It(),s=t(),i=!Vt(n.memoizedState,s);if(i&&(n.memoizedState=s,pt=!0),n=n.queue,ip(vv.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Fe!==null&&Fe.memoizedState.tag&1){if(r.flags|=2048,to(9,gv.bind(null,r,n,s,t),void 0,null),ze===null)throw Error(k(349));An&30||mv(r,t,s)}return s}function mv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function gv(e,t,r,n){t.value=r,t.getSnapshot=n,_v(t)&&yv(e)}function vv(e,t,r){return r(function(){_v(t)&&yv(e)})}function _v(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vt(e,r)}catch{return!0}}function yv(e){var t=Lr(e,1);t!==null&&Ut(t,e,1,-1)}function Nh(e){var t=nr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:e},t.queue=e,e=e.dispatch=Hb.bind(null,Re,e),[t.memoizedState,e]}function to(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function wv(){return It().memoizedState}function ga(e,t,r,n){var s=nr();Re.flags|=e,s.memoizedState=to(1|t,r,void 0,n===void 0?null:n)}function Cc(e,t,r,n){var s=It();n=n===void 0?null:n;var i=void 0;if(je!==null){var o=je.memoizedState;if(i=o.destroy,n!==null&&rp(n,o.deps)){s.memoizedState=to(t,r,i,n);return}}Re.flags|=e,s.memoizedState=to(1|t,r,i,n)}function Ah(e,t){return ga(8390656,8,e,t)}function ip(e,t){return Cc(2048,8,e,t)}function Sv(e,t){return Cc(4,2,e,t)}function Rv(e,t){return Cc(4,4,e,t)}function bv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Cv(e,t,r){return r=r!=null?r.concat([e]):null,Cc(4,4,bv.bind(null,t,e),r)}function op(){}function kv(e,t){var r=It();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Tv(e,t){var r=It();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ev(e,t,r){return An&21?(Vt(r,t)||(r=Ig(),Re.lanes|=r,jn|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,pt=!0),e.memoizedState=r)}function Ub(e,t){var r=le;le=r!==0&&4>r?r:4,e(!0);var n=Pl.transition;Pl.transition={};try{e(!1),t()}finally{le=r,Pl.transition=n}}function xv(){return It().memoizedState}function Vb(e,t,r){var n=on(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Pv(e))Dv(t,r);else if(r=dv(e,t,r,n),r!==null){var s=at();Ut(r,e,n,s),Lv(r,t,n)}}function Hb(e,t,r){var n=on(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Pv(e))Dv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,Vt(a,o)){var c=t.interleaved;c===null?(s.next=s,Xu(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=dv(e,t,s,n),r!==null&&(s=at(),Ut(r,e,n,s),Lv(r,t,n))}}function Pv(e){var t=e.alternate;return e===Re||t!==null&&t===Re}function Dv(e,t){Ai=$a=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Lv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ju(e,r)}}var Fa={readContext:Lt,useCallback:et,useContext:et,useEffect:et,useImperativeHandle:et,useInsertionEffect:et,useLayoutEffect:et,useMemo:et,useReducer:et,useRef:et,useState:et,useDebugValue:et,useDeferredValue:et,useTransition:et,useMutableSource:et,useSyncExternalStore:et,useId:et,unstable_isNewReconciler:!1},Kb={readContext:Lt,useCallback:function(e,t){return nr().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:Ah,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ga(4194308,4,bv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ga(4194308,4,e,t)},useInsertionEffect:function(e,t){return ga(4,2,e,t)},useMemo:function(e,t){var r=nr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=nr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Vb.bind(null,Re,e),[n.memoizedState,e]},useRef:function(e){var t=nr();return e={current:e},t.memoizedState=e},useState:Nh,useDebugValue:op,useDeferredValue:function(e){return nr().memoizedState=e},useTransition:function(){var e=Nh(!1),t=e[0];return e=Ub.bind(null,e[1]),nr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Re,s=nr();if(ye){if(r===void 0)throw Error(k(407));r=r()}else{if(r=t(),ze===null)throw Error(k(349));An&30||mv(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Ah(vv.bind(null,n,i,e),[e]),n.flags|=2048,to(9,gv.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=nr(),t=ze.identifierPrefix;if(ye){var r=Er,n=Tr;r=(n&~(1<<32-Bt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Zi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Bb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qb={readContext:Lt,useCallback:kv,useContext:Lt,useEffect:ip,useImperativeHandle:Cv,useInsertionEffect:Sv,useLayoutEffect:Rv,useMemo:Tv,useReducer:Dl,useRef:wv,useState:function(){return Dl(eo)},useDebugValue:op,useDeferredValue:function(e){var t=It();return Ev(t,je.memoizedState,e)},useTransition:function(){var e=Dl(eo)[0],t=It().memoizedState;return[e,t]},useMutableSource:fv,useSyncExternalStore:hv,useId:xv,unstable_isNewReconciler:!1},Wb={readContext:Lt,useCallback:kv,useContext:Lt,useEffect:ip,useImperativeHandle:Cv,useInsertionEffect:Sv,useLayoutEffect:Rv,useMemo:Tv,useReducer:Ll,useRef:wv,useState:function(){return Ll(eo)},useDebugValue:op,useDeferredValue:function(e){var t=It();return je===null?t.memoizedState=e:Ev(t,je.memoizedState,e)},useTransition:function(){var e=Ll(eo)[0],t=It().memoizedState;return[e,t]},useMutableSource:fv,useSyncExternalStore:hv,useId:xv,unstable_isNewReconciler:!1};function At(e,t){if(e&&e.defaultProps){t=be({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Cd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:be({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var kc={isMounted:function(e){return(e=e._reactInternals)?Vn(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=at(),s=on(e),i=xr(n,s);i.payload=t,r!=null&&(i.callback=r),t=nn(e,i,s),t!==null&&(Ut(t,e,s,n),ha(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=at(),s=on(e),i=xr(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=nn(e,i,s),t!==null&&(Ut(t,e,s,n),ha(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=at(),n=on(e),s=xr(r,n);s.tag=2,t!=null&&(s.callback=t),t=nn(e,s,n),t!==null&&(Ut(t,e,n,r),ha(t,e,n))}};function jh(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Wi(r,n)||!Wi(s,i):!0}function Iv(e,t,r){var n=!1,s=ln,i=t.contextType;return typeof i=="object"&&i!==null?i=Lt(i):(s=ht(t)?On:st.current,n=t.contextTypes,i=(n=n!=null)?Us(e,s):ln),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=kc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function $h(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&kc.enqueueReplaceState(t,t.state,null)}function kd(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Ju(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Lt(i):(i=ht(t)?On:st.current,s.context=Us(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Cd(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&kc.enqueueReplaceState(s,s.state,null),Aa(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qs(e,t){try{var r="",n=t;do r+=S1(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Il(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Td(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var qb=typeof WeakMap=="function"?WeakMap:Map;function Mv(e,t,r){r=xr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ba||(Ba=!0,Ad=n),Td(e,t)},r}function Ov(e,t,r){r=xr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Td(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Td(e,t),typeof n!="function"&&(sn===null?sn=new Set([this]):sn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Fh(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new qb;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=cC.bind(null,e,t,r),t.then(e,e))}function zh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Bh(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=xr(-1,1),t.tag=2,nn(r,t,1))),r.lanes|=1),e)}var Gb=Mr.ReactCurrentOwner,pt=!1;function ot(e,t,r,n){t.child=e===null?lv(t,null,r,n):Hs(t,e.child,r,n)}function Uh(e,t,r,n,s){r=r.render;var i=t.ref;return Ns(t,s),n=np(e,t,r,n,i,s),r=sp(),e!==null&&!pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ir(e,t,s)):(ye&&r&&Ku(t),t.flags|=1,ot(e,t,n,s),t.child)}function Vh(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!hp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Nv(e,t,i,n,s)):(e=wa(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Wi,r(o,n)&&e.ref===t.ref)return Ir(e,t,s)}return t.flags|=1,e=an(i,n),e.ref=t.ref,e.return=t,t.child=e}function Nv(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Wi(i,n)&&e.ref===t.ref)if(pt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(pt=!0);else return t.lanes=e.lanes,Ir(e,t,s)}return Ed(e,t,r,n,s)}function Av(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(xs,_t),_t|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,me(xs,_t),_t|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,me(xs,_t),_t|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,me(xs,_t),_t|=n;return ot(e,t,s,r),t.child}function jv(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ed(e,t,r,n,s){var i=ht(r)?On:st.current;return i=Us(t,i),Ns(t,s),r=np(e,t,r,n,i,s),n=sp(),e!==null&&!pt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ir(e,t,s)):(ye&&n&&Ku(t),t.flags|=1,ot(e,t,r,s),t.child)}function Hh(e,t,r,n,s){if(ht(r)){var i=!0;La(t)}else i=!1;if(Ns(t,s),t.stateNode===null)va(e,t),Iv(t,r,n),kd(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=r.contextType;typeof l=="object"&&l!==null?l=Lt(l):(l=ht(r)?On:st.current,l=Us(t,l));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&$h(t,o,n,l),Hr=!1;var p=t.memoizedState;o.state=p,Aa(t,n,o,s),c=t.memoizedState,a!==n||p!==c||ft.current||Hr?(typeof u=="function"&&(Cd(t,r,u,n),c=t.memoizedState),(a=Hr||jh(t,r,a,n,p,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=l,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,uv(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:At(t.type,a),o.props=l,d=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Lt(c):(c=ht(r)?On:st.current,c=Us(t,c));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==c)&&$h(t,o,n,c),Hr=!1,p=t.memoizedState,o.state=p,Aa(t,n,o,s);var y=t.memoizedState;a!==d||p!==y||ft.current||Hr?(typeof f=="function"&&(Cd(t,r,f,n),y=t.memoizedState),(l=Hr||jh(t,r,l,n,p,y,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=l):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return xd(e,t,r,n,i,s)}function xd(e,t,r,n,s,i){jv(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Ph(t,r,!1),Ir(e,t,i);n=t.stateNode,Gb.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Hs(t,e.child,null,i),t.child=Hs(t,null,a,i)):ot(e,t,a,i),t.memoizedState=n.state,s&&Ph(t,r,!0),t.child}function $v(e){var t=e.stateNode;t.pendingContext?xh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xh(e,t.context,!1),Zu(e,t.containerInfo)}function Kh(e,t,r,n,s){return Vs(),Wu(s),t.flags|=256,ot(e,t,r,n),t.child}var Pd={dehydrated:null,treeContext:null,retryLane:0};function Dd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fv(e,t,r){var n=t.pendingProps,s=Se.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),me(Se,s&1),e===null)return Rd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=xc(o,n,0,null),e=Ln(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Dd(r),t.memoizedState=Pd,e):ap(t,o));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Yb(e,t,o,n,a,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,a=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=an(s,c),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=an(a,i):(i=Ln(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Dd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Pd,n}return i=e.child,e=i.sibling,n=an(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ap(e,t){return t=xc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ta(e,t,r,n){return n!==null&&Wu(n),Hs(t,e.child,null,r),e=ap(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Yb(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Il(Error(k(422))),ta(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=xc({mode:"visible",children:n.children},s,0,null),i=Ln(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Hs(t,e.child,null,o),t.child.memoizedState=Dd(o),t.memoizedState=Pd,i);if(!(t.mode&1))return ta(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(k(419)),n=Il(i,n,void 0),ta(e,t,o,n)}if(a=(o&e.childLanes)!==0,pt||a){if(n=ze,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Lr(e,s),Ut(n,e,s,-1))}return fp(),n=Il(Error(k(421))),ta(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=lC.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,yt=rn(s.nextSibling),wt=t,ye=!0,Ft=null,e!==null&&(Tt[Et++]=Tr,Tt[Et++]=Er,Tt[Et++]=Nn,Tr=e.id,Er=e.overflow,Nn=t),t=ap(t,n.children),t.flags|=4096,t)}function Qh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),bd(e.return,t,r)}function Ml(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function zv(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(ot(e,t,n.children,r),n=Se.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Qh(e,r,t);else if(e.tag===19)Qh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(me(Se,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&ja(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Ml(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ja(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Ml(t,!0,r,null,i);break;case"together":Ml(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function va(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ir(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),jn|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(k(153));if(t.child!==null){for(e=t.child,r=an(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=an(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Xb(e,t,r){switch(t.tag){case 3:$v(t),Vs();break;case 5:pv(t);break;case 1:ht(t.type)&&La(t);break;case 4:Zu(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;me(Oa,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(me(Se,Se.current&1),t.flags|=128,null):r&t.child.childLanes?Fv(e,t,r):(me(Se,Se.current&1),e=Ir(e,t,r),e!==null?e.sibling:null);me(Se,Se.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return zv(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),me(Se,Se.current),n)break;return null;case 22:case 23:return t.lanes=0,Av(e,t,r)}return Ir(e,t,r)}var Bv,Ld,Uv,Vv;Bv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ld=function(){};Uv=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Sn(lr.current);var i=null;switch(r){case"input":s=Zl(e,s),n=Zl(e,n),i=[];break;case"select":s=be({},s,{value:void 0}),n=be({},n,{value:void 0}),i=[];break;case"textarea":s=rd(e,s),n=rd(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Pa)}sd(r,n);var o;r=null;for(l in s)if(!n.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var a=s[l];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(zi.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in n){var c=n[l];if(a=s!=null?s[l]:void 0,n.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(zi.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&ve("scroll",e),i||a===c||(i=[])):(i=i||[]).push(l,c))}r&&(i=i||[]).push("style",r);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};Vv=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ci(e,t){if(!ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function tt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Jb(e,t,r){var n=t.pendingProps;switch(Qu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(t),null;case 1:return ht(t.type)&&Da(),tt(t),null;case 3:return n=t.stateNode,Ks(),_e(ft),_e(st),tp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ft!==null&&(Fd(Ft),Ft=null))),Ld(e,t),tt(t),null;case 5:ep(t);var s=Sn(Ji.current);if(r=t.type,e!==null&&t.stateNode!=null)Uv(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(k(166));return tt(t),null}if(e=Sn(lr.current),Zo(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[or]=t,n[Yi]=i,e=(t.mode&1)!==0,r){case"dialog":ve("cancel",n),ve("close",n);break;case"iframe":case"object":case"embed":ve("load",n);break;case"video":case"audio":for(s=0;s<Di.length;s++)ve(Di[s],n);break;case"source":ve("error",n);break;case"img":case"image":case"link":ve("error",n),ve("load",n);break;case"details":ve("toggle",n);break;case"input":th(n,i),ve("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ve("invalid",n);break;case"textarea":nh(n,i),ve("invalid",n)}sd(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&Jo(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Jo(n.textContent,a,e),s=["children",""+a]):zi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ve("scroll",n)}switch(r){case"input":Ho(n),rh(n,i,!0);break;case"textarea":Ho(n),sh(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Pa)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[or]=t,e[Yi]=n,Bv(e,t,!1,!1),t.stateNode=e;e:{switch(o=id(r,n),r){case"dialog":ve("cancel",e),ve("close",e),s=n;break;case"iframe":case"object":case"embed":ve("load",e),s=n;break;case"video":case"audio":for(s=0;s<Di.length;s++)ve(Di[s],e);s=n;break;case"source":ve("error",e),s=n;break;case"img":case"image":case"link":ve("error",e),ve("load",e),s=n;break;case"details":ve("toggle",e),s=n;break;case"input":th(e,n),s=Zl(e,n),ve("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=be({},n,{value:void 0}),ve("invalid",e);break;case"textarea":nh(e,n),s=rd(e,n),ve("invalid",e);break;default:s=n}sd(r,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?wg(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&_g(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Bi(e,c):typeof c=="number"&&Bi(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zi.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ve("scroll",e):c!=null&&Lu(e,i,c,o))}switch(r){case"input":Ho(e),rh(e,n,!1);break;case"textarea":Ho(e),sh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+cn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ls(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ls(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Pa)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return tt(t),null;case 6:if(e&&t.stateNode!=null)Vv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(k(166));if(r=Sn(Ji.current),Sn(lr.current),Zo(t)){if(n=t.stateNode,r=t.memoizedProps,n[or]=t,(i=n.nodeValue!==r)&&(e=wt,e!==null))switch(e.tag){case 3:Jo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jo(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[or]=t,t.stateNode=n}return tt(t),null;case 13:if(_e(Se),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ye&&yt!==null&&t.mode&1&&!(t.flags&128))av(),Vs(),t.flags|=98560,i=!1;else if(i=Zo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(k(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(k(317));i[or]=t}else Vs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;tt(t),i=!1}else Ft!==null&&(Fd(Ft),Ft=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Se.current&1?$e===0&&($e=3):fp())),t.updateQueue!==null&&(t.flags|=4),tt(t),null);case 4:return Ks(),Ld(e,t),e===null&&qi(t.stateNode.containerInfo),tt(t),null;case 10:return Yu(t.type._context),tt(t),null;case 17:return ht(t.type)&&Da(),tt(t),null;case 19:if(_e(Se),i=t.memoizedState,i===null)return tt(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Ci(i,!1);else{if($e!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ja(e),o!==null){for(t.flags|=128,Ci(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return me(Se,Se.current&1|2),t.child}e=e.sibling}i.tail!==null&&De()>Ws&&(t.flags|=128,n=!0,Ci(i,!1),t.lanes=4194304)}else{if(!n)if(e=ja(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ci(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ye)return tt(t),null}else 2*De()-i.renderingStartTime>Ws&&r!==1073741824&&(t.flags|=128,n=!0,Ci(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=De(),t.sibling=null,r=Se.current,me(Se,n?r&1|2:r&1),t):(tt(t),null);case 22:case 23:return pp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?_t&1073741824&&(tt(t),t.subtreeFlags&6&&(t.flags|=8192)):tt(t),null;case 24:return null;case 25:return null}throw Error(k(156,t.tag))}function Zb(e,t){switch(Qu(t),t.tag){case 1:return ht(t.type)&&Da(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ks(),_e(ft),_e(st),tp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ep(t),null;case 13:if(_e(Se),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(k(340));Vs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _e(Se),null;case 4:return Ks(),null;case 10:return Yu(t.type._context),null;case 22:case 23:return pp(),null;case 24:return null;default:return null}}var ra=!1,rt=!1,eC=typeof WeakSet=="function"?WeakSet:Set,I=null;function Es(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ee(e,t,n)}else r.current=null}function Id(e,t,r){try{r()}catch(n){Ee(e,t,n)}}var Wh=!1;function tC(e,t){if(md=Ta,e=qg(),Hu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=e,p=null;t:for(;;){for(var f;d!==r||s!==0&&d.nodeType!==3||(a=o+s),d!==i||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===e)break t;if(p===r&&++l===s&&(a=o),p===i&&++u===n&&(c=o),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(gd={focusedElem:e,selectionRange:r},Ta=!1,I=t;I!==null;)if(t=I,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,I=e;else for(;I!==null;){t=I;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,b=y.memoizedState,h=t.stateNode,g=h.getSnapshotBeforeUpdate(t.elementType===t.type?w:At(t.type,w),b);h.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(k(163))}}catch(_){Ee(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,I=e;break}I=t.return}return y=Wh,Wh=!1,y}function ji(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Id(t,r,i)}s=s.next}while(s!==n)}}function Tc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Md(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Hv(e){var t=e.alternate;t!==null&&(e.alternate=null,Hv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[or],delete t[Yi],delete t[yd],delete t[jb],delete t[$b])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Kv(e){return e.tag===5||e.tag===3||e.tag===4}function qh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Kv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Od(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Pa));else if(n!==4&&(e=e.child,e!==null))for(Od(e,t,r),e=e.sibling;e!==null;)Od(e,t,r),e=e.sibling}function Nd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Nd(e,t,r),e=e.sibling;e!==null;)Nd(e,t,r),e=e.sibling}var Ve=null,$t=!1;function Ur(e,t,r){for(r=r.child;r!==null;)Qv(e,t,r),r=r.sibling}function Qv(e,t,r){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount(_c,r)}catch{}switch(r.tag){case 5:rt||Es(r,t);case 6:var n=Ve,s=$t;Ve=null,Ur(e,t,r),Ve=n,$t=s,Ve!==null&&($t?(e=Ve,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ve.removeChild(r.stateNode));break;case 18:Ve!==null&&($t?(e=Ve,r=r.stateNode,e.nodeType===8?Tl(e.parentNode,r):e.nodeType===1&&Tl(e,r),Ki(e)):Tl(Ve,r.stateNode));break;case 4:n=Ve,s=$t,Ve=r.stateNode.containerInfo,$t=!0,Ur(e,t,r),Ve=n,$t=s;break;case 0:case 11:case 14:case 15:if(!rt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Id(r,t,o),s=s.next}while(s!==n)}Ur(e,t,r);break;case 1:if(!rt&&(Es(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Ee(r,t,a)}Ur(e,t,r);break;case 21:Ur(e,t,r);break;case 22:r.mode&1?(rt=(n=rt)||r.memoizedState!==null,Ur(e,t,r),rt=n):Ur(e,t,r);break;default:Ur(e,t,r)}}function Gh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new eC),t.forEach(function(n){var s=dC.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Nt(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ve=a.stateNode,$t=!1;break e;case 3:Ve=a.stateNode.containerInfo,$t=!0;break e;case 4:Ve=a.stateNode.containerInfo,$t=!0;break e}a=a.return}if(Ve===null)throw Error(k(160));Qv(i,o,s),Ve=null,$t=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Ee(s,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Wv(t,e),t=t.sibling}function Wv(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nt(t,e),rr(e),n&4){try{ji(3,e,e.return),Tc(3,e)}catch(w){Ee(e,e.return,w)}try{ji(5,e,e.return)}catch(w){Ee(e,e.return,w)}}break;case 1:Nt(t,e),rr(e),n&512&&r!==null&&Es(r,r.return);break;case 5:if(Nt(t,e),rr(e),n&512&&r!==null&&Es(r,r.return),e.flags&32){var s=e.stateNode;try{Bi(s,"")}catch(w){Ee(e,e.return,w)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&mg(s,i),id(a,o);var l=id(a,i);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?wg(s,d):u==="dangerouslySetInnerHTML"?_g(s,d):u==="children"?Bi(s,d):Lu(s,u,d,l)}switch(a){case"input":ed(s,i);break;case"textarea":gg(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ls(s,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ls(s,!!i.multiple,i.defaultValue,!0):Ls(s,!!i.multiple,i.multiple?[]:"",!1))}s[Yi]=i}catch(w){Ee(e,e.return,w)}}break;case 6:if(Nt(t,e),rr(e),n&4){if(e.stateNode===null)throw Error(k(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(w){Ee(e,e.return,w)}}break;case 3:if(Nt(t,e),rr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ki(t.containerInfo)}catch(w){Ee(e,e.return,w)}break;case 4:Nt(t,e),rr(e);break;case 13:Nt(t,e),rr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(dp=De())),n&4&&Gh(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(rt=(l=rt)||u,Nt(t,e),rt=l):Nt(t,e),rr(e),n&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(I=e,u=e.child;u!==null;){for(d=I=u;I!==null;){switch(p=I,f=p.child,p.tag){case 0:case 11:case 14:case 15:ji(4,p,p.return);break;case 1:Es(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(w){Ee(n,r,w)}}break;case 5:Es(p,p.return);break;case 22:if(p.memoizedState!==null){Xh(d);continue}}f!==null?(f.return=p,I=f):Xh(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=yg("display",o))}catch(w){Ee(e,e.return,w)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(w){Ee(e,e.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Nt(t,e),rr(e),n&4&&Gh(e);break;case 21:break;default:Nt(t,e),rr(e)}}function rr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Kv(r)){var n=r;break e}r=r.return}throw Error(k(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Bi(s,""),n.flags&=-33);var i=qh(e);Nd(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=qh(e);Od(e,a,o);break;default:throw Error(k(161))}}catch(c){Ee(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rC(e,t,r){I=e,qv(e)}function qv(e,t,r){for(var n=(e.mode&1)!==0;I!==null;){var s=I,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||ra;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||rt;a=ra;var l=rt;if(ra=o,(rt=c)&&!l)for(I=s;I!==null;)o=I,c=o.child,o.tag===22&&o.memoizedState!==null?Jh(s):c!==null?(c.return=o,I=c):Jh(s);for(;i!==null;)I=i,qv(i),i=i.sibling;I=s,ra=a,rt=l}Yh(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,I=i):Yh(e)}}function Yh(e){for(;I!==null;){var t=I;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:rt||Tc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!rt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:At(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Oh(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Oh(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ki(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(k(163))}rt||t.flags&512&&Md(t)}catch(p){Ee(t,t.return,p)}}if(t===e){I=null;break}if(r=t.sibling,r!==null){r.return=t.return,I=r;break}I=t.return}}function Xh(e){for(;I!==null;){var t=I;if(t===e){I=null;break}var r=t.sibling;if(r!==null){r.return=t.return,I=r;break}I=t.return}}function Jh(e){for(;I!==null;){var t=I;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Tc(4,t)}catch(c){Ee(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Ee(t,s,c)}}var i=t.return;try{Md(t)}catch(c){Ee(t,i,c)}break;case 5:var o=t.return;try{Md(t)}catch(c){Ee(t,o,c)}}}catch(c){Ee(t,t.return,c)}if(t===e){I=null;break}var a=t.sibling;if(a!==null){a.return=t.return,I=a;break}I=t.return}}var nC=Math.ceil,za=Mr.ReactCurrentDispatcher,cp=Mr.ReactCurrentOwner,Dt=Mr.ReactCurrentBatchConfig,se=0,ze=null,Oe=null,Ke=0,_t=0,xs=un(0),$e=0,ro=null,jn=0,Ec=0,lp=0,$i=null,ut=null,dp=0,Ws=1/0,Cr=null,Ba=!1,Ad=null,sn=null,na=!1,Yr=null,Ua=0,Fi=0,jd=null,_a=-1,ya=0;function at(){return se&6?De():_a!==-1?_a:_a=De()}function on(e){return e.mode&1?se&2&&Ke!==0?Ke&-Ke:zb.transition!==null?(ya===0&&(ya=Ig()),ya):(e=le,e!==0||(e=window.event,e=e===void 0?16:Fg(e.type)),e):1}function Ut(e,t,r,n){if(50<Fi)throw Fi=0,jd=null,Error(k(185));fo(e,r,n),(!(se&2)||e!==ze)&&(e===ze&&(!(se&2)&&(Ec|=r),$e===4&&Qr(e,Ke)),mt(e,n),r===1&&se===0&&!(t.mode&1)&&(Ws=De()+500,bc&&pn()))}function mt(e,t){var r=e.callbackNode;z1(e,t);var n=ka(e,e===ze?Ke:0);if(n===0)r!==null&&ah(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&ah(r),t===1)e.tag===0?Fb(Zh.bind(null,e)):sv(Zh.bind(null,e)),Nb(function(){!(se&6)&&pn()}),r=null;else{switch(Mg(n)){case 1:r=Au;break;case 4:r=Dg;break;case 16:r=Ca;break;case 536870912:r=Lg;break;default:r=Ca}r=r_(r,Gv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Gv(e,t){if(_a=-1,ya=0,se&6)throw Error(k(327));var r=e.callbackNode;if(As()&&e.callbackNode!==r)return null;var n=ka(e,e===ze?Ke:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Va(e,n);else{t=n;var s=se;se|=2;var i=Xv();(ze!==e||Ke!==t)&&(Cr=null,Ws=De()+500,Dn(e,t));do try{oC();break}catch(a){Yv(e,a)}while(!0);Gu(),za.current=i,se=s,Oe!==null?t=0:(ze=null,Ke=0,t=$e)}if(t!==0){if(t===2&&(s=dd(e),s!==0&&(n=s,t=$d(e,s))),t===1)throw r=ro,Dn(e,0),Qr(e,n),mt(e,De()),r;if(t===6)Qr(e,n);else{if(s=e.current.alternate,!(n&30)&&!sC(s)&&(t=Va(e,n),t===2&&(i=dd(e),i!==0&&(n=i,t=$d(e,i))),t===1))throw r=ro,Dn(e,0),Qr(e,n),mt(e,De()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(k(345));case 2:vn(e,ut,Cr);break;case 3:if(Qr(e,n),(n&130023424)===n&&(t=dp+500-De(),10<t)){if(ka(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){at(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=_d(vn.bind(null,e,ut,Cr),t);break}vn(e,ut,Cr);break;case 4:if(Qr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Bt(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=De()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*nC(n/1960))-n,10<n){e.timeoutHandle=_d(vn.bind(null,e,ut,Cr),n);break}vn(e,ut,Cr);break;case 5:vn(e,ut,Cr);break;default:throw Error(k(329))}}}return mt(e,De()),e.callbackNode===r?Gv.bind(null,e):null}function $d(e,t){var r=$i;return e.current.memoizedState.isDehydrated&&(Dn(e,t).flags|=256),e=Va(e,t),e!==2&&(t=ut,ut=r,t!==null&&Fd(t)),e}function Fd(e){ut===null?ut=e:ut.push.apply(ut,e)}function sC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Vt(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qr(e,t){for(t&=~lp,t&=~Ec,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Bt(t),n=1<<r;e[r]=-1,t&=~n}}function Zh(e){if(se&6)throw Error(k(327));As();var t=ka(e,0);if(!(t&1))return mt(e,De()),null;var r=Va(e,t);if(e.tag!==0&&r===2){var n=dd(e);n!==0&&(t=n,r=$d(e,n))}if(r===1)throw r=ro,Dn(e,0),Qr(e,t),mt(e,De()),r;if(r===6)throw Error(k(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vn(e,ut,Cr),mt(e,De()),null}function up(e,t){var r=se;se|=1;try{return e(t)}finally{se=r,se===0&&(Ws=De()+500,bc&&pn())}}function $n(e){Yr!==null&&Yr.tag===0&&!(se&6)&&As();var t=se;se|=1;var r=Dt.transition,n=le;try{if(Dt.transition=null,le=1,e)return e()}finally{le=n,Dt.transition=r,se=t,!(se&6)&&pn()}}function pp(){_t=xs.current,_e(xs)}function Dn(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Ob(r)),Oe!==null)for(r=Oe.return;r!==null;){var n=r;switch(Qu(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Da();break;case 3:Ks(),_e(ft),_e(st),tp();break;case 5:ep(n);break;case 4:Ks();break;case 13:_e(Se);break;case 19:_e(Se);break;case 10:Yu(n.type._context);break;case 22:case 23:pp()}r=r.return}if(ze=e,Oe=e=an(e.current,null),Ke=_t=t,$e=0,ro=null,lp=Ec=jn=0,ut=$i=null,wn!==null){for(t=0;t<wn.length;t++)if(r=wn[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}wn=null}return e}function Yv(e,t){do{var r=Oe;try{if(Gu(),ma.current=Fa,$a){for(var n=Re.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}$a=!1}if(An=0,Fe=je=Re=null,Ai=!1,Zi=0,cp.current=null,r===null||r.return===null){$e=1,ro=t,Oe=null;break}e:{var i=e,o=r.return,a=r,c=t;if(t=Ke,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=zh(o);if(f!==null){f.flags&=-257,Bh(f,o,a,i,t),f.mode&1&&Fh(i,l,t),t=f,c=l;var y=t.updateQueue;if(y===null){var w=new Set;w.add(c),t.updateQueue=w}else y.add(c);break e}else{if(!(t&1)){Fh(i,l,t),fp();break e}c=Error(k(426))}}else if(ye&&a.mode&1){var b=zh(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Bh(b,o,a,i,t),Wu(Qs(c,a));break e}}i=c=Qs(c,a),$e!==4&&($e=2),$i===null?$i=[i]:$i.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=Mv(i,c,t);Mh(i,h);break e;case 1:a=c;var g=i.type,m=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(sn===null||!sn.has(m)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Ov(i,a,t);Mh(i,_);break e}}i=i.return}while(i!==null)}Zv(r)}catch(S){t=S,Oe===r&&r!==null&&(Oe=r=r.return);continue}break}while(!0)}function Xv(){var e=za.current;return za.current=Fa,e===null?Fa:e}function fp(){($e===0||$e===3||$e===2)&&($e=4),ze===null||!(jn&268435455)&&!(Ec&268435455)||Qr(ze,Ke)}function Va(e,t){var r=se;se|=2;var n=Xv();(ze!==e||Ke!==t)&&(Cr=null,Dn(e,t));do try{iC();break}catch(s){Yv(e,s)}while(!0);if(Gu(),se=r,za.current=n,Oe!==null)throw Error(k(261));return ze=null,Ke=0,$e}function iC(){for(;Oe!==null;)Jv(Oe)}function oC(){for(;Oe!==null&&!L1();)Jv(Oe)}function Jv(e){var t=t_(e.alternate,e,_t);e.memoizedProps=e.pendingProps,t===null?Zv(e):Oe=t,cp.current=null}function Zv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Zb(r,t),r!==null){r.flags&=32767,Oe=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$e=6,Oe=null;return}}else if(r=Jb(r,t,_t),r!==null){Oe=r;return}if(t=t.sibling,t!==null){Oe=t;return}Oe=t=e}while(t!==null);$e===0&&($e=5)}function vn(e,t,r){var n=le,s=Dt.transition;try{Dt.transition=null,le=1,aC(e,t,r,n)}finally{Dt.transition=s,le=n}return null}function aC(e,t,r,n){do As();while(Yr!==null);if(se&6)throw Error(k(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(k(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(B1(e,i),e===ze&&(Oe=ze=null,Ke=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||na||(na=!0,r_(Ca,function(){return As(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Dt.transition,Dt.transition=null;var o=le;le=1;var a=se;se|=4,cp.current=null,tC(e,r),Wv(r,e),Eb(gd),Ta=!!md,gd=md=null,e.current=r,rC(r),I1(),se=a,le=o,Dt.transition=i}else e.current=r;if(na&&(na=!1,Yr=e,Ua=s),i=e.pendingLanes,i===0&&(sn=null),N1(r.stateNode),mt(e,De()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ba)throw Ba=!1,e=Ad,Ad=null,e;return Ua&1&&e.tag!==0&&As(),i=e.pendingLanes,i&1?e===jd?Fi++:(Fi=0,jd=e):Fi=0,pn(),null}function As(){if(Yr!==null){var e=Mg(Ua),t=Dt.transition,r=le;try{if(Dt.transition=null,le=16>e?16:e,Yr===null)var n=!1;else{if(e=Yr,Yr=null,Ua=0,se&6)throw Error(k(331));var s=se;for(se|=4,I=e.current;I!==null;){var i=I,o=i.child;if(I.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(I=l;I!==null;){var u=I;switch(u.tag){case 0:case 11:case 15:ji(8,u,i)}var d=u.child;if(d!==null)d.return=u,I=d;else for(;I!==null;){u=I;var p=u.sibling,f=u.return;if(Hv(u),u===l){I=null;break}if(p!==null){p.return=f,I=p;break}I=f}}}var y=i.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var b=w.sibling;w.sibling=null,w=b}while(w!==null)}}I=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,I=o;else e:for(;I!==null;){if(i=I,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ji(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,I=h;break e}I=i.return}}var g=e.current;for(I=g;I!==null;){o=I;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,I=m;else e:for(o=g;I!==null;){if(a=I,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Tc(9,a)}}catch(S){Ee(a,a.return,S)}if(a===o){I=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,I=_;break e}I=a.return}}if(se=s,pn(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot(_c,e)}catch{}n=!0}return n}finally{le=r,Dt.transition=t}}return!1}function em(e,t,r){t=Qs(r,t),t=Mv(e,t,1),e=nn(e,t,1),t=at(),e!==null&&(fo(e,1,t),mt(e,t))}function Ee(e,t,r){if(e.tag===3)em(e,e,r);else for(;t!==null;){if(t.tag===3){em(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(sn===null||!sn.has(n))){e=Qs(r,e),e=Ov(t,e,1),t=nn(t,e,1),e=at(),t!==null&&(fo(t,1,e),mt(t,e));break}}t=t.return}}function cC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=at(),e.pingedLanes|=e.suspendedLanes&r,ze===e&&(Ke&r)===r&&($e===4||$e===3&&(Ke&130023424)===Ke&&500>De()-dp?Dn(e,0):lp|=r),mt(e,t)}function e_(e,t){t===0&&(e.mode&1?(t=Wo,Wo<<=1,!(Wo&130023424)&&(Wo=4194304)):t=1);var r=at();e=Lr(e,t),e!==null&&(fo(e,t,r),mt(e,r))}function lC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),e_(e,r)}function dC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(k(314))}n!==null&&n.delete(t),e_(e,r)}var t_;t_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ft.current)pt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return pt=!1,Xb(e,t,r);pt=!!(e.flags&131072)}else pt=!1,ye&&t.flags&1048576&&iv(t,Ma,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;va(e,t),e=t.pendingProps;var s=Us(t,st.current);Ns(t,r),s=np(null,t,n,e,s,r);var i=sp();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ht(n)?(i=!0,La(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ju(t),s.updater=kc,t.stateNode=s,s._reactInternals=t,kd(t,n,e,r),t=xd(null,t,n,!0,i,r)):(t.tag=0,ye&&i&&Ku(t),ot(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(va(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=pC(n),e=At(n,e),s){case 0:t=Ed(null,t,n,e,r);break e;case 1:t=Hh(null,t,n,e,r);break e;case 11:t=Uh(null,t,n,e,r);break e;case 14:t=Vh(null,t,n,At(n.type,e),r);break e}throw Error(k(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:At(n,s),Ed(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:At(n,s),Hh(e,t,n,s,r);case 3:e:{if($v(t),e===null)throw Error(k(387));n=t.pendingProps,i=t.memoizedState,s=i.element,uv(e,t),Aa(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Qs(Error(k(423)),t),t=Kh(e,t,n,r,s);break e}else if(n!==s){s=Qs(Error(k(424)),t),t=Kh(e,t,n,r,s);break e}else for(yt=rn(t.stateNode.containerInfo.firstChild),wt=t,ye=!0,Ft=null,r=lv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Vs(),n===s){t=Ir(e,t,r);break e}ot(e,t,n,r)}t=t.child}return t;case 5:return pv(t),e===null&&Rd(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,vd(n,s)?o=null:i!==null&&vd(n,i)&&(t.flags|=32),jv(e,t),ot(e,t,o,r),t.child;case 6:return e===null&&Rd(t),null;case 13:return Fv(e,t,r);case 4:return Zu(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Hs(t,null,n,r):ot(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:At(n,s),Uh(e,t,n,s,r);case 7:return ot(e,t,t.pendingProps,r),t.child;case 8:return ot(e,t,t.pendingProps.children,r),t.child;case 12:return ot(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,me(Oa,n._currentValue),n._currentValue=o,i!==null)if(Vt(i.value,o)){if(i.children===s.children&&!ft.current){t=Ir(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=xr(-1,r&-r),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),bd(i.return,r,t),a.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(k(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),bd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ot(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ns(t,r),s=Lt(s),n=n(s),t.flags|=1,ot(e,t,n,r),t.child;case 14:return n=t.type,s=At(n,t.pendingProps),s=At(n.type,s),Vh(e,t,n,s,r);case 15:return Nv(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:At(n,s),va(e,t),t.tag=1,ht(n)?(e=!0,La(t)):e=!1,Ns(t,r),Iv(t,n,s),kd(t,n,s,r),xd(null,t,n,!0,e,r);case 19:return zv(e,t,r);case 22:return Av(e,t,r)}throw Error(k(156,t.tag))};function r_(e,t){return Pg(e,t)}function uC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xt(e,t,r,n){return new uC(e,t,r,n)}function hp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pC(e){if(typeof e=="function")return hp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Mu)return 11;if(e===Ou)return 14}return 2}function an(e,t){var r=e.alternate;return r===null?(r=xt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function wa(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")hp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case _s:return Ln(r.children,s,i,t);case Iu:o=8,s|=8;break;case Gl:return e=xt(12,r,t,s|2),e.elementType=Gl,e.lanes=i,e;case Yl:return e=xt(13,r,t,s),e.elementType=Yl,e.lanes=i,e;case Xl:return e=xt(19,r,t,s),e.elementType=Xl,e.lanes=i,e;case pg:return xc(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case dg:o=10;break e;case ug:o=9;break e;case Mu:o=11;break e;case Ou:o=14;break e;case Vr:o=16,n=null;break e}throw Error(k(130,e==null?e:typeof e,""))}return t=xt(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function Ln(e,t,r,n){return e=xt(7,e,n,t),e.lanes=r,e}function xc(e,t,r,n){return e=xt(22,e,n,t),e.elementType=pg,e.lanes=r,e.stateNode={isHidden:!1},e}function Ol(e,t,r){return e=xt(6,e,null,t),e.lanes=r,e}function Nl(e,t,r){return t=xt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function fC(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ml(0),this.expirationTimes=ml(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ml(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function mp(e,t,r,n,s,i,o,a,c){return e=new fC(e,t,r,a,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ju(i),e}function hC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function n_(e){if(!e)return ln;e=e._reactInternals;e:{if(Vn(e)!==e||e.tag!==1)throw Error(k(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(k(171))}if(e.tag===1){var r=e.type;if(ht(r))return nv(e,r,t)}return t}function s_(e,t,r,n,s,i,o,a,c){return e=mp(r,n,!0,e,s,i,o,a,c),e.context=n_(null),r=e.current,n=at(),s=on(r),i=xr(n,s),i.callback=t??null,nn(r,i,s),e.current.lanes=s,fo(e,s,n),mt(e,n),e}function Pc(e,t,r,n){var s=t.current,i=at(),o=on(s);return r=n_(r),t.context===null?t.context=r:t.pendingContext=r,t=xr(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=nn(s,t,o),e!==null&&(Ut(e,s,o,i),ha(e,s,o)),o}function Ha(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function gp(e,t){tm(e,t),(e=e.alternate)&&tm(e,t)}function mC(){return null}var i_=typeof reportError=="function"?reportError:function(e){console.error(e)};function vp(e){this._internalRoot=e}Dc.prototype.render=vp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(k(409));Pc(e,t,null,null)};Dc.prototype.unmount=vp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$n(function(){Pc(null,e,null,null)}),t[Dr]=null}};function Dc(e){this._internalRoot=e}Dc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ag();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Kr.length&&t!==0&&t<Kr[r].priority;r++);Kr.splice(r,0,e),r===0&&$g(e)}};function _p(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rm(){}function gC(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var l=Ha(o);i.call(l)}}var o=s_(t,n,e,0,null,!1,!1,"",rm);return e._reactRootContainer=o,e[Dr]=o.current,qi(e.nodeType===8?e.parentNode:e),$n(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var l=Ha(c);a.call(l)}}var c=mp(e,0,!1,null,null,!1,!1,"",rm);return e._reactRootContainer=c,e[Dr]=c.current,qi(e.nodeType===8?e.parentNode:e),$n(function(){Pc(t,c,r,n)}),c}function Ic(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Ha(o);a.call(c)}}Pc(t,o,e,s)}else o=gC(r,t,e,s,n);return Ha(o)}Og=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Pi(t.pendingLanes);r!==0&&(ju(t,r|1),mt(t,De()),!(se&6)&&(Ws=De()+500,pn()))}break;case 13:$n(function(){var n=Lr(e,1);if(n!==null){var s=at();Ut(n,e,1,s)}}),gp(e,1)}};$u=function(e){if(e.tag===13){var t=Lr(e,134217728);if(t!==null){var r=at();Ut(t,e,134217728,r)}gp(e,134217728)}};Ng=function(e){if(e.tag===13){var t=on(e),r=Lr(e,t);if(r!==null){var n=at();Ut(r,e,t,n)}gp(e,t)}};Ag=function(){return le};jg=function(e,t){var r=le;try{return le=e,t()}finally{le=r}};ad=function(e,t,r){switch(t){case"input":if(ed(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Rc(n);if(!s)throw Error(k(90));hg(n),ed(n,s)}}}break;case"textarea":gg(e,r);break;case"select":t=r.value,t!=null&&Ls(e,!!r.multiple,t,!1)}};bg=up;Cg=$n;var vC={usingClientEntryPoint:!1,Events:[mo,Rs,Rc,Sg,Rg,up]},ki={findFiberByHostInstance:yn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_C={bundleType:ki.bundleType,version:ki.version,rendererPackageName:ki.rendererPackageName,rendererConfig:ki.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Eg(e),e===null?null:e.stateNode},findFiberByHostInstance:ki.findFiberByHostInstance||mC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sa.isDisabled&&sa.supportsFiber)try{_c=sa.inject(_C),cr=sa}catch{}}Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vC;Rt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_p(t))throw Error(k(200));return hC(e,t,null,r)};Rt.createRoot=function(e,t){if(!_p(e))throw Error(k(299));var r=!1,n="",s=i_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=mp(e,1,!1,null,null,r,!1,n,s),e[Dr]=t.current,qi(e.nodeType===8?e.parentNode:e),new vp(t)};Rt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(k(188)):(e=Object.keys(e).join(","),Error(k(268,e)));return e=Eg(t),e=e===null?null:e.stateNode,e};Rt.flushSync=function(e){return $n(e)};Rt.hydrate=function(e,t,r){if(!Lc(t))throw Error(k(200));return Ic(null,e,t,!0,r)};Rt.hydrateRoot=function(e,t,r){if(!_p(e))throw Error(k(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=i_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=s_(t,null,e,1,r??null,s,!1,i,o),e[Dr]=t.current,qi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Dc(t)};Rt.render=function(e,t,r){if(!Lc(t))throw Error(k(200));return Ic(null,e,t,!1,r)};Rt.unmountComponentAtNode=function(e){if(!Lc(e))throw Error(k(40));return e._reactRootContainer?($n(function(){Ic(null,null,e,!1,function(){e._reactRootContainer=null,e[Dr]=null})}),!0):!1};Rt.unstable_batchedUpdates=up;Rt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Lc(r))throw Error(k(200));if(e==null||e._reactInternals===void 0)throw Error(k(38));return Ic(e,t,r,!1,n)};Rt.version="18.3.1-next-f1338f8080-20240426";function o_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o_)}catch(e){console.error(e)}}o_(),og.exports=Rt;var yC=og.exports,nm=yC;Wl.createRoot=nm.createRoot,Wl.hydrateRoot=nm.hydrateRoot;Wl.createRoot(document.getElementById("root")).render(D.jsx(O_.StrictMode,{children:D.jsx(h1,{})}));
