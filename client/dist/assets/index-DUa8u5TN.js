var m_=Object.defineProperty;var $p=e=>{throw TypeError(e)};var g_=(e,t,r)=>t in e?m_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var g=(e,t,r)=>g_(e,typeof t!="symbol"?t+"":t,r),Fp=(e,t,r)=>t.has(e)||$p("Cannot "+r);var Q=(e,t,r)=>(Fp(e,t,"read from private field"),r?r.call(e):t.get(e)),Fe=(e,t,r)=>t.has(e)?$p("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),me=(e,t,r,n)=>(Fp(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function v_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var nm={exports:{}},Va={},sm={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=Symbol.for("react.element"),__=Symbol.for("react.portal"),y_=Symbol.for("react.fragment"),w_=Symbol.for("react.strict_mode"),S_=Symbol.for("react.profiler"),R_=Symbol.for("react.provider"),b_=Symbol.for("react.context"),C_=Symbol.for("react.forward_ref"),k_=Symbol.for("react.suspense"),T_=Symbol.for("react.memo"),E_=Symbol.for("react.lazy"),zp=Symbol.iterator;function D_(e){return e===null||typeof e!="object"?null:(e=zp&&e[zp]||e["@@iterator"],typeof e=="function"?e:null)}var im={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},om=Object.assign,am={};function Qs(e,t,r){this.props=e,this.context=t,this.refs=am,this.updater=r||im}Qs.prototype.isReactComponent={};Qs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Qs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function cm(){}cm.prototype=Qs.prototype;function Fd(e,t,r){this.props=e,this.context=t,this.refs=am,this.updater=r||im}var zd=Fd.prototype=new cm;zd.constructor=Fd;om(zd,Qs.prototype);zd.isPureReactComponent=!0;var Bp=Array.isArray,lm=Object.prototype.hasOwnProperty,Bd={current:null},dm={key:!0,ref:!0,__self:!0,__source:!0};function um(e,t,r){var n,s={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)lm.call(t,n)&&!dm.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];s.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:so,type:e,key:i,ref:o,props:s,_owner:Bd.current}}function P_(e,t){return{$$typeof:so,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ud(e){return typeof e=="object"&&e!==null&&e.$$typeof===so}function x_(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Up=/\/+/g;function Qc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?x_(""+e.key):t.toString(36)}function sa(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case so:case __:o=!0}}if(o)return o=e,s=s(o),e=n===""?"."+Qc(o,0):n,Bp(s)?(r="",e!=null&&(r=e.replace(Up,"$&/")+"/"),sa(s,t,r,"",function(l){return l})):s!=null&&(Ud(s)&&(s=P_(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Up,"$&/")+"/")+e)),t.push(s)),1;if(o=0,n=n===""?".":n+":",Bp(e))for(var a=0;a<e.length;a++){i=e[a];var c=n+Qc(i,a);o+=sa(i,t,r,c,s)}else if(c=D_(e),typeof c=="function")for(e=c.call(e),a=0;!(i=e.next()).done;)i=i.value,c=n+Qc(i,a++),o+=sa(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Co(e,t,r){if(e==null)return e;var n=[],s=0;return sa(e,n,"","",function(i){return t.call(r,i,s++)}),n}function L_(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ot={current:null},ia={transition:null},I_={ReactCurrentDispatcher:ot,ReactCurrentBatchConfig:ia,ReactCurrentOwner:Bd};function pm(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:Co,forEach:function(e,t,r){Co(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Co(e,function(){t++}),t},toArray:function(e){return Co(e,function(t){return t})||[]},only:function(e){if(!Ud(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};G.Component=Qs;G.Fragment=y_;G.Profiler=S_;G.PureComponent=Fd;G.StrictMode=w_;G.Suspense=k_;G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I_;G.act=pm;G.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=om({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Bd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)lm.call(t,c)&&!dm.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:so,type:e.type,key:s,ref:i,props:n,_owner:o}};G.createContext=function(e){return e={$$typeof:b_,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:R_,_context:e},e.Consumer=e};G.createElement=um;G.createFactory=function(e){var t=um.bind(null,e);return t.type=e,t};G.createRef=function(){return{current:null}};G.forwardRef=function(e){return{$$typeof:C_,render:e}};G.isValidElement=Ud;G.lazy=function(e){return{$$typeof:E_,_payload:{_status:-1,_result:e},_init:L_}};G.memo=function(e,t){return{$$typeof:T_,type:e,compare:t===void 0?null:t}};G.startTransition=function(e){var t=ia.transition;ia.transition={};try{e()}finally{ia.transition=t}};G.unstable_act=pm;G.useCallback=function(e,t){return ot.current.useCallback(e,t)};G.useContext=function(e){return ot.current.useContext(e)};G.useDebugValue=function(){};G.useDeferredValue=function(e){return ot.current.useDeferredValue(e)};G.useEffect=function(e,t){return ot.current.useEffect(e,t)};G.useId=function(){return ot.current.useId()};G.useImperativeHandle=function(e,t,r){return ot.current.useImperativeHandle(e,t,r)};G.useInsertionEffect=function(e,t){return ot.current.useInsertionEffect(e,t)};G.useLayoutEffect=function(e,t){return ot.current.useLayoutEffect(e,t)};G.useMemo=function(e,t){return ot.current.useMemo(e,t)};G.useReducer=function(e,t,r){return ot.current.useReducer(e,t,r)};G.useRef=function(e){return ot.current.useRef(e)};G.useState=function(e){return ot.current.useState(e)};G.useSyncExternalStore=function(e,t,r){return ot.current.useSyncExternalStore(e,t,r)};G.useTransition=function(){return ot.current.useTransition()};G.version="18.3.1";sm.exports=G;var Ft=sm.exports;const M_=v_(Ft);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O_=Ft,N_=Symbol.for("react.element"),A_=Symbol.for("react.fragment"),j_=Object.prototype.hasOwnProperty,$_=O_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F_={key:!0,ref:!0,__self:!0,__source:!0};function fm(e,t,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)j_.call(t,n)&&!F_.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:N_,type:e,key:i,ref:o,props:s,_owner:$_.current}}Va.Fragment=A_;Va.jsx=fm;Va.jsxs=fm;nm.exports=Va;var se=nm.exports;const z_=()=>{const[e,t]=Ft.useState(!1),[r,n]=Ft.useState("Ready to stream"),s=async()=>{try{if(n("Processing..."),window.electronAPI){const o=await window.electronAPI.toggleStream();console.log("Stream toggle result:",o),t(a=>!a),n(e?"Stream stopped":"Stream started")}else await i()}catch(o){console.error("Error toggling stream:",o),n("Error: "+o.message)}},i=async()=>{try{const o=await navigator.mediaDevices.getUserMedia({video:{width:1280,height:720},audio:!0});t(!0),n("Streaming from browser"),console.log("Browser stream started:",o)}catch(o){console.error("Error starting web stream:",o),n("Error accessing camera/microphone")}};return se.jsxs("div",{className:"space-y-4 p-6 bg-gray-800 rounded-lg",children:[se.jsxs("div",{className:"text-center",children:[se.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Stream Controls"}),se.jsx("p",{className:"text-gray-400 text-sm mb-4",children:r})]}),se.jsx("button",{onClick:s,className:`w-full px-6 py-3 rounded-lg font-medium transition-colors ${e?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:e?"⏹️ Stop Streaming":"▶️ Start Streaming"}),se.jsxs("div",{className:"flex space-x-2",children:[se.jsx("div",{className:`w-3 h-3 rounded-full ${e?"bg-green-500":"bg-gray-500"}`}),se.jsx("span",{className:"text-sm text-gray-400",children:e?"Live":"Offline"})]})]})};var Hd={},Nl={exports:{}},Wc,Hp;function B_(){if(Hp)return Wc;Hp=1;var e=1e3,t=e*60,r=t*60,n=r*24,s=n*7,i=n*365.25;Wc=function(u,d){d=d||{};var p=typeof u;if(p==="string"&&u.length>0)return o(u);if(p==="number"&&isFinite(u))return d.long?c(u):a(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function o(u){if(u=String(u),!(u.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(d){var p=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*s;case"days":case"day":case"d":return p*n;case"hours":case"hour":case"hrs":case"hr":case"h":return p*r;case"minutes":case"minute":case"mins":case"min":case"m":return p*t;case"seconds":case"second":case"secs":case"sec":case"s":return p*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function a(u){var d=Math.abs(u);return d>=n?Math.round(u/n)+"d":d>=r?Math.round(u/r)+"h":d>=t?Math.round(u/t)+"m":d>=e?Math.round(u/e)+"s":u+"ms"}function c(u){var d=Math.abs(u);return d>=n?l(u,d,n,"day"):d>=r?l(u,d,r,"hour"):d>=t?l(u,d,t,"minute"):d>=e?l(u,d,e,"second"):u+" ms"}function l(u,d,p,f){var y=d>=p*1.5;return Math.round(u/p)+" "+f+(y?"s":"")}return Wc}function U_(e){r.debug=r,r.default=r,r.coerce=c,r.disable=o,r.enable=s,r.enabled=a,r.humanize=B_(),r.destroy=l,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let d=0;for(let p=0;p<u.length;p++)d=(d<<5)-d+u.charCodeAt(p),d|=0;return r.colors[Math.abs(d)%r.colors.length]}r.selectColor=t;function r(u){let d,p=null,f,y;function w(...b){if(!w.enabled)return;const m=w,v=Number(new Date),h=v-(d||v);m.diff=h,m.prev=d,m.curr=v,d=v,b[0]=r.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let _=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(R,E)=>{if(R==="%%")return"%";_++;const x=r.formatters[E];if(typeof x=="function"){const C=b[_];R=x.call(m,C),b.splice(_,1),_--}return R}),r.formatArgs.call(m,b),(m.log||r.log).apply(m,b)}return w.namespace=u,w.useColors=r.useColors(),w.color=r.selectColor(u),w.extend=n,w.destroy=r.destroy,Object.defineProperty(w,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(f!==r.namespaces&&(f=r.namespaces,y=r.enabled(u)),y),set:b=>{p=b}}),typeof r.init=="function"&&r.init(w),w}function n(u,d){const p=r(this.namespace+(typeof d>"u"?":":d)+u);return p.log=this.log,p}function s(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];const d=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const p of d)p[0]==="-"?r.skips.push(p.slice(1)):r.names.push(p)}function i(u,d){let p=0,f=0,y=-1,w=0;for(;p<u.length;)if(f<d.length&&(d[f]===u[p]||d[f]==="*"))d[f]==="*"?(y=f,w=p,f++):(p++,f++);else if(y!==-1)f=y+1,w++,p=w;else return!1;for(;f<d.length&&d[f]==="*";)f++;return f===d.length}function o(){const u=[...r.names,...r.skips.map(d=>"-"+d)].join(",");return r.enable(""),u}function a(u){for(const d of r.skips)if(i(u,d))return!1;for(const d of r.names)if(i(u,d))return!0;return!1}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var H_=U_;(function(e,t){var r={};t.formatArgs=s,t.save=i,t.load=o,t.useColors=n,t.storage=a(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let d=0,p=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(p=d))}),l.splice(p,0,u)}t.log=console.debug||console.log||(()=>{});function i(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function o(){let l;try{l=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=r.DEBUG),l}function a(){try{return localStorage}catch{}}e.exports=H_(t);const{formatters:c}=e.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Nl,Nl.exports);var Ka=Nl.exports,hm={},$n={},Al={exports:{}};(function(e,t){(function(r,n){var s="2.0.3",i=500,o="user-agent",a="",c="?",l="function",u="undefined",d="object",p="string",f="browser",y="cpu",w="device",b="engine",m="os",v="result",h="name",_="type",S="vendor",R="version",E="architecture",x="major",C="model",B="console",M="mobile",Z="tablet",fe="smarttv",mt="wearable",ei="xr",pr="embedded",fr="inapp",D="brands",F="formFactors",K="fullVersionList",le="platform",ke="platformVersion",hr="bitness",Qe="sec-ch-ua",ti=Qe+"-full-version-list",mr=Qe+"-arch",Hn=Qe+"-"+hr,o_=Qe+"-form-factors",a_=Qe+"-"+M,c_=Qe+"-"+C,yp=Qe+"-"+le,l_=yp+"-version",wp=[D,K,M,C,le,ke,E,F,hr],vo="Amazon",Vn="Apple",Sp="ASUS",Rp="BlackBerry",pn="Google",bp="Huawei",Cp="Lenovo",kp="Honor",_o="LG",Ic="Microsoft",Mc="Motorola",Oc="Nvidia",Tp="OnePlus",Nc="OPPO",ri="Samsung",Ep="Sharp",ni="Sony",Ac="Xiaomi",jc="Zebra",Dp="Chrome",Pp="Chromium",Mr="Chromecast",d_="Edge",si="Firefox",ii="Opera",$c="Facebook",xp="Sogou",Kn="Mobile ",oi=" Browser",Fc="Windows",Lp=typeof r!==u,ct=Lp&&r.navigator?r.navigator:n,Or=ct&&ct.userAgentData?ct.userAgentData:n,u_=function(T,L){var I={},ne=L;if(!wo(L)){ne={};for(var U in L)for(var ue in L[U])ne[ue]=L[U][ue].concat(ne[ue]?ne[ue]:[])}for(var N in T)I[N]=ne[N]&&ne[N].length%2===0?ne[N].concat(T[N]):T[N];return I},yo=function(T){for(var L={},I=0;I<T.length;I++)L[T[I].toUpperCase()]=T[I];return L},zc=function(T,L){if(typeof T===d&&T.length>0){for(var I in T)if(gr(T[I])==gr(L))return!0;return!1}return Qn(T)?gr(L).indexOf(gr(T))!==-1:!1},wo=function(T,L){for(var I in T)return/^(browser|cpu|device|engine|os)$/.test(I)||(L?wo(T[I]):!1)},Qn=function(T){return typeof T===p},Bc=function(T){if(!T)return n;for(var L=[],I=Wn(/\\?\"/g,T).split(","),ne=0;ne<I.length;ne++)if(I[ne].indexOf(";")>-1){var U=ci(I[ne]).split(";v=");L[ne]={brand:U[0],version:U[1]}}else L[ne]=ci(I[ne]);return L},gr=function(T){return Qn(T)?T.toLowerCase():T},Uc=function(T){return Qn(T)?Wn(/[^\d\.]/g,T).split(".")[0]:n},vr=function(T){for(var L in T){var I=T[L];typeof I==d&&I.length==2?this[I[0]]=I[1]:this[I]=n}return this},Wn=function(T,L){return Qn(L)?L.replace(T,a):L},ai=function(T){return Wn(/\\?\"/g,T)},ci=function(T,L){if(Qn(T))return T=Wn(/^\s\s*/,T),typeof L===u?T:T.substring(0,i)},Hc=function(T,L){if(!(!T||!L))for(var I=0,ne,U,ue,N,oe,q;I<L.length&&!oe;){var Ee=L[I],_r=L[I+1];for(ne=U=0;ne<Ee.length&&!oe&&Ee[ne];)if(oe=Ee[ne++].exec(T),oe)for(ue=0;ue<_r.length;ue++)q=oe[++U],N=_r[ue],typeof N===d&&N.length>0?N.length===2?typeof N[1]==l?this[N[0]]=N[1].call(this,q):this[N[0]]=N[1]:N.length===3?typeof N[1]===l&&!(N[1].exec&&N[1].test)?this[N[0]]=q?N[1].call(this,q,N[2]):n:this[N[0]]=q?q.replace(N[1],N[2]):n:N.length===4&&(this[N[0]]=q?N[3].call(this,q.replace(N[1],N[2])):n):this[N]=q||n;I+=2}},Nr=function(T,L){for(var I in L)if(typeof L[I]===d&&L[I].length>0){for(var ne=0;ne<L[I].length;ne++)if(zc(L[I][ne],T))return I===c?n:I}else if(zc(L[I],T))return I===c?n:I;return L.hasOwnProperty("*")?L["*"]:T},Ip={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Mp={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":n},Op={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[R,[h,Kn+"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[R,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,R],[/opios[\/ ]+([\w\.]+)/i],[R,[h,ii+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[R,[h,ii+" GX"]],[/\bopr\/([\w\.]+)/i],[R,[h,ii]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[R,[h,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[R,[h,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:lg |qute)browser)\/([-\w\.]+)/i,/(heytap|ovi|115|surf)browser\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[h,R],[/quark(?:pc)?\/([-\w\.]+)/i],[R,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[R,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[R,[h,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[R,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[R,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[R,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[R,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[R,[h,"Smart "+Cp+oi]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure"+oi],R],[/\bfocus\/([\w\.]+)/i],[R,[h,si+" Focus"]],[/\bopt\/([\w\.]+)/i],[R,[h,ii+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[R,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[R,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[R,[h,ii+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[R,[h,"MIUI"+oi]],[/fxios\/([\w\.-]+)/i],[R,[h,Kn+si]],[/\bqihoobrowser\/?([\w\.]*)/i],[R,[h,"360"]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],R],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+oi],R],[/samsungbrowser\/([\w\.]+)/i],[R,[h,ri+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[R,[h,xp+" Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,xp+" Mobile"],R],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[h,R],[/(lbbrowser|rekonq)/i],[h],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[R,h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,$c],R,[_,fr]],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,R,[_,fr]],[/\bgsa\/([\w\.]+) .*safari\//i],[R,[h,"GSA"],[_,fr]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[R,[h,"TikTok"],[_,fr]],[/\[(linkedin)app\]/i],[h,[_,fr]],[/(chromium)[\/ ]([-\w\.]+)/i],[h,R],[/headlesschrome(?:\/([\w\.]+)| )/i],[R,[h,Dp+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,Dp+" WebView"],R],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[R,[h,"Android"+oi]],[/chrome\/([\w\.]+) mobile/i],[R,[h,Kn+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,R],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[R,[h,Kn+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[h,Kn+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[R,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[R,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[h,R],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[h,Kn+si],R],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],R],[/(wolvic|librewolf)\/([\w\.]+)/i],[h,R],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[R,[h,si+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[h,[R,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[R,/[^\d\.]+./,a]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[E,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[E,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[E,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[E,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[E,"arm"]],[/((ppc|powerpc)(64)?)( mac|;|\))/i],[[E,/ower/,a,gr]],[/ sun4\w[;\)]/i],[[E,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i],[[E,gr]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[C,[S,ri],[_,Z]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[C,[S,ri],[_,M]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[C,[S,Vn],[_,M]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[C,[S,Vn],[_,Z]],[/(macintosh);/i],[C,[S,Vn]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[C,[S,Ep],[_,M]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[C,[S,kp],[_,Z]],[/honor([-\w ]+)[;\)]/i],[C,[S,kp],[_,M]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[C,[S,bp],[_,Z]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[C,[S,bp],[_,M]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[C,/_/g," "],[S,Ac],[_,Z]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[C,/_/g," "],[S,Ac],[_,M]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[C,[S,Nc],[_,M]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[C,[S,Nr,{OnePlus:["304","403","203"],"*":Nc}],[_,Z]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[C,[S,"BLU"],[_,M]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[C,[S,"Vivo"],[_,M]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[C,[S,"Realme"],[_,M]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto(?! 360)[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[C,[S,Mc],[_,M]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[C,[S,Mc],[_,Z]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[C,[S,_o],[_,Z]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch))(\w+)/i,/\blg-?([\d\w]+) bui/i],[C,[S,_o],[_,M]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[C,[S,Cp],[_,Z]],[/(nokia) (t[12][01])/i],[S,C,[_,Z]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*))/i],[[C,/_/g," "],[_,M],[S,"Nokia"]],[/(pixel (c|tablet))\b/i],[C,[S,pn],[_,Z]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[C,[S,pn],[_,M]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[C,[S,ni],[_,M]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[C,"Xperia Tablet"],[S,ni],[_,Z]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[C,[S,Tp],[_,M]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[C,[S,vo],[_,Z]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[C,/(.+)/g,"Fire Phone $1"],[S,vo],[_,M]],[/(playbook);[-\w\),; ]+(rim)/i],[C,S,[_,Z]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[C,[S,Rp],[_,M]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[C,[S,Sp],[_,Z]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[C,[S,Sp],[_,M]],[/(nexus 9)/i],[C,[S,"HTC"],[_,Z]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[S,[C,/_/g," "],[_,M]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[C,[S,"TCL"],[_,Z]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[C,[S,"TCL"],[_,M]],[/(itel) ((\w+))/i],[[S,gr],C,[_,Nr,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[C,[S,"Acer"],[_,Z]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[C,[S,"Meizu"],[_,M]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[C,[S,"Ulefone"],[_,M]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[C,[S,"Energizer"],[_,M]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[C,[S,"Cat"],[_,M]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[C,[S,"Smartfren"],[_,M]],[/droid.+; (a(?:015|06[35]|142p?))/i],[C,[S,"Nothing"],[_,M]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[C,[S,"Archos"],[_,Z]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[C,[S,"Archos"],[_,M]],[/(imo) (tab \w+)/i,/(infinix) (x1101b?)/i],[S,C,[_,Z]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|tcl)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i,/(oppo) ?([\w ]+) bui/i],[S,C,[_,M]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[S,C,[_,Z]],[/(surface duo)/i],[C,[S,Ic],[_,Z]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[C,[S,"Fairphone"],[_,M]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[C,[S,Oc],[_,Z]],[/(sprint) (\w+)/i],[S,C,[_,M]],[/(kin\.[onetw]{3})/i],[[C,/\./g," "],[S,Ic],[_,M]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[C,[S,jc],[_,Z]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[C,[S,jc],[_,M]],[/smart-tv.+(samsung)/i],[S,[_,fe]],[/hbbtv.+maple;(\d+)/i],[[C,/^/,"SmartTV"],[S,ri],[_,fe]],[/tcast.+(lg)e?. ([-\w]+)/i],[S,C,[_,fe]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[S,_o],[_,fe]],[/(apple) ?tv/i],[S,[C,Vn+" TV"],[_,fe]],[/crkey.*devicetype\/chromecast/i],[[C,Mr+" Third Generation"],[S,pn],[_,fe]],[/crkey.*devicetype\/([^/]*)/i],[[C,/^/,"Chromecast "],[S,pn],[_,fe]],[/fuchsia.*crkey/i],[[C,Mr+" Nest Hub"],[S,pn],[_,fe]],[/crkey/i],[[C,Mr],[S,pn],[_,fe]],[/(portaltv)/i],[C,[S,$c],[_,fe]],[/droid.+aft(\w+)( bui|\))/i],[C,[S,vo],[_,fe]],[/(shield \w+ tv)/i],[C,[S,Oc],[_,fe]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[C,[S,Ep],[_,fe]],[/(bravia[\w ]+)( bui|\))/i],[C,[S,ni],[_,fe]],[/(mi(tv|box)-?\w+) bui/i],[C,[S,Ac],[_,fe]],[/Hbbtv.*(technisat) (.*);/i],[S,C,[_,fe]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[S,ci],[C,ci],[_,fe]],[/droid.+; ([\w- ]+) (?:android tv|smart[- ]?tv)/i],[C,[_,fe]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[_,fe]],[/(ouya)/i,/(nintendo) (\w+)/i],[S,C,[_,B]],[/droid.+; (shield)( bui|\))/i],[C,[S,Oc],[_,B]],[/(playstation \w+)/i],[C,[S,ni],[_,B]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[C,[S,Ic],[_,B]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[C,[S,ri],[_,mt]],[/((pebble))app/i,/(asus|google|lg|oppo) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[S,C,[_,mt]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[C,[S,Nc],[_,mt]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[C,[S,Vn],[_,mt]],[/(opwwe\d{3})/i],[C,[S,Tp],[_,mt]],[/(moto 360)/i],[C,[S,Mc],[_,mt]],[/(smartwatch 3)/i],[C,[S,ni],[_,mt]],[/(g watch r)/i],[C,[S,_o],[_,mt]],[/droid.+; (wt63?0{2,3})\)/i],[C,[S,jc],[_,mt]],[/droid.+; (glass) \d/i],[C,[S,pn],[_,ei]],[/(pico) (4|neo3(?: link|pro)?)/i],[S,C,[_,ei]],[/(quest( \d| pro)?s?).+vr/i],[C,[S,$c],[_,ei]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[S,[_,pr]],[/(aeobc)\b/i],[C,[S,vo],[_,pr]],[/(homepod).+mac os/i],[C,[S,Vn],[_,pr]],[/windows iot/i],[[_,pr]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+?(mobile|vr|\d) safari/i],[C,[_,Nr,{mobile:"Mobile",xr:"VR","*":Z}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[_,Z]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[_,M]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[C,[S,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[R,[h,d_+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[h,R],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[R,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,R],[/ladybird\//i],[[h,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[R,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,R],[/(windows (?:phone(?: os)?|mobile|iot))[\/ ]?([\d\.\w ]*)/i],[h,[R,Nr,Ip]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[R,Nr,Ip],[h,Fc]],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[R,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,"macOS"],[R,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[R,[h,Mr+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[R,[h,Mr+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[R,[h,Mr+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[R,[h,Mr+" Linux"]],[/crkey\/([\d\.]+)/i],[R,[h,Mr]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[R,h],[/(ubuntu) ([\w\.]+) like android/i],[[h,/(.+)/,"$1 Touch"],R],[/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen|webos)\w*[-\/\.; ]?([\d\.]*)/i],[h,R],[/\(bb(10);/i],[R,[h,Rp]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[R,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[R,[h,si+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[R,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[R,[h,"watchOS"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,"Chrome OS"],R],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux)(?: arm\w*| x86\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,R],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],R],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,R]]},So=function(){var T={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}};return vr.call(T.init,[[f,[h,R,x,_]],[y,[E]],[w,[_,C,S]],[b,[h,R]],[m,[h,R]]]),vr.call(T.isIgnore,[[f,[R,x]],[b,[R]],[m,[R]]]),vr.call(T.isIgnoreRgx,[[f,/ ?browser$/i],[m,/ ?os$/i]]),vr.call(T.toString,[[f,[h,R]],[y,[E]],[w,[S,C]],[b,[h,R]],[m,[h,R]]]),T}(),p_=function(T,L){var I=So.init[L],ne=So.isIgnore[L]||0,U=So.isIgnoreRgx[L]||0,ue=So.toString[L]||0;function N(){vr.call(this,I)}return N.prototype.getItem=function(){return T},N.prototype.withClientHints=function(){return Or?Or.getHighEntropyValues(wp).then(function(oe){return T.setCH(new Np(oe,!1)).parseCH().get()}):T.parseCH().get()},N.prototype.withFeatureCheck=function(){return T.detectFeature().get()},L!=v&&(N.prototype.is=function(oe){var q=!1;for(var Ee in this)if(this.hasOwnProperty(Ee)&&!zc(ne,Ee)&&gr(U?Wn(U,this[Ee]):this[Ee])==gr(U?Wn(U,oe):oe)){if(q=!0,oe!=u)break}else if(oe==u&&q){q=!q;break}return q},N.prototype.toString=function(){var oe=a;for(var q in ue)typeof this[ue[q]]!==u&&(oe+=(oe?" ":a)+this[ue[q]]);return oe||u}),Or||(N.prototype.then=function(oe){var q=this,Ee=function(){for(var Ar in q)q.hasOwnProperty(Ar)&&(this[Ar]=q[Ar])};Ee.prototype={is:N.prototype.is,toString:N.prototype.toString};var _r=new Ee;return oe(_r),_r}),new N};function Np(T,L){if(T=T||{},vr.call(this,wp),L)vr.call(this,[[D,Bc(T[Qe])],[K,Bc(T[ti])],[M,/\?1/.test(T[a_])],[C,ai(T[c_])],[le,ai(T[yp])],[ke,ai(T[l_])],[E,ai(T[mr])],[F,Bc(T[o_])],[hr,ai(T[Hn])]]);else for(var I in T)this.hasOwnProperty(I)&&typeof T[I]!==u&&(this[I]=T[I])}function Ap(T,L,I,ne){return this.get=function(U){return U?this.data.hasOwnProperty(U)?this.data[U]:n:this.data},this.set=function(U,ue){return this.data[U]=ue,this},this.setCH=function(U){return this.uaCH=U,this},this.detectFeature=function(){if(ct&&ct.userAgent==this.ua)switch(this.itemType){case f:ct.brave&&typeof ct.brave.isBrave==l&&this.set(h,"Brave");break;case w:!this.get(_)&&Or&&Or[M]&&this.set(_,M),this.get(C)=="Macintosh"&&ct&&typeof ct.standalone!==u&&ct.maxTouchPoints&&ct.maxTouchPoints>2&&this.set(C,"iPad").set(_,Z);break;case m:!this.get(h)&&Or&&Or[le]&&this.set(h,Or[le]);break;case v:var U=this.data,ue=function(N){return U[N].getItem().detectFeature().get()};this.set(f,ue(f)).set(y,ue(y)).set(w,ue(w)).set(b,ue(b)).set(m,ue(m))}return this},this.parseUA=function(){return this.itemType!=v&&Hc.call(this.data,this.ua,this.rgxMap),this.itemType==f&&this.set(x,Uc(this.get(R))),this},this.parseCH=function(){var U=this.uaCH,ue=this.rgxMap;switch(this.itemType){case f:case b:var N=U[K]||U[D],oe;if(N)for(var q in N){var Ee=N[q].brand||N[q],_r=N[q].version;this.itemType==f&&!/not.a.brand/i.test(Ee)&&(!oe||/chrom/i.test(oe)&&Ee!=Pp)&&(Ee=Nr(Ee,{Chrome:"Google Chrome",Edge:"Microsoft Edge","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"}),this.set(h,Ee).set(R,_r).set(x,Uc(_r)),oe=Ee),this.itemType==b&&Ee==Pp&&this.set(R,_r)}break;case y:var Ar=U[E];Ar&&(Ar&&U[hr]=="64"&&(Ar+="64"),Hc.call(this.data,Ar+";",ue));break;case w:if(U[M]&&this.set(_,M),U[C]&&(this.set(C,U[C]),!this.get(_)||!this.get(S))){var li={};Hc.call(li,"droid 9; "+U[C]+")",ue),!this.get(_)&&li.type&&this.set(_,li.type),!this.get(S)&&li.vendor&&this.set(S,li.vendor)}if(U[F]){var bo;if(typeof U[F]!="string")for(var jp=0;!bo&&jp<U[F].length;)bo=Nr(U[F][jp++],Mp);else bo=Nr(U[F],Mp);this.set(_,bo)}break;case m:var Vc=U[le];if(Vc){var Kc=U[ke];Vc==Fc&&(Kc=parseInt(Uc(Kc),10)>=13?"11":"10"),this.set(h,Vc).set(R,Kc)}this.get(h)==Fc&&U[C]=="Xbox"&&this.set(h,"Xbox").set(R,n);break;case v:var f_=this.data,di=function(h_){return f_[h_].getItem().setCH(U).parseCH().get()};this.set(f,di(f)).set(y,di(y)).set(w,di(w)).set(b,di(b)).set(m,di(m))}return this},vr.call(this,[["itemType",T],["ua",L],["uaCH",ne],["rgxMap",I],["data",p_(this,T)]]),this}function Mt(T,L,I){if(typeof T===d?(wo(T,!0)?(typeof L===d&&(I=L),L=T):(I=T,L=n),T=n):typeof T===p&&!wo(L,!0)&&(I=L,L=n),I&&typeof I.append===l){var ne={};I.forEach(function(q,Ee){ne[Ee]=q}),I=ne}if(!(this instanceof Mt))return new Mt(T,L,I).getResult();var U=typeof T===p?T:I&&I[o]?I[o]:ct&&ct.userAgent?ct.userAgent:a,ue=new Np(I,!0),N=L?u_(Op,L):Op,oe=function(q){return q==v?function(){return new Ap(q,U,N,ue).set("ua",U).set(f,this.getBrowser()).set(y,this.getCPU()).set(w,this.getDevice()).set(b,this.getEngine()).set(m,this.getOS()).get()}:function(){return new Ap(q,U,N[q],ue).parseUA().get()}};return vr.call(this,[["getBrowser",oe(f)],["getCPU",oe(y)],["getDevice",oe(w)],["getEngine",oe(b)],["getOS",oe(m)],["getResult",oe(v)],["getUA",function(){return U}],["setUA",function(q){return Qn(q)&&(U=q.length>i?ci(q,i):q),this}]]).setUA(U),this}Mt.VERSION=s,Mt.BROWSER=yo([h,R,x,_]),Mt.CPU=yo([E]),Mt.DEVICE=yo([C,S,_,B,M,fe,Z,mt,pr]),Mt.ENGINE=Mt.OS=yo([h,R]),e.exports&&(t=e.exports=Mt),t.UAParser=Mt;var qn=Lp&&(r.jQuery||r.Zepto);if(qn&&!qn.ua){var Ro=new Mt;qn.ua=Ro.getResult(),qn.ua.get=function(){return Ro.getUA()},qn.ua.set=function(T){Ro.setUA(T);var L=Ro.getResult();for(var I in L)qn.ua[I]=L[I]}}})(typeof window=="object"?window:vn)})(Al,Al.exports);var V_=Al.exports,ye={};Object.defineProperty(ye,"__esModule",{value:!0});ye.Logger=void 0;const Gn=Ka,Yn="mediasoup-client";let K_=class{constructor(t){g(this,"_debug");g(this,"_warn");g(this,"_error");t?(this._debug=(0,Gn.default)(`${Yn}:${t}`),this._warn=(0,Gn.default)(`${Yn}:WARN:${t}`),this._error=(0,Gn.default)(`${Yn}:ERROR:${t}`)):(this._debug=(0,Gn.default)(Yn),this._warn=(0,Gn.default)(`${Yn}:WARN`),this._error=(0,Gn.default)(`${Yn}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};ye.Logger=K_;var Vt={},Vd={exports:{}},Ds=typeof Reflect=="object"?Reflect:null,Vp=Ds&&typeof Ds.apply=="function"?Ds.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},oa;Ds&&typeof Ds.ownKeys=="function"?oa=Ds.ownKeys:Object.getOwnPropertySymbols?oa=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:oa=function(t){return Object.getOwnPropertyNames(t)};function Q_(e){console&&console.warn&&console.warn(e)}var mm=Number.isNaN||function(t){return t!==t};function de(){de.init.call(this)}Vd.exports=de;Vd.exports.once=Y_;de.EventEmitter=de;de.prototype._events=void 0;de.prototype._eventsCount=0;de.prototype._maxListeners=void 0;var Kp=10;function Qa(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(de,"defaultMaxListeners",{enumerable:!0,get:function(){return Kp},set:function(e){if(typeof e!="number"||e<0||mm(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Kp=e}});de.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};de.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||mm(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function gm(e){return e._maxListeners===void 0?de.defaultMaxListeners:e._maxListeners}de.prototype.getMaxListeners=function(){return gm(this)};de.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=t==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[t];if(c===void 0)return!1;if(typeof c=="function")Vp(c,this,r);else for(var l=c.length,u=Sm(c,l),n=0;n<l;++n)Vp(u[n],this,r);return!0};function vm(e,t,r,n){var s,i,o;if(Qa(r),i=e._events,i===void 0?(i=e._events=Object.create(null),e._eventsCount=0):(i.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),o===void 0)o=i[t]=r,++e._eventsCount;else if(typeof o=="function"?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),s=gm(e),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,Q_(a)}return e}de.prototype.addListener=function(t,r){return vm(this,t,r,!1)};de.prototype.on=de.prototype.addListener;de.prototype.prependListener=function(t,r){return vm(this,t,r,!0)};function W_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _m(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=W_.bind(n);return s.listener=r,n.wrapFn=s,s}de.prototype.once=function(t,r){return Qa(r),this.on(t,_m(this,t,r)),this};de.prototype.prependOnceListener=function(t,r){return Qa(r),this.prependListener(t,_m(this,t,r)),this};de.prototype.removeListener=function(t,r){var n,s,i,o,a;if(Qa(r),s=this._events,s===void 0)return this;if(n=s[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():q_(n,i),n.length===1&&(s[t]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",t,a||r)}return this};de.prototype.off=de.prototype.removeListener;de.prototype.removeAllListeners=function(t){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(t,r[s]);return this};function ym(e,t,r){var n=e._events;if(n===void 0)return[];var s=n[t];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?G_(s):Sm(s,s.length)}de.prototype.listeners=function(t){return ym(this,t,!0)};de.prototype.rawListeners=function(t){return ym(this,t,!1)};de.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):wm.call(e,t)};de.prototype.listenerCount=wm;function wm(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}de.prototype.eventNames=function(){return this._eventsCount>0?oa(this._events):[]};function Sm(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function q_(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function G_(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Y_(e,t){return new Promise(function(r,n){function s(o){e.removeListener(t,i),n(o)}function i(){typeof e.removeListener=="function"&&e.removeListener("error",s),r([].slice.call(arguments))}Rm(e,t,i,{once:!0}),t!=="error"&&X_(e,s,{once:!0})})}function X_(e,t,r){typeof e.on=="function"&&Rm(e,"error",t,r)}function Rm(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function s(i){n.once&&e.removeEventListener(t,s),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var J_=Vd.exports;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.EnhancedEventEmitter=void 0;const Z_=J_,ey=ye,ty=new ey.Logger("EnhancedEventEmitter");class ry extends Z_.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(t,...r){return super.emit(t,...r)}safeEmit(t,...r){try{return super.emit(t,...r)}catch(n){ty.error("safeEmit() | event listener threw an error [eventName:%s]:%o",t,n);try{super.emit("listenererror",t,n)}catch{}return!!super.listenerCount(t)}}on(t,r){return super.on(t,r),this}off(t,r){return super.off(t,r),this}addListener(t,r){return super.on(t,r),this}prependListener(t,r){return super.prependListener(t,r),this}once(t,r){return super.once(t,r),this}prependOnceListener(t,r){return super.prependOnceListener(t,r),this}removeListener(t,r){return super.off(t,r),this}removeAllListeners(t){return super.removeAllListeners(t),this}listenerCount(t){return super.listenerCount(t)}listeners(t){return super.listeners(t)}rawListeners(t){return super.rawListeners(t)}}Vt.EnhancedEventEmitter=ry;var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.InvalidStateError=xe.UnsupportedError=void 0;class Kd extends Error{constructor(t){super(t),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Kd):this.stack=new Error(t).stack}}xe.UnsupportedError=Kd;class Qd extends Error{constructor(t){super(t),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Qd):this.stack=new Error(t).stack}}xe.InvalidStateError=Qd;var be={};Object.defineProperty(be,"__esModule",{value:!0});be.clone=ny;be.generateRandomNumber=sy;be.deepFreeze=bm;function ny(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}function sy(){return Math.round(Math.random()*1e7)}function bm(e){const t=Reflect.ownKeys(e);for(const r of t){const n=e[r];(n&&typeof n=="object"||typeof n=="function")&&bm(n)}return Object.freeze(e)}var ce={},Ue={},Wa={},iy=vn&&vn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.Logger=void 0;const Xn=iy(Ka),Jn="h264-profile-level-id";let oy=class{constructor(t){t?(this._debug=(0,Xn.default)(`${Jn}:${t}`),this._warn=(0,Xn.default)(`${Jn}:WARN:${t}`),this._error=(0,Xn.default)(`${Jn}:ERROR:${t}`)):(this._debug=(0,Xn.default)(Jn),this._warn=(0,Xn.default)(`${Jn}:WARN`),this._error=(0,Xn.default)(`${Jn}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};Wa.Logger=oy;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.ProfileLevelId=Ue.Level=Ue.Profile=void 0;Ue.parseProfileLevelId=Cm;Ue.profileLevelIdToString=km;Ue.profileToString=dy;Ue.levelToString=uy;Ue.parseSdpProfileLevelId=Ln;Ue.isSameProfile=py;Ue.isSameProfileAndLevel=fy;Ue.generateProfileLevelIdStringForAnswer=hy;Ue.supportedLevel=my;const ay=Wa,zt=new ay.Logger;var pe;(function(e){e[e.ConstrainedBaseline=1]="ConstrainedBaseline",e[e.Baseline=2]="Baseline",e[e.Main=3]="Main",e[e.ConstrainedHigh=4]="ConstrainedHigh",e[e.High=5]="High",e[e.PredictiveHigh444=6]="PredictiveHigh444"})(pe||(Ue.Profile=pe={}));var O;(function(e){e[e.L1_b=0]="L1_b",e[e.L1=10]="L1",e[e.L1_1=11]="L1_1",e[e.L1_2=12]="L1_2",e[e.L1_3=13]="L1_3",e[e.L2=20]="L2",e[e.L2_1=21]="L2_1",e[e.L2_2=22]="L2_2",e[e.L3=30]="L3",e[e.L3_1=31]="L3_1",e[e.L3_2=32]="L3_2",e[e.L4=40]="L4",e[e.L4_1=41]="L4_1",e[e.L4_2=42]="L4_2",e[e.L5=50]="L5",e[e.L5_1=51]="L5_1",e[e.L5_2=52]="L5_2"})(O||(Ue.Level=O={}));class qa{constructor(t,r){this.profile=t,this.level=r}}Ue.ProfileLevelId=qa;const cy=new qa(pe.ConstrainedBaseline,O.L3_1);class yr{constructor(t){this.mask=~Wp("x",t),this.masked_value=Wp("1",t)}isMatch(t){return this.masked_value===(t&this.mask)}}class wr{constructor(t,r,n){this.profile_idc=t,this.profile_iop=r,this.profile=n}}const ly=[new wr(66,new yr("x1xx0000"),pe.ConstrainedBaseline),new wr(77,new yr("1xxx0000"),pe.ConstrainedBaseline),new wr(88,new yr("11xx0000"),pe.ConstrainedBaseline),new wr(66,new yr("x0xx0000"),pe.Baseline),new wr(88,new yr("10xx0000"),pe.Baseline),new wr(77,new yr("0x0x0000"),pe.Main),new wr(100,new yr("00000000"),pe.High),new wr(100,new yr("00001100"),pe.ConstrainedHigh),new wr(244,new yr("00000000"),pe.PredictiveHigh444)],Qp=[{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:O.L1},{max_macroblocks_per_second:1485,max_macroblock_frame_size:99,level:O.L1_b},{max_macroblocks_per_second:3e3,max_macroblock_frame_size:396,level:O.L1_1},{max_macroblocks_per_second:6e3,max_macroblock_frame_size:396,level:O.L1_2},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:O.L1_3},{max_macroblocks_per_second:11880,max_macroblock_frame_size:396,level:O.L2},{max_macroblocks_per_second:19800,max_macroblock_frame_size:792,level:O.L2_1},{max_macroblocks_per_second:20250,max_macroblock_frame_size:1620,level:O.L2_2},{max_macroblocks_per_second:40500,max_macroblock_frame_size:1620,level:O.L3},{max_macroblocks_per_second:108e3,max_macroblock_frame_size:3600,level:O.L3_1},{max_macroblocks_per_second:216e3,max_macroblock_frame_size:5120,level:O.L3_2},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:O.L4},{max_macroblocks_per_second:245760,max_macroblock_frame_size:8192,level:O.L4_1},{max_macroblocks_per_second:522240,max_macroblock_frame_size:8704,level:O.L4_2},{max_macroblocks_per_second:589824,max_macroblock_frame_size:22080,level:O.L5},{max_macroblocks_per_second:983040,max_macroblock_frame_size:36864,level:O.L5_1},{max_macroblocks_per_second:2073600,max_macroblock_frame_size:36864,level:O.L5_2}];function Cm(e){if(typeof e!="string"||e.length!==6)return;const r=parseInt(e,16);if(r===0)return;const n=r&255,s=r>>8&255,i=r>>16&255;let o;switch(n){case O.L1_1:{o=s&16?O.L1_b:O.L1_1;break}case O.L1:case O.L1_2:case O.L1_3:case O.L2:case O.L2_1:case O.L2_2:case O.L3:case O.L3_1:case O.L3_2:case O.L4:case O.L4_1:case O.L4_2:case O.L5:case O.L5_1:case O.L5_2:{o=n;break}default:{zt.warn(`parseProfileLevelId() | unrecognized level_idc [str:${e}, level_idc:${n}]`);return}}for(const a of ly)if(i===a.profile_idc&&a.profile_iop.isMatch(s))return zt.debug(`parseProfileLevelId() | result [str:${e}, profile:${a.profile}, level:${o}]`),new qa(a.profile,o);zt.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${e}, profile_idc:${i}, profile_iop:${s}]`)}function km(e){if(e.level==O.L1_b)switch(e.profile){case pe.ConstrainedBaseline:return"42f00b";case pe.Baseline:return"42100b";case pe.Main:return"4d100b";default:{zt.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${e.profile}`);return}}let t;switch(e.profile){case pe.ConstrainedBaseline:{t="42e0";break}case pe.Baseline:{t="4200";break}case pe.Main:{t="4d00";break}case pe.ConstrainedHigh:{t="640c";break}case pe.High:{t="6400";break}case pe.PredictiveHigh444:{t="f400";break}default:{zt.warn(`profileLevelIdToString() | unrecognized profile ${e.profile}`);return}}let r=e.level.toString(16);return r.length===1&&(r=`0${r}`),`${t}${r}`}function dy(e){switch(e){case pe.ConstrainedBaseline:return"ConstrainedBaseline";case pe.Baseline:return"Baseline";case pe.Main:return"Main";case pe.ConstrainedHigh:return"ConstrainedHigh";case pe.High:return"High";case pe.PredictiveHigh444:return"PredictiveHigh444";default:{zt.warn(`profileToString() | unrecognized profile ${e}`);return}}}function uy(e){switch(e){case O.L1_b:return"1b";case O.L1:return"1";case O.L1_1:return"1.1";case O.L1_2:return"1.2";case O.L1_3:return"1.3";case O.L2:return"2";case O.L2_1:return"2.1";case O.L2_2:return"2.2";case O.L3:return"3";case O.L3_1:return"3.1";case O.L3_2:return"3.2";case O.L4:return"4";case O.L4_1:return"4.1";case O.L4_2:return"4.2";case O.L5:return"5";case O.L5_1:return"5.1";case O.L5_2:return"5.2";default:{zt.warn(`levelToString() | unrecognized level ${e}`);return}}}function Ln(e={}){const t=e["profile-level-id"];return t?Cm(t):cy}function py(e={},t={}){const r=Ln(e),n=Ln(t);return!!(r&&n&&r.profile===n.profile)}function fy(e={},t={}){const r=Ln(e),n=Ln(t);return!!(r&&n&&r.profile===n.profile&&r.level==n.level)}function hy(e={},t={}){if(!e["profile-level-id"]&&!t["profile-level-id"]){zt.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const r=Ln(e),n=Ln(t);if(!r)throw new TypeError("invalid local_profile_level_id");if(!n)throw new TypeError("invalid remote_profile_level_id");if(r.profile!==n.profile)throw new TypeError("H264 Profile mismatch");const s=qp(e)&&qp(t),i=r.level,o=n.level,a=vy(i,o),c=s?i:a;return zt.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${r.profile}, level:${c}]`),km(new qa(r.profile,c))}function my(e,t){for(let n=Qp.length-1;n>=0;--n){const s=Qp[n];if(s.max_macroblock_frame_size*256<=e&&s.max_macroblocks_per_second<=t*s.max_macroblock_frame_size)return zt.debug(`supportedLevel() | result [max_frame_pixel_count:${e}, max_fps:${t}, level:${s.level}]`),s.level}zt.warn(`supportedLevel() | no level supported [max_frame_pixel_count:${e}, max_fps:${t}]`)}function Wp(e,t){return+(t[0]===e)<<7|+(t[1]===e)<<6|+(t[2]===e)<<5|+(t[3]===e)<<4|+(t[4]===e)<<3|+(t[5]===e)<<2|+(t[6]===e)<<1|+(t[7]===e)<<0}function gy(e,t){return e===O.L1_b?t!==O.L1&&t!==O.L1_b:t===O.L1_b?e!==O.L1:e<t}function vy(e,t){return gy(e,t)?e:t}function qp(e={}){const t=e["level-asymmetry-allowed"];return t===!0||t===1||t==="1"}Object.defineProperty(ce,"__esModule",{value:!0});ce.validateRtpCapabilities=Ry;ce.validateRtpParameters=Wd;ce.validateSctpStreamParameters=by;ce.validateSctpCapabilities=Cy;ce.getExtendedRtpCapabilities=ky;ce.getRecvRtpCapabilities=Ty;ce.getSendingRtpParameters=Ey;ce.getSendingRemoteRtpParameters=Dy;ce.reduceCodecs=Py;ce.generateProbatorRtpParameters=xy;ce.canSend=Ly;ce.canReceive=Iy;const Gp=Ue,_y=be,yy="probator",wy=1234,Sy=127;function Ry(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);for(const t of e.codecs)My(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)Oy(t)}function Wd(e){if(typeof e!="object")throw new TypeError("params is not an object");if(e.mid&&typeof e.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");for(const t of e.codecs)Ny(t);if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);for(const t of e.headerExtensions)Ay(t);if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);for(const t of e.encodings)jy(t);if(e.rtcp&&typeof e.rtcp!="object")throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),$y(e.rtcp)}function by(e){if(typeof e!="object")throw new TypeError("params is not an object");if(typeof e.streamId!="number")throw new TypeError("missing params.streamId");let t=!1;if(typeof e.ordered=="boolean"?t=!0:e.ordered=!0,e.maxPacketLifeTime&&typeof e.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&typeof e.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!t&&(e.maxPacketLifeTime||e.maxRetransmits)&&(e.ordered=!1),e.label&&typeof e.label!="string")throw new TypeError("invalid params.label");if(e.protocol&&typeof e.protocol!="string")throw new TypeError("invalid params.protocol")}function Cy(e){if(typeof e!="object")throw new TypeError("caps is not an object");if(!e.numStreams||typeof e.numStreams!="object")throw new TypeError("missing caps.numStreams");Fy(e.numStreams)}function ky(e,t,r){const n={codecs:[],headerExtensions:[]};if(r)for(const s of e.codecs??[]){if(ms(s))continue;const i=(t.codecs??[]).find(a=>jl(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={mimeType:s.mimeType,kind:s.kind,clockRate:s.clockRate,channels:s.channels,localPayloadType:s.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:i.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:s.parameters,remoteParameters:i.parameters,rtcpFeedback:Yp(s,i)};n.codecs.push(o)}else for(const s of t.codecs??[]){if(ms(s))continue;const i=(e.codecs??[]).find(a=>jl(a,s,{strict:!0,modify:!0}));if(!i)continue;const o={mimeType:i.mimeType,kind:i.kind,clockRate:i.clockRate,channels:i.channels,localPayloadType:i.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:s.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:i.parameters,remoteParameters:s.parameters,rtcpFeedback:Yp(i,s)};n.codecs.push(o)}for(const s of n.codecs){const i=e.codecs.find(a=>ms(a)&&a.parameters.apt===s.localPayloadType),o=t.codecs.find(a=>ms(a)&&a.parameters.apt===s.remotePayloadType);i&&o&&(s.localRtxPayloadType=i.preferredPayloadType,s.remoteRtxPayloadType=o.preferredPayloadType)}for(const s of t.headerExtensions){const i=e.headerExtensions.find(a=>zy(a,s));if(!i)continue;const o={kind:s.kind,uri:s.uri,sendId:i.preferredId,recvId:s.preferredId,encrypt:i.preferredEncrypt,direction:"sendrecv"};switch(s.direction){case"sendrecv":{o.direction="sendrecv";break}case"recvonly":{o.direction="sendonly";break}case"sendonly":{o.direction="recvonly";break}case"inactive":{o.direction="inactive";break}}n.headerExtensions.push(o)}return n}function Ty(e){const t={codecs:[],headerExtensions:[]};for(const r of e.codecs){const n={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(t.codecs.push(n),!r.remoteRtxPayloadType)continue;const s={mimeType:`${r.kind}/rtx`,kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};t.codecs.push(s)}for(const r of e.headerExtensions){if(r.direction!=="sendrecv"&&r.direction!=="recvonly")continue;const n={kind:r.kind,uri:r.uri,preferredId:r.recvId,preferredEncrypt:r.encrypt,direction:r.direction};t.headerExtensions.push(n)}return t}function Ey(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const s={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(s),n.localRtxPayloadType){const i={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(i)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const s={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(s)}return r}function Dy(e,t){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of t.codecs){if(n.kind!==e)continue;const s={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.remoteParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(s),n.localRtxPayloadType){const i={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(i)}}for(const n of t.headerExtensions){if(n.kind&&n.kind!==e||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const s={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(s)}if(r.headerExtensions.some(n=>n.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="goog-remb");else if(r.headerExtensions.some(n=>n.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc");else for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(s=>s.type!=="transport-cc"&&s.type!=="goog-remb");return r}function Py(e,t){const r=[];if(!t)r.push(e[0]),ms(e[1])&&r.push(e[1]);else{for(let n=0;n<e.length;++n)if(jl(e[n],t,{strict:!0})){r.push(e[n]),ms(e[n+1])&&r.push(e[n+1]);break}if(r.length===0)throw new TypeError("no matching codec found")}return r}function xy(e){e=_y.clone(e),Wd(e);const t={mid:yy,codecs:[],headerExtensions:[],encodings:[{ssrc:wy}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=Sy,t.headerExtensions=e.headerExtensions,t}function Ly(e,t){return t.codecs.some(r=>r.kind===e)}function Iy(e,t){if(Wd(e),e.codecs.length===0)return!1;const r=e.codecs[0];return t.codecs.some(n=>n.remotePayloadType===r.payloadType)}function My(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&typeof e.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");e.kind==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const n of Object.keys(e.parameters)){let s=e.parameters[n];if(s===void 0&&(e.parameters[n]="",s=""),typeof s!="string"&&typeof s!="number")throw new TypeError(`invalid codec parameter [key:${n}s, value:${s}]`);if(n==="apt"&&typeof s!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const n of e.rtcpFeedback)Tm(n)}function Tm(e){if(typeof e!="object")throw new TypeError("fb is not an object");if(!e.type||typeof e.type!="string")throw new TypeError("missing fb.type");(!e.parameter||typeof e.parameter!="string")&&(e.parameter="")}function Oy(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(e.kind!=="audio"&&e.kind!=="video")throw new TypeError("invalid ext.kind");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.preferredId!="number")throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&typeof e.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&typeof e.direction!="string")throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function Ny(e){const t=new RegExp("^(audio|video)/(.+)","i");if(typeof e!="object")throw new TypeError("codec is not an object");if(!e.mimeType||typeof e.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(typeof e.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof e.clockRate!="number")throw new TypeError("missing codec.clockRate");r[1].toLowerCase()==="audio"?typeof e.channels!="number"&&(e.channels=1):delete e.channels,(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const s of Object.keys(e.parameters)){let i=e.parameters[s];if(i===void 0&&(e.parameters[s]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${s}s, value:${i}]`);if(s==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);for(const s of e.rtcpFeedback)Tm(s)}function Ay(e){if(typeof e!="object")throw new TypeError("ext is not an object");if(!e.uri||typeof e.uri!="string")throw new TypeError("missing ext.uri");if(typeof e.id!="number")throw new TypeError("missing ext.id");if(e.encrypt&&typeof e.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),(!e.parameters||typeof e.parameters!="object")&&(e.parameters={});for(const t of Object.keys(e.parameters)){let r=e.parameters[t];if(r===void 0&&(e.parameters[t]="",r=""),typeof r!="string"&&typeof r!="number")throw new TypeError("invalid header extension parameter")}}function jy(e){if(typeof e!="object")throw new TypeError("encoding is not an object");if(e.ssrc&&typeof e.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(e.rid&&typeof e.rid!="string")throw new TypeError("invalid encoding.rid");if(e.rtx&&typeof e.rtx!="object")throw new TypeError("invalid encoding.rtx");if(e.rtx&&typeof e.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!e.dtx||typeof e.dtx!="boolean")&&(e.dtx=!1),e.scalabilityMode&&typeof e.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function $y(e){if(typeof e!="object")throw new TypeError("rtcp is not an object");if(e.cname&&typeof e.cname!="string")throw new TypeError("invalid rtcp.cname");(!e.reducedSize||typeof e.reducedSize!="boolean")&&(e.reducedSize=!0)}function Fy(e){if(typeof e!="object")throw new TypeError("numStreams is not an object");if(typeof e.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof e.MIS!="number")throw new TypeError("missing numStreams.MIS")}function ms(e){return e?/.+\/rtx$/i.test(e.mimeType):!1}function jl(e,t,{strict:r=!1,modify:n=!1}={}){const s=e.mimeType.toLowerCase(),i=t.mimeType.toLowerCase();if(s!==i||e.clockRate!==t.clockRate||e.channels!==t.channels)return!1;switch(s){case"video/h264":{if(r){const o=e.parameters["packetization-mode"]??0,a=t.parameters["packetization-mode"]??0;if(o!==a||!Gp.isSameProfile(e.parameters,t.parameters))return!1;let c;try{c=Gp.generateProfileLevelIdStringForAnswer(e.parameters,t.parameters)}catch{return!1}n&&(c?(e.parameters["profile-level-id"]=c,t.parameters["profile-level-id"]=c):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break}case"video/vp9":{if(r){const o=e.parameters["profile-id"]??0,a=t.parameters["profile-id"]??0;if(o!==a)return!1}break}}return!0}function zy(e,t){return!(e.kind&&t.kind&&e.kind!==t.kind||e.uri!==t.uri)}function Yp(e,t){const r=[];for(const n of e.rtcpFeedback??[]){const s=(t.rtcpFeedback??[]).find(i=>i.type===n.type&&(i.parameter===n.parameter||!i.parameter&&!n.parameter));s&&r.push(s)}return r}var io={},Em={},Ga={},Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.Logger=void 0;const Zn=Ka,es="awaitqueue";class By{constructor(t){g(this,"_debug");g(this,"_warn");g(this,"_error");t?(this._debug=Zn(`${es}:${t}`),this._warn=Zn(`${es}:WARN:${t}`),this._error=Zn(`${es}:ERROR:${t}`)):(this._debug=Zn(es),this._warn=Zn(`${es}:WARN`),this._error=Zn(`${es}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}Ya.Logger=By;var In={};Object.defineProperty(In,"__esModule",{value:!0});In.AwaitQueueRemovedTaskError=In.AwaitQueueStoppedError=void 0;class qd extends Error{constructor(t){super(t??"queue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,qd)}}In.AwaitQueueStoppedError=qd;class Gd extends Error{constructor(t){super(t??"queue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Gd)}}In.AwaitQueueRemovedTaskError=Gd;Object.defineProperty(Ga,"__esModule",{value:!0});Ga.AwaitQueue=void 0;const Uy=Ya,Xp=In,Sr=new Uy.Logger("AwaitQueue");class Hy{constructor(){g(this,"pendingTasks",new Map);g(this,"nextTaskId",0);g(this,"stopping",!1);Sr.debug("constructor()")}get size(){return this.pendingTasks.size}async push(t,r){if(r=r??t.name,Sr.debug(`push() [name:${r}]`),typeof t!="function")throw new TypeError("given task is not a function");if(r)try{Object.defineProperty(t,"name",{value:r})}catch{}return new Promise((n,s)=>{const i={id:this.nextTaskId++,task:t,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:o=>{if(i.completed)return;i.completed=!0,this.pendingTasks.delete(i.id),Sr.debug(`resolving task [name:${i.name}]`),n(o);const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)},reject:o=>{if(!i.completed&&(i.completed=!0,this.pendingTasks.delete(i.id),Sr.debug(`rejecting task [name:${i.name}]: %s`,String(o)),s(o),!this.stopping)){const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)}}};this.pendingTasks.set(i.id,i),this.pendingTasks.size===1&&this.execute(i)})}stop(){Sr.debug("stop()"),this.stopping=!0;for(const t of this.pendingTasks.values())Sr.debug(`stop() | stopping task [name:${t.name}]`),t.reject(new Xp.AwaitQueueStoppedError);this.stopping=!1}remove(t){Sr.debug(`remove() [taskIdx:${t}]`);const r=Array.from(this.pendingTasks.values())[t];if(!r){Sr.debug(`stop() | no task with given idx [taskIdx:${t}]`);return}r.reject(new Xp.AwaitQueueRemovedTaskError)}dump(){const t=Date.now();let r=0;return Array.from(this.pendingTasks.values()).map(n=>({idx:r++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:t-n.enqueuedAt,executionTime:n.executedAt?t-n.executedAt:0}))}async execute(t){if(Sr.debug(`execute() [name:${t.name}]`),t.executedAt)throw new Error("task already being executed");t.executedAt=Date.now();try{const r=await t.task();t.resolve(r)}catch(r){t.reject(r)}}}Ga.AwaitQueue=Hy;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AwaitQueueRemovedTaskError=e.AwaitQueueStoppedError=e.AwaitQueue=void 0;var t=Ga;Object.defineProperty(e,"AwaitQueue",{enumerable:!0,get:function(){return t.AwaitQueue}});var r=In;Object.defineProperty(e,"AwaitQueueStoppedError",{enumerable:!0,get:function(){return r.AwaitQueueStoppedError}}),Object.defineProperty(e,"AwaitQueueRemovedTaskError",{enumerable:!0,get:function(){return r.AwaitQueueRemovedTaskError}})})(Em);var oo={};Object.defineProperty(oo,"__esModule",{value:!0});oo.Producer=void 0;const Vy=ye,Jp=Vt,ts=xe,Qt=new Vy.Logger("Producer");class Ky extends Jp.EnhancedEventEmitter{constructor({id:r,localId:n,rtpSender:s,track:i,rtpParameters:o,stopTracks:a,disableTrackOnPause:c,zeroRtpOnPause:l,appData:u}){super();g(this,"_id");g(this,"_localId");g(this,"_closed",!1);g(this,"_rtpSender");g(this,"_track");g(this,"_kind");g(this,"_rtpParameters");g(this,"_paused");g(this,"_maxSpatialLayer");g(this,"_stopTracks");g(this,"_disableTrackOnPause");g(this,"_zeroRtpOnPause");g(this,"_appData");g(this,"_observer",new Jp.EnhancedEventEmitter);Qt.debug("constructor()"),this._id=r,this._localId=n,this._rtpSender=s,this._track=i,this._kind=i.kind,this._rtpParameters=o,this._paused=c?!i.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=a,this._disableTrackOnPause=c,this._zeroRtpOnPause=l,this._appData=u??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(Qt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Qt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new ts.InvalidStateError("closed");return new Promise((r,n)=>{this.safeEmit("@getstats",r,n)})}pause(){if(Qt.debug("pause()"),this._closed){Qt.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((r,n)=>{this.safeEmit("@pause",r,n)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(Qt.debug("resume()"),this._closed){Qt.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((r,n)=>{this.safeEmit("@resume",r,n)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:r}){if(Qt.debug("replaceTrack() [track:%o]",r),this._closed){if(r&&this._stopTracks)try{r.stop()}catch{}throw new ts.InvalidStateError("closed")}else if(r&&r.readyState==="ended")throw new ts.InvalidStateError("track ended");if(r===this._track){Qt.debug("replaceTrack() | same track, ignored");return}await new Promise((n,s)=>{this.safeEmit("@replacetrack",r,n,s)}),this.destroyTrack(),this._track=r,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(r){if(this._closed)throw new ts.InvalidStateError("closed");if(this._kind!=="video")throw new ts.UnsupportedError("not a video Producer");if(typeof r!="number")throw new TypeError("invalid spatialLayer");r!==this._maxSpatialLayer&&(await new Promise((n,s)=>{this.safeEmit("@setmaxspatiallayer",r,n,s)}).catch(()=>{}),this._maxSpatialLayer=r)}async setRtpEncodingParameters(r){if(this._closed)throw new ts.InvalidStateError("closed");if(typeof r!="object")throw new TypeError("invalid params");await new Promise((n,s)=>{this.safeEmit("@setrtpencodingparameters",r,n,s)})}onTrackEnded(){Qt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}oo.Producer=Ky;var ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.Consumer=void 0;const Qy=ye,Zp=Vt,Wy=xe,Wt=new Qy.Logger("Consumer");class qy extends Zp.EnhancedEventEmitter{constructor({id:r,localId:n,producerId:s,rtpReceiver:i,track:o,rtpParameters:a,appData:c}){super();g(this,"_id");g(this,"_localId");g(this,"_producerId");g(this,"_closed",!1);g(this,"_rtpReceiver");g(this,"_track");g(this,"_rtpParameters");g(this,"_paused");g(this,"_appData");g(this,"_observer",new Zp.EnhancedEventEmitter);Wt.debug("constructor()"),this._id=r,this._localId=n,this._producerId=s,this._rtpReceiver=i,this._track=o,this._rtpParameters=a,this._paused=!o.enabled,this._appData=c??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(Wt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Wt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new Wy.InvalidStateError("closed");return new Promise((r,n)=>{this.safeEmit("@getstats",r,n)})}pause(){if(Wt.debug("pause()"),this._closed){Wt.error("pause() | Consumer closed");return}if(this._paused){Wt.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(Wt.debug("resume()"),this._closed){Wt.error("resume() | Consumer closed");return}if(!this._paused){Wt.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){Wt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}ao.Consumer=qy;var co={};Object.defineProperty(co,"__esModule",{value:!0});co.DataProducer=void 0;const Gy=ye,ef=Vt,Yy=xe,Rr=new Gy.Logger("DataProducer");class Xy extends ef.EnhancedEventEmitter{constructor({id:r,dataChannel:n,sctpStreamParameters:s,appData:i}){super();g(this,"_id");g(this,"_dataChannel");g(this,"_closed",!1);g(this,"_sctpStreamParameters");g(this,"_appData");g(this,"_observer",new ef.EnhancedEventEmitter);Rr.debug("constructor()"),this._id=r,this._dataChannel=n,this._sctpStreamParameters=s,this._appData=i??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(r){this._dataChannel.bufferedAmountLowThreshold=r}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(Rr.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Rr.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(r){if(Rr.debug("send()"),this._closed)throw new Yy.InvalidStateError("closed");this._dataChannel.send(r)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Rr.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",r=>{if(this._closed)return;let{error:n}=r;n||(n=new Error("unknown DataChannel error")),n.errorDetail==="sctp-failure"?Rr.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):Rr.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Rr.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||Rr.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}co.DataProducer=Xy;var lo={};Object.defineProperty(lo,"__esModule",{value:!0});lo.DataConsumer=void 0;const Jy=ye,tf=Vt,fn=new Jy.Logger("DataConsumer");class Zy extends tf.EnhancedEventEmitter{constructor({id:r,dataProducerId:n,dataChannel:s,sctpStreamParameters:i,appData:o}){super();g(this,"_id");g(this,"_dataProducerId");g(this,"_dataChannel");g(this,"_closed",!1);g(this,"_sctpStreamParameters");g(this,"_appData");g(this,"_observer",new tf.EnhancedEventEmitter);fn.debug("constructor()"),this._id=r,this._dataProducerId=n,this._dataChannel=s,this._sctpStreamParameters=i,this._appData=o??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(r){this._dataChannel.binaryType=r}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){this._closed||(fn.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(fn.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(fn.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",r=>{if(this._closed)return;let{error:n}=r;n||(n=new Error("unknown DataChannel error")),n.errorDetail==="sctp-failure"?fn.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):fn.error('DataChannel "error" event: %o',n),this.safeEmit("error",n)}),this._dataChannel.addEventListener("close",()=>{this._closed||(fn.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",r=>{this._closed||this.safeEmit("message",r.data)})}}lo.DataConsumer=Zy;Object.defineProperty(io,"__esModule",{value:!0});io.Transport=void 0;const ew=Em,tw=ye,rf=Vt,Oe=xe,qc=be,ui=ce,rw=oo,nw=ao,sw=co,iw=lo,De=new tw.Logger("Transport");class ow{constructor(t){g(this,"consumerOptions");g(this,"promise");g(this,"resolve");g(this,"reject");this.consumerOptions=t,this.promise=new Promise((r,n)=>{this.resolve=r,this.reject=n})}}let aw=class extends rf.EnhancedEventEmitter{constructor({direction:r,id:n,iceParameters:s,iceCandidates:i,dtlsParameters:o,sctpParameters:a,iceServers:c,iceTransportPolicy:l,additionalSettings:u,proprietaryConstraints:d,appData:p,handlerFactory:f,extendedRtpCapabilities:y,canProduceByKind:w}){super();g(this,"_id");g(this,"_closed",!1);g(this,"_direction");g(this,"_extendedRtpCapabilities");g(this,"_canProduceByKind");g(this,"_maxSctpMessageSize");g(this,"_handler");g(this,"_iceGatheringState","new");g(this,"_connectionState","new");g(this,"_appData");g(this,"_producers",new Map);g(this,"_consumers",new Map);g(this,"_dataProducers",new Map);g(this,"_dataConsumers",new Map);g(this,"_probatorConsumerCreated",!1);g(this,"_awaitQueue",new ew.AwaitQueue);g(this,"_pendingConsumerTasks",[]);g(this,"_consumerCreationInProgress",!1);g(this,"_pendingPauseConsumers",new Map);g(this,"_consumerPauseInProgress",!1);g(this,"_pendingResumeConsumers",new Map);g(this,"_consumerResumeInProgress",!1);g(this,"_pendingCloseConsumers",new Map);g(this,"_consumerCloseInProgress",!1);g(this,"_observer",new rf.EnhancedEventEmitter);De.debug("constructor() [id:%s, direction:%s]",n,r),this._id=n,this._direction=r,this._extendedRtpCapabilities=y,this._canProduceByKind=w,this._maxSctpMessageSize=a?a.maxMessageSize:null;const b=qc.clone(u)??{};delete b.iceServers,delete b.iceTransportPolicy,delete b.bundlePolicy,delete b.rtcpMuxPolicy,delete b.sdpSemantics,this._handler=f(),this._handler.run({direction:r,iceParameters:s,iceCandidates:i,dtlsParameters:o,sctpParameters:a,iceServers:c,iceTransportPolicy:l,additionalSettings:b,proprietaryConstraints:d,extendedRtpCapabilities:y}),this._appData=p??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(r){this._appData=r}get observer(){return this._observer}close(){if(!this._closed){De.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const r of this._producers.values())r.transportClosed();this._producers.clear();for(const r of this._consumers.values())r.transportClosed();this._consumers.clear();for(const r of this._dataProducers.values())r.transportClosed();this._dataProducers.clear();for(const r of this._dataConsumers.values())r.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new Oe.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:r}){if(De.debug("restartIce()"),this._closed)throw new Oe.InvalidStateError("closed");if(!r)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(r),"transport.restartIce()")}async updateIceServers({iceServers:r}={}){if(De.debug("updateIceServers()"),this._closed)throw new Oe.InvalidStateError("closed");if(!Array.isArray(r))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(r),"transport.updateIceServers()")}async produce({track:r,encodings:n,codecOptions:s,codec:i,stopTracks:o=!0,disableTrackOnPause:a=!0,zeroRtpOnPause:c=!1,onRtpSender:l,appData:u={}}={}){if(De.debug("produce() [track:%o]",r),this._closed)throw new Oe.InvalidStateError("closed");if(r){if(this._direction!=="send")throw new Oe.UnsupportedError("not a sending Transport");if(this._canProduceByKind[r.kind]){if(r.readyState==="ended")throw new Oe.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(u&&typeof u!="object")throw new TypeError("if given, appData must be an object")}else throw new Oe.UnsupportedError(`cannot produce ${r.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let d;if(n&&!Array.isArray(n))throw TypeError("encodings must be an array");n&&n.length===0?d=void 0:n&&(d=n.map(w=>{const b={active:!0};return w.active===!1&&(b.active=!1),typeof w.dtx=="boolean"&&(b.dtx=w.dtx),typeof w.scalabilityMode=="string"&&(b.scalabilityMode=w.scalabilityMode),typeof w.scaleResolutionDownBy=="number"&&(b.scaleResolutionDownBy=w.scaleResolutionDownBy),typeof w.maxBitrate=="number"&&(b.maxBitrate=w.maxBitrate),typeof w.maxFramerate=="number"&&(b.maxFramerate=w.maxFramerate),typeof w.adaptivePtime=="boolean"&&(b.adaptivePtime=w.adaptivePtime),typeof w.priority=="string"&&(b.priority=w.priority),typeof w.networkPriority=="string"&&(b.networkPriority=w.networkPriority),b}));const{localId:p,rtpParameters:f,rtpSender:y}=await this._handler.send({track:r,encodings:d,codecOptions:s,codec:i,onRtpSender:l});try{ui.validateRtpParameters(f);const{id:w}=await new Promise((m,v)=>{this.safeEmit("produce",{kind:r.kind,rtpParameters:f,appData:u},m,v)}),b=new rw.Producer({id:w,localId:p,rtpSender:y,track:r,rtpParameters:f,stopTracks:o,disableTrackOnPause:a,zeroRtpOnPause:c,appData:u});return this._producers.set(b.id,b),this.handleProducer(b),this._observer.safeEmit("newproducer",b),b}catch(w){throw this._handler.stopSending(p).catch(()=>{}),w}},"transport.produce()").catch(d=>{if(o)try{r.stop()}catch{}throw d})}async consume({id:r,producerId:n,kind:s,rtpParameters:i,streamId:o,onRtpReceiver:a,appData:c={}}){if(De.debug("consume()"),this._closed)throw new Oe.InvalidStateError("closed");if(this._direction!=="recv")throw new Oe.UnsupportedError("not a receiving Transport");if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing producerId");if(s!=="audio"&&s!=="video")throw new TypeError(`invalid kind '${s}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(c&&typeof c!="object")throw new TypeError("if given, appData must be an object");const l=qc.clone(i);if(!ui.canReceive(l,this._extendedRtpCapabilities))throw new Oe.UnsupportedError("cannot consume this Producer");const d=new ow({id:r,producerId:n,kind:s,rtpParameters:l,streamId:o,onRtpReceiver:a,appData:c});return this._pendingConsumerTasks.push(d),queueMicrotask(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),d.promise}async produceData({ordered:r=!0,maxPacketLifeTime:n,maxRetransmits:s,label:i="",protocol:o="",appData:a={}}={}){if(De.debug("produceData()"),this._closed)throw new Oe.InvalidStateError("closed");if(this._direction!=="send")throw new Oe.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new Oe.UnsupportedError("SCTP not enabled by remote Transport");return(n||s)&&(r=!1),this._awaitQueue.push(async()=>{const{dataChannel:c,sctpStreamParameters:l}=await this._handler.sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o});ui.validateSctpStreamParameters(l);const{id:u}=await new Promise((p,f)=>{this.safeEmit("producedata",{sctpStreamParameters:l,label:i,protocol:o,appData:a},p,f)}),d=new sw.DataProducer({id:u,dataChannel:c,sctpStreamParameters:l,appData:a});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d},"transport.produceData()")}async consumeData({id:r,dataProducerId:n,sctpStreamParameters:s,label:i="",protocol:o="",appData:a={}}){if(De.debug("consumeData()"),this._closed)throw new Oe.InvalidStateError("closed");if(this._direction!=="recv")throw new Oe.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object")}else throw new Oe.UnsupportedError("SCTP not enabled by remote Transport");const c=qc.clone(s);return ui.validateSctpStreamParameters(c),this._awaitQueue.push(async()=>{const{dataChannel:l}=await this._handler.receiveDataChannel({sctpStreamParameters:c,label:i,protocol:o}),u=new iw.DataConsumer({id:r,dataProducerId:n,dataChannel:l,sctpStreamParameters:c,appData:a});return this._dataConsumers.set(u.id,u),this.handleDataConsumer(u),this._observer.safeEmit("newdataconsumer",u),u},"transport.consumeData()")}createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){De.debug("createPendingConsumers() | there is no Consumer to be created");return}const r=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let n;const s=[];for(const i of r){const{id:o,kind:a,rtpParameters:c,streamId:l,onRtpReceiver:u}=i.consumerOptions;s.push({trackId:o,kind:a,rtpParameters:c,streamId:l,onRtpReceiver:u})}try{const i=await this._handler.receive(s);for(let o=0;o<i.length;++o){const a=r[o],c=i[o],{id:l,producerId:u,kind:d,rtpParameters:p,appData:f}=a.consumerOptions,{localId:y,rtpReceiver:w,track:b}=c,m=new nw.Consumer({id:l,localId:y,producerId:u,rtpReceiver:w,track:b,rtpParameters:p,appData:f});this._consumers.set(m.id,m),this.handleConsumer(m),!this._probatorConsumerCreated&&!n&&d==="video"&&(n=m),this._observer.safeEmit("newconsumer",m),a.resolve(m)}}catch(i){for(const o of r)o.reject(i)}if(n)try{const i=ui.generateProbatorRtpParameters(n.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:i}]),De.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(i){De.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",i)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){De.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const r=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const n=r.map(s=>s.localId);await this._handler.pauseReceiving(n)}catch(n){De.error("pausePendingConsumers() | failed to pause Consumers:",n)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){De.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const r=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const n=r.map(s=>s.localId);await this._handler.resumeReceiving(n)}catch(n){De.error("resumePendingConsumers() | failed to resume Consumers:",n)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){De.debug("closePendingConsumers() | there is no Consumer to be closed");return}const r=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(r.map(n=>n.localId))}catch(n){De.error("closePendingConsumers() | failed to close Consumers:",n)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const r=this._handler;r.on("@connect",({dtlsParameters:n},s,i)=>{if(this._closed){i(new Oe.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:n},s,i)}),r.on("@icegatheringstatechange",n=>{n!==this._iceGatheringState&&(De.debug("ICE gathering state changed to %s",n),this._iceGatheringState=n,this._closed||this.safeEmit("icegatheringstatechange",n))}),r.on("@icecandidateerror",n=>{De.warn(`ICE candidate error [url:${n.url}, localAddress:${n.address}, localPort:${n.port}]: ${n.errorCode} "${n.errorText}"`),this.safeEmit("icecandidateerror",n)}),r.on("@connectionstatechange",n=>{n!==this._connectionState&&(De.debug("connection state changed to %s",n),this._connectionState=n,this._closed||this.safeEmit("connectionstatechange",n))})}handleProducer(r){r.on("@close",()=>{this._producers.delete(r.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(r.localId),"producer @close event").catch(n=>De.warn("producer.close() failed:%o",n))}),r.on("@pause",(n,s)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(r.localId),"producer @pause event").then(n).catch(s)}),r.on("@resume",(n,s)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(r.localId),"producer @resume event").then(n).catch(s)}),r.on("@replacetrack",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(r.localId,n),"producer @replacetrack event").then(s).catch(i)}),r.on("@setmaxspatiallayer",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(r.localId,n),"producer @setmaxspatiallayer event").then(s).catch(i)}),r.on("@setrtpencodingparameters",(n,s,i)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(r.localId,n),"producer @setrtpencodingparameters event").then(s).catch(i)}),r.on("@getstats",(n,s)=>{if(this._closed)return s(new Oe.InvalidStateError("closed"));this._handler.getSenderStats(r.localId).then(n).catch(s)})}handleConsumer(r){r.on("@close",()=>{this._consumers.delete(r.id),this._pendingPauseConsumers.delete(r.id),this._pendingResumeConsumers.delete(r.id),!this._closed&&(this._pendingCloseConsumers.set(r.id,r),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),r.on("@pause",()=>{this._pendingResumeConsumers.has(r.id)&&this._pendingResumeConsumers.delete(r.id),this._pendingPauseConsumers.set(r.id,r),queueMicrotask(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),r.on("@resume",()=>{this._pendingPauseConsumers.has(r.id)&&this._pendingPauseConsumers.delete(r.id),this._pendingResumeConsumers.set(r.id,r),queueMicrotask(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),r.on("@getstats",(n,s)=>{if(this._closed)return s(new Oe.InvalidStateError("closed"));this._handler.getReceiverStats(r.localId).then(n).catch(s)})}handleDataProducer(r){r.on("@close",()=>{this._dataProducers.delete(r.id)})}handleDataConsumer(r){r.on("@close",()=>{this._dataConsumers.delete(r.id)})}};io.Transport=aw;var Xa={},Ce={},Dm={},Pm={exports:{}},nf=Pm.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=e.raddr!=null?" raddr %s rport %d":"%v%v",t+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(t+=" generation %d"),t+=e["network-id"]!=null?" network-id %d":"%v",t+=e["network-cost"]!=null?" network-cost %d":"%v",t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return e.attribute!=null&&(t+=" %s",e.value!=null&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=e.id!=null?"id=%s %s":"%v%s",t+=e.mediaClockValue!=null?"=%s":"",t+=e.rateNumerator!=null?" rate=%s":"",t+=e.rateDenominator!=null?"/%s":"",t}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(nf).forEach(function(e){var t=nf[e];t.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var Yd=Pm.exports;(function(e){var t=function(a){return String(Number(a))===a?Number(a):a},r=function(a,c,l,u){if(u&&!l)c[u]=t(a[1]);else for(var d=0;d<l.length;d+=1)a[d+1]!=null&&(c[l[d]]=t(a[d+1]))},n=function(a,c,l){var u=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:u&&!c[a.name]&&(c[a.name]={});var d=a.push?{}:u?c[a.name]:c;r(l.match(a.reg),d,a.names,a.name),a.push&&c[a.push].push(d)},s=Yd,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(a){var c={},l=[],u=c;return a.split(/(\r\n|\r|\n)/).filter(i).forEach(function(d){var p=d[0],f=d.slice(2);p==="m"&&(l.push({rtp:[],fmtp:[]}),u=l[l.length-1]);for(var y=0;y<(s[p]||[]).length;y+=1){var w=s[p][y];if(w.reg.test(f))return n(w,u,f)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=t(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};e.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(a){return a.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(t),u=0;u<l.length;u+=3)c.push({component:l[u],ip:l[u+1],port:l[u+2]});return c},e.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var u,d=!1;return l[0]!=="~"?u=t(l):(u=t(l.substring(1,l.length)),d=!0),{scid:u,paused:d}})})}})(Dm);var Gc=Yd,cw=/%[sdv%]/g,lw=function(e){var t=1,r=arguments,n=r.length;return e.replace(cw,function(s){if(t>=n)return s;var i=r[t];switch(t+=1,s){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},pi=function(e,t,r){var n=t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format,s=[e+"="+n];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?s.push(r[t.name][o]):s.push(r[t.names[i]])}else s.push(r[t.name]);return lw.apply(null,s)},dw=["v","o","s","i","u","e","p","c","b","t","r","z","a"],uw=["i","c","b","a"],pw=function(e,t){t=t||{},e.version==null&&(e.version=0),e.name==null&&(e.name=" "),e.media.forEach(function(i){i.payloads==null&&(i.payloads="")});var r=t.outerOrder||dw,n=t.innerOrder||uw,s=[];return r.forEach(function(i){Gc[i].forEach(function(o){o.name in e&&e[o.name]!=null?s.push(pi(i,o,e)):o.push in e&&e[o.push]!=null&&e[o.push].forEach(function(a){s.push(pi(i,o,a))})})}),e.media.forEach(function(i){s.push(pi("m",Gc.m[0],i)),n.forEach(function(o){Gc[o].forEach(function(a){a.name in i&&i[a.name]!=null?s.push(pi(o,a,i)):a.push in i&&i[a.push]!=null&&i[a.push].forEach(function(c){s.push(pi(o,a,c))})})})}),s.join(`\r
`)+`\r
`},Fn=Dm,fw=pw,hw=Yd;Ce.grammar=hw;Ce.write=fw;Ce.parse=Fn.parse;Ce.parseParams=Fn.parseParams;Ce.parseFmtpConfig=Fn.parseFmtpConfig;Ce.parsePayloads=Fn.parsePayloads;Ce.parseRemoteCandidates=Fn.parseRemoteCandidates;Ce.parseImageAttributes=Fn.parseImageAttributes;Ce.parseSimulcastStreamList=Fn.parseSimulcastStreamList;var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.extractRtpCapabilities=mw;nt.extractDtlsParameters=gw;nt.getCname=vw;nt.applyCodecParameters=_w;const xm=Ce;function mw({sdpObject:e}){const t=new Map,r=[];let n=!1,s=!1;for(const o of e.media){const a=o.type;switch(a){case"audio":{if(n)continue;n=!0;break}case"video":{if(s)continue;s=!0;break}default:continue}for(const c of o.rtp){const l={kind:a,mimeType:`${a}/${c.codec}`,preferredPayloadType:c.payload,clockRate:c.rate,channels:c.encoding,parameters:{},rtcpFeedback:[]};t.set(l.preferredPayloadType,l)}for(const c of o.fmtp??[]){const l=xm.parseParams(c.config),u=t.get(c.payload);u&&(l!=null&&l.hasOwnProperty("profile-level-id")&&(l["profile-level-id"]=String(l["profile-level-id"])),u.parameters=l)}for(const c of o.rtcpFb??[]){const l={type:c.type,parameter:c.subtype};if(l.parameter||delete l.parameter,c.payload!=="*"){const u=t.get(c.payload);if(!u)continue;u.rtcpFeedback.push(l)}else for(const u of t.values())u.kind===a&&!/.+\/rtx$/i.test(u.mimeType)&&u.rtcpFeedback.push(l)}for(const c of o.ext??[]){if(c["encrypt-uri"])continue;const l={kind:a,uri:c.uri,preferredId:c.value};r.push(l)}}return{codecs:Array.from(t.values()),headerExtensions:r}}function gw({sdpObject:e}){let t=e.setup,r=e.fingerprint;if(!t||!r){const i=(e.media??[]).find(o=>o.port!==0);i&&(t??(t=i.setup),r??(r=i.fingerprint))}if(t){if(!r)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let n;switch(t){case"active":{n="client";break}case"passive":{n="server";break}case"actpass":{n="auto";break}}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}}function vw({offerMediaObject:e}){const t=(e.ssrcs??[]).find(r=>r.attribute==="cname");return t?t.value:""}function _w({offerRtpParameters:e,answerMediaObject:t}){for(const r of e.codecs){const n=r.mimeType.toLowerCase();if(n!=="audio/opus"||!(t.rtp??[]).find(a=>a.payload===r.payloadType))continue;t.fmtp=t.fmtp??[];let i=t.fmtp.find(a=>a.payload===r.payloadType);i||(i={payload:r.payloadType,config:""},t.fmtp.push(i));const o=xm.parseParams(i.config);switch(n){case"audio/opus":{const a=r.parameters["sprop-stereo"];a!==void 0&&(o.stereo=Number(a)?1:0);break}}i.config="";for(const a of Object.keys(o))i.config&&(i.config+=";"),i.config+=`${a}=${o[a]}`}}var dr={};Object.defineProperty(dr,"__esModule",{value:!0});dr.getRtpEncodings=yw;dr.addLegacySimulcast=ww;function yw({offerMediaObject:e}){const t=new Set;for(const s of e.ssrcs??[]){const i=s.id;t.add(i)}if(t.size===0)throw new Error("no a=ssrc lines found");const r=new Map;for(const s of e.ssrcGroups??[]){if(s.semantics!=="FID")continue;let[i,o]=s.ssrcs.split(/\s+/);i=Number(i),o=Number(o),t.has(i)&&(t.delete(i),t.delete(o),r.set(i,o))}for(const s of t)r.set(s,null);const n=[];for(const[s,i]of r){const o={ssrc:s};i&&(o.rtx={ssrc:i}),n.push(o)}return n}function ww({offerMediaObject:e,numStreams:t}){if(t<=1)throw new TypeError("numStreams must be greater than 1");const r=(e.ssrcs??[]).find(d=>d.attribute==="msid");if(!r)throw new Error("a=ssrc line with msid information not found");const[n,s]=r.value.split(" "),i=Number(r.id);let o;(e.ssrcGroups??[]).some(d=>{if(d.semantics!=="FID")return!1;const p=d.ssrcs.split(/\s+/);return Number(p[0])===i?(o=Number(p[1]),!0):!1});const a=e.ssrcs.find(d=>d.attribute==="cname");if(!a)throw new Error("a=ssrc line with cname information not found");const c=a.value,l=[],u=[];for(let d=0;d<t;++d)l.push(i+d),o&&u.push(o+d);e.ssrcGroups=[],e.ssrcs=[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const d of l)e.ssrcs.push({id:d,attribute:"cname",value:c}),e.ssrcs.push({id:d,attribute:"msid",value:`${n} ${s}`});for(let d=0;d<u.length;++d){const p=l[d],f=u[d];e.ssrcs.push({id:f,attribute:"cname",value:c}),e.ssrcs.push({id:f,attribute:"msid",value:`${n} ${s}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${p} ${f}`})}}var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.addNackSupportForOpus=Sw;function Sw(e){var t;for(const r of e.codecs??[])(r.mimeType.toLowerCase()==="audio/opus"||r.mimeType.toLowerCase()==="audio/multiopus")&&!((t=r.rtcpFeedback)!=null&&t.some(n=>n.type==="nack"&&!n.parameter))&&(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.HandlerInterface=void 0;const Rw=Vt;class bw extends Rw.EnhancedEventEmitter{constructor(){super()}}Ke.HandlerInterface=bw;var ht={},Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.OfferMediaSection=Yr.AnswerMediaSection=Yr.MediaSection=void 0;const Cw=Ce,sf=be;class Xd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:s=!1}){g(this,"_mediaObject");g(this,"_planB");if(this._mediaObject={},this._planB=s,t&&this.setIceParameters(t),r){this._mediaObject.candidates=[];for(const i of r){const o={};o.component=1,o.foundation=i.foundation,o.ip=i.address??i.ip,o.port=i.port,o.priority=i.priority,o.transport=i.protocol,o.type=i.type,i.tcpType&&(o.tcptype=i.tcpType),this._mediaObject.candidates.push(o)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}n&&this.setDtlsRole(n.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(t){this._mediaObject.iceUfrag=t.usernameFragment,this._mediaObject.icePwd=t.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}Yr.MediaSection=Xd;class kw extends Xd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1,offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:u}){switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a.mid),this._mediaObject.type=a.type,this._mediaObject.protocol=a.protocol,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),a.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const d of l.codecs){const p={payload:d.payloadType,codec:$l(d),rate:d.clockRate};d.channels>1&&(p.encoding=d.channels),this._mediaObject.rtp.push(p);const f=sf.clone(d.parameters)??{};let y=sf.clone(d.rtcpFeedback)??[];if(u){const{opusStereo:b,opusFec:m,opusDtx:v,opusMaxPlaybackRate:h,opusMaxAverageBitrate:_,opusPtime:S,opusNack:R,videoGoogleStartBitrate:E,videoGoogleMaxBitrate:x,videoGoogleMinBitrate:C}=u,B=c.codecs.find(M=>M.payloadType===d.payloadType);switch(d.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{b!==void 0&&(B.parameters["sprop-stereo"]=b?1:0,f.stereo=b?1:0),m!==void 0&&(B.parameters.useinbandfec=m?1:0,f.useinbandfec=m?1:0),v!==void 0&&(B.parameters.usedtx=v?1:0,f.usedtx=v?1:0),h!==void 0&&(f.maxplaybackrate=h),_!==void 0&&(f.maxaveragebitrate=_),S!==void 0&&(B.parameters.ptime=S,f.ptime=S),R||(B.rtcpFeedback=B.rtcpFeedback.filter(M=>M.type!=="nack"||M.parameter),y=y.filter(M=>M.type!=="nack"||M.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{E!==void 0&&(f["x-google-start-bitrate"]=E),x!==void 0&&(f["x-google-max-bitrate"]=x),C!==void 0&&(f["x-google-min-bitrate"]=C);break}}}const w={payload:d.payloadType,config:""};for(const b of Object.keys(f))w.config&&(w.config+=";"),w.config+=`${b}=${f[b]}`;w.config&&this._mediaObject.fmtp.push(w);for(const b of y)this._mediaObject.rtcpFb.push({payload:d.payloadType,type:b.type,subtype:b.parameter})}this._mediaObject.payloads=l.codecs.map(d=>d.payloadType).join(" "),this._mediaObject.ext=[];for(const d of l.headerExtensions)(a.ext??[]).some(f=>f.uri===d.uri)&&this._mediaObject.ext.push({uri:d.uri,value:d.id});if(a.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),a.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:a.simulcast.list1},this._mediaObject.rids=[];for(const d of a.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}else if(a.simulcast_03){this._mediaObject.simulcast_03={value:a.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const d of a.rids??[])d.direction==="send"&&this._mediaObject.rids.push({id:d.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof a.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize):a.sctpmap&&(this._mediaObject.payloads=s.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize});break}}}setDtlsRole(t){switch(t){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(t){var i,o;if(!((i=this._mediaObject.simulcast)!=null&&i.list1))return;const r={};for(const a of t)a.rid&&(r[a.rid]=a);const n=this._mediaObject.simulcast.list1,s=Cw.parseSimulcastStreamList(n);for(const a of s)for(const c of a)c.paused=!((o=r[c.scid])!=null&&o.active);this._mediaObject.simulcast.list1=s.map(a=>a.map(c=>`${c.paused?"~":""}${c.scid}`).join(",")).join(";")}}Yr.AnswerMediaSection=kw;class Tw extends Xd{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1,mid:a,kind:c,offerRtpParameters:l,streamId:u,trackId:d,oldDataChannelSpec:p=!1}){var f;switch(super({iceParameters:t,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a),this._mediaObject.type=c,i?(this._mediaObject.connection={ip:i.ip,version:i.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=i.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},s?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),this._mediaObject.extmapAllowMixed="extmap-allow-mixed",c){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${u??"-"} ${d}`);for(const m of l.codecs){const v={payload:m.payloadType,codec:$l(m),rate:m.clockRate};m.channels>1&&(v.encoding=m.channels),this._mediaObject.rtp.push(v);const h={payload:m.payloadType,config:""};for(const _ of Object.keys(m.parameters))h.config&&(h.config+=";"),h.config+=`${_}=${m.parameters[_]}`;h.config&&this._mediaObject.fmtp.push(h);for(const _ of m.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:m.payloadType,type:_.type,subtype:_.parameter})}this._mediaObject.payloads=l.codecs.map(m=>m.payloadType).join(" "),this._mediaObject.ext=[];for(const m of l.headerExtensions)this._mediaObject.ext.push({uri:m.uri,value:m.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const y=l.encodings[0],w=y.ssrc,b=(f=y.rtx)==null?void 0:f.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:w,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:w,attribute:"msid",value:`${u??"-"} ${d}`}),b&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:b,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:b,attribute:"msid",value:`${u??"-"} ${d}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${w} ${b}`}));break}case"application":{p?(this._mediaObject.payloads=s.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=s.port,this._mediaObject.maxMessageSize=s.maxMessageSize);break}}}setDtlsRole(t){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:t,streamId:r,trackId:n}){var c;const s=t.encodings[0],i=s.ssrc,o=(c=s.rtx)==null?void 0:c.ssrc,a=this._mediaObject.payloads.split(" ");for(const l of t.codecs){if(a.includes(String(l.payloadType)))continue;const u={payload:l.payloadType,codec:$l(l),rate:l.clockRate};l.channels>1&&(u.encoding=l.channels),this._mediaObject.rtp.push(u);const d={payload:l.payloadType,config:""};for(const p of Object.keys(l.parameters))d.config&&(d.config+=";"),d.config+=`${p}=${l.parameters[p]}`;d.config&&this._mediaObject.fmtp.push(d);for(const p of l.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:l.payloadType,type:p.type,subtype:p.parameter})}this._mediaObject.payloads+=` ${t.codecs.filter(l=>!this._mediaObject.payloads.includes(l.payloadType)).map(l=>l.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),t.rtcp.cname&&this._mediaObject.ssrcs.push({id:i,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:i,attribute:"msid",value:`${r??"-"} ${n}`}),o&&(t.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:t.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:`${r??"-"} ${n}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${i} ${o}`}))}planBStopReceiving({offerRtpParameters:t}){var i;const r=t.encodings[0],n=r.ssrc,s=(i=r.rtx)==null?void 0:i.ssrc;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(o=>o.id!==n&&o.id!==s),s&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(o=>o.ssrcs!==`${n} ${s}`))}}Yr.OfferMediaSection=Tw;function $l(e){const r=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");return r[2]}Object.defineProperty(ht,"__esModule",{value:!0});ht.RemoteSdp=void 0;const Ew=Ce,Dw=ye,ko=Yr,To=new Dw.Logger("RemoteSdp");class Pw{constructor({iceParameters:t,iceCandidates:r,dtlsParameters:n,sctpParameters:s,plainRtpParameters:i,planB:o=!1}){g(this,"_iceParameters");g(this,"_iceCandidates");g(this,"_dtlsParameters");g(this,"_sctpParameters");g(this,"_plainRtpParameters");g(this,"_planB");g(this,"_mediaSections",[]);g(this,"_midToIndex",new Map);g(this,"_firstMid");g(this,"_sdpObject");if(this._iceParameters=t,this._iceCandidates=r,this._dtlsParameters=n,this._sctpParameters=s,this._plainRtpParameters=i,this._planB=o,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},t!=null&&t.iceLite&&(this._sdpObject.icelite="ice-lite"),n){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const a=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:n.fingerprints[a-1].algorithm,hash:n.fingerprints[a-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}i&&(this._sdpObject.origin.address=i.ip,this._sdpObject.origin.ipVer=i.ipVersion)}updateIceParameters(t){To.debug("updateIceParameters() [iceParameters:%o]",t),this._iceParameters=t,this._sdpObject.icelite=t.iceLite?"ice-lite":void 0;for(const r of this._mediaSections)r.setIceParameters(t)}updateDtlsRole(t){To.debug("updateDtlsRole() [role:%s]",t),this._dtlsParameters.role=t;for(const r of this._mediaSections)r.setDtlsRole(t)}setSessionExtmapAllowMixed(){To.debug("setSessionExtmapAllowMixed()"),this._sdpObject.extmapAllowMixed="extmap-allow-mixed"}getNextMediaSectionIdx(){for(let t=0;t<this._mediaSections.length;++t){const r=this._mediaSections[t];if(r.closed)return{idx:t,reuseMid:r.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:t,reuseMid:r,offerRtpParameters:n,answerRtpParameters:s,codecOptions:i}){const o=new ko.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:n,answerRtpParameters:s,codecOptions:i});r?this._replaceMediaSection(o,r):this._midToIndex.has(o.mid)?this._replaceMediaSection(o):this._addMediaSection(o)}receive({mid:t,kind:r,offerRtpParameters:n,streamId:s,trackId:i}){const o=this._midToIndex.get(t);let a;if(o!==void 0&&(a=this._mediaSections[o]),this.setSessionExtmapAllowMixed(),a)a.planBReceive({offerRtpParameters:n,streamId:s,trackId:i}),this._replaceMediaSection(a);else{a=new ko.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:t,kind:r,offerRtpParameters:n,streamId:s,trackId:i});const c=this._mediaSections.find(l=>l.closed);c?this._replaceMediaSection(a,c.mid):this._addMediaSection(a)}}pauseMediaSection(t){this._findMediaSection(t).pause()}resumeSendingMediaSection(t){this._findMediaSection(t).resume()}resumeReceivingMediaSection(t){this._findMediaSection(t).resume()}disableMediaSection(t){this._findMediaSection(t).disable()}closeMediaSection(t){const r=this._findMediaSection(t);return t===this._firstMid?(To.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",t),this.disableMediaSection(t),!1):(r.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(t,r){const n=this._findMediaSection(t);n.muxSimulcastStreams(r),this._replaceMediaSection(n)}planBStopReceiving({mid:t,offerRtpParameters:r}){const n=this._findMediaSection(t);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}sendSctpAssociation({offerMediaObject:t}){const r=new ko.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(r)}receiveSctpAssociation({oldDataChannelSpec:t=!1}={}){const r=new ko.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:t});this._addMediaSection(r)}getSdp(){return this._sdpObject.origin.sessionVersion++,Ew.write(this._sdpObject)}_addMediaSection(t){this._firstMid||(this._firstMid=t.mid),this._mediaSections.push(t),this._midToIndex.set(t.mid,this._mediaSections.length-1),this._sdpObject.media.push(t.getObject()),this._regenerateBundleMids()}_replaceMediaSection(t,r){if(typeof r=="string"){const n=this._midToIndex.get(r);if(n===void 0)throw new Error(`no media section found for reuseMid '${r}'`);const s=this._mediaSections[n];this._mediaSections[n]=t,this._midToIndex.delete(s.mid),this._midToIndex.set(t.mid,n),this._sdpObject.media[n]=t.getObject(),this._regenerateBundleMids()}else{const n=this._midToIndex.get(t.mid);if(n===void 0)throw new Error(`no media section found with mid '${t.mid}'`);this._mediaSections[n]=t,this._sdpObject.media[n]=t.getObject()}}_findMediaSection(t){const r=this._midToIndex.get(t);if(r===void 0)throw new Error(`no media section found with mid '${t}'`);return this._mediaSections[r]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(t=>!t.closed).map(t=>t.mid).join(" "))}}ht.RemoteSdp=Pw;var ur={};Object.defineProperty(ur,"__esModule",{value:!0});ur.parse=Lw;const xw=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function Lw(e){const t=xw.exec(e??"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}Object.defineProperty(Xa,"__esModule",{value:!0});Xa.Chrome111=void 0;const jr=Ce,Iw=ye,of=be,rs=ce,Eo=nt,af=dr,Mw=Ws,Ow=xe,Nw=Ke,Aw=ht,jw=ur,z=new Iw.Logger("Chrome111"),$w="Chrome111",cf={OS:1024,MIS:1024};class Jd extends Nw.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new Jd}get name(){return $w}close(){if(z.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){z.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=jr.parse(n.sdp),i=Eo.extractRtpCapabilities({sdpObject:s});return Mw.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return z.debug("getNativeSctpCapabilities()"),{numStreams:cf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),z.debug("run()"),this._direction=r,this._remoteSdp=new Aw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:rs.getSendingRtpParameters("audio",d),video:rs.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:rs.getSendingRemoteRtpParameters("audio",d),video:rs.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(z.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(r){this.assertNotClosed(),z.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),z.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});z.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){if(this.assertNotClosed(),this.assertSendDirection(),z.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1){let b=1;for(const m of n){const v=m.scalabilityMode?(0,jw.parse)(m.scalabilityMode).temporalLayers:3;v>b&&(b=v)}n.forEach((m,v)=>{m.rid=`r${v}`,m.scalabilityMode=`L1T${b}`})}const a=of.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=rs.reduceCodecs(a.codecs,i);const c=of.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=rs.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(u.sender);const d=await this._pc.createOffer();let p=jr.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p}),z.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const f=u.mid;a.mid=f,p=jr.parse(this._pc.localDescription.sdp);const y=p.media[l.idx];if(a.rtcp.cname=Eo.getCname({offerMediaObject:y}),!n)a.encodings=af.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const b=af.getRtpEncodings({offerMediaObject:y});Object.assign(b[0],n[0]),a.encodings=b}else a.encodings=n;this._remoteSdp.send({offerMediaObject:y,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return z.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(f,u),{localId:f,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),z.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();z.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),z.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();z.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),z.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();z.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?z.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):z.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),z.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();z.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),z.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();z.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};z.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%cf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=jr.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),z.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;z.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=jr.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Eo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:jr.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),z.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){z.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){z.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){z.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();z.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};z.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=jr.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=jr.parse(this._pc.localDescription.sdp));const s=Eo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Ow.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Xa.Chrome111=Jd;var Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});Ja.Chrome74=void 0;const qt=Ce,Fw=ye,lf=be,ns=ce,Do=nt,Yc=dr,zw=Ws,Bw=xe,Uw=Ke,Hw=ht,Vw=ur,j=new Fw.Logger("Chrome74"),Kw="Chrome74",df={OS:1024,MIS:1024};class Zd extends Uw.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new Zd}get name(){return Kw}close(){if(j.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){j.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=qt.parse(n.sdp),i=Do.extractRtpCapabilities({sdpObject:s});return zw.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return j.debug("getNativeSctpCapabilities()"),{numStreams:df}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){j.debug("run()"),this._direction=r,this._remoteSdp=new Hw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ns.getSendingRtpParameters("audio",d),video:ns.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ns.getSendingRemoteRtpParameters("audio",d),video:ns.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(j.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(r){this.assertNotClosed(),j.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),j.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});j.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();j.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),this.assertSendDirection(),j.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((m,v)=>{m.rid=`r${v}`});const o=lf.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=ns.reduceCodecs(o.codecs,i);const a=lf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=ns.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});let u=await this._pc.createOffer(),d=qt.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d});let f=!1;const y=(0,Vw.parse)((n??[{}])[0].scalabilityMode);n&&n.length===1&&y.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(j.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,d=qt.parse(u.sdp),p=d.media[c.idx],Yc.addLegacySimulcast({offerMediaObject:p,numStreams:y.spatialLayers}),u={type:"offer",sdp:qt.write(d)}),j.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u);const w=l.mid;if(o.mid=w,d=qt.parse(this._pc.localDescription.sdp),p=d.media[c.idx],o.rtcp.cname=Do.getCname({offerMediaObject:p}),!n)o.encodings=Yc.getRtpEncodings({offerMediaObject:p});else if(n.length===1){let m=Yc.getRtpEncodings({offerMediaObject:p});Object.assign(m[0],n[0]),f&&(m=[m[0]]),o.encodings=m}else o.encodings=n;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of o.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${y.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return j.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,l),{localId:w,rtpParameters:o,rtpSender:l.sender}}async stopSending(r){if(this.assertSendDirection(),j.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();j.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),j.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();j.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),j.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();j.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?j.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):j.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),j.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();j.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),j.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();j.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};j.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%df.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=qt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),j.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};j.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;j.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=qt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Do.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:qt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),j.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){j.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();j.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){j.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();j.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){j.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();j.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};j.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};j.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=qt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}j.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=qt.parse(this._pc.localDescription.sdp));const s=Do.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Bw.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ja.Chrome74=Zd;var Za={};Object.defineProperty(Za,"__esModule",{value:!0});Za.Chrome70=void 0;const bt=Ce,Qw=ye,uf=be,ss=ce,Po=nt,Xc=dr,Ww=Ke,qw=ht,Gw=ur,W=new Qw.Logger("Chrome70"),Yw="Chrome70",pf={OS:1024,MIS:1024};class eu extends Ww.HandlerInterface{constructor(){super();g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new eu}get name(){return Yw}close(){if(W.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){W.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=bt.parse(n.sdp);return Po.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return W.debug("getNativeSctpCapabilities()"),{numStreams:pf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){W.debug("run()"),this._direction=r,this._remoteSdp=new qw.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ss.getSendingRtpParameters("audio",d),video:ss.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ss.getSendingRemoteRtpParameters("audio",d),video:ss.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(W.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){W.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(W.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});W.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};W.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};W.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();W.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),W.debug("send() [kind:%s, track.id:%s]",r.kind,r.id);const o=uf.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=ss.reduceCodecs(o.codecs,i);const a=uf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=ss.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});let u=await this._pc.createOffer(),d=bt.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),n&&n.length>1&&(W.debug("send() | enabling legacy simulcast"),d=bt.parse(u.sdp),p=d.media[c.idx],Xc.addLegacySimulcast({offerMediaObject:p,numStreams:n.length}),u={type:"offer",sdp:bt.write(d)});let f=!1;const y=(0,Gw.parse)((n??[{}])[0].scalabilityMode);if(n&&n.length===1&&y.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(W.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,d=bt.parse(u.sdp),p=d.media[c.idx],Xc.addLegacySimulcast({offerMediaObject:p,numStreams:y.spatialLayers}),u={type:"offer",sdp:bt.write(d)}),W.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),n){W.debug("send() | applying given encodings");const m=l.sender.getParameters();for(let v=0;v<(m.encodings??[]).length;++v){const h=m.encodings[v],_=n[v];if(!_)break;m.encodings[v]=Object.assign(h,_)}await l.sender.setParameters(m)}const w=l.mid;if(o.mid=w,d=bt.parse(this._pc.localDescription.sdp),p=d.media[c.idx],o.rtcp.cname=Po.getCname({offerMediaObject:p}),o.encodings=Xc.getRtpEncodings({offerMediaObject:p}),n)for(let m=0;m<o.encodings.length;++m)n[m]&&Object.assign(o.encodings[m],n[m]);if(f&&(o.encodings=[o.encodings[0]]),o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of o.encodings)m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return W.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,l),{localId:w,rtpParameters:o,rtpSender:l.sender}}async stopSending(r){this.assertSendDirection(),W.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();W.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};W.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?W.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):W.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),W.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();W.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};W.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),W.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();W.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};W.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};W.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%pf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=bt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),W.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};W.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;W.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};W.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=bt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Po.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:bt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),W.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){W.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};W.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();W.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};W.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};W.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=bt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}W.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=bt.parse(this._pc.localDescription.sdp));const s=Po.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Za.Chrome70=eu;var ec={},zn={};Object.defineProperty(zn,"__esModule",{value:!0});zn.getRtpEncodings=Xw;zn.addLegacySimulcast=Jw;function Xw({offerMediaObject:e,track:t}){const r=new Set;for(const i of e.ssrcs??[]){if(i.attribute!=="msid")continue;if(i.value.split(" ")[1]===t.id){const a=i.id;r.add(a)}}if(r.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);const n=new Map;for(const i of e.ssrcGroups??[]){if(i.semantics!=="FID")continue;let[o,a]=i.ssrcs.split(/\s+/);o=Number(o),a=Number(a),r.has(o)&&(r.delete(o),r.delete(a),n.set(o,a))}for(const i of r)n.set(i,null);const s=[];for(const[i,o]of n){const a={ssrc:i};o&&(a.rtx={ssrc:o}),s.push(a)}return s}function Jw({offerMediaObject:e,track:t,numStreams:r}){if(r<=1)throw new TypeError("numStreams must be greater than 1");let n,s,i;if(!(e.ssrcs??[]).find(d=>d.attribute!=="msid"?!1:d.value.split(" ")[1]===t.id?(n=d.id,i=d.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${t.id}]`);(e.ssrcGroups??[]).some(d=>{if(d.semantics!=="FID")return!1;const p=d.ssrcs.split(/\s+/);return Number(p[0])===n?(s=Number(p[1]),!0):!1});const a=e.ssrcs.find(d=>d.attribute==="cname"&&d.id===n);if(!a)throw new Error(`a=ssrc line with cname information not found [track.id:${t.id}]`);const c=a.value,l=[],u=[];for(let d=0;d<r;++d)l.push(n+d),s&&u.push(s+d);e.ssrcGroups=e.ssrcGroups??[],e.ssrcs=e.ssrcs??[],e.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const d of l)e.ssrcs.push({id:d,attribute:"cname",value:c}),e.ssrcs.push({id:d,attribute:"msid",value:`${i} ${t.id}`});for(let d=0;d<u.length;++d){const p=l[d],f=u[d];e.ssrcs.push({id:f,attribute:"cname",value:c}),e.ssrcs.push({id:f,attribute:"msid",value:`${i} ${t.id}`}),e.ssrcGroups.push({semantics:"FID",ssrcs:`${p} ${f}`})}}Object.defineProperty(ec,"__esModule",{value:!0});ec.Chrome67=void 0;const Gt=Ce,Zw=ye,ff=be,is=ce,xo=nt,hf=zn,eS=Ke,tS=ht,Y=new Zw.Logger("Chrome67"),rS="Chrome67",mf={OS:1024,MIS:1024};class tu extends eS.HandlerInterface{constructor(){super();g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_sendStream",new MediaStream);g(this,"_mapSendLocalIdRtpSender",new Map);g(this,"_nextSendLocalId",0);g(this,"_mapRecvLocalIdInfo",new Map);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new tu}get name(){return rS}close(){if(Y.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){Y.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Gt.parse(n.sdp);return xo.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return Y.debug("getNativeSctpCapabilities()"),{numStreams:mf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){Y.debug("run()"),this._direction=r,this._remoteSdp=new tS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:is.getSendingRtpParameters("audio",d),video:is.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:is.getSendingRemoteRtpParameters("audio",d),video:is.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Y.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){Y.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(Y.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});Y.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Y.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),Y.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&Y.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream);let o=await this._pc.createOffer(),a=Gt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=ff.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=is.reduceCodecs(l.codecs);const u=ff.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=is.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(Y.debug("send() | enabling simulcast"),a=Gt.parse(o.sdp),c=a.media.find(y=>y.type==="video"),hf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Gt.write(a)}),Y.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Gt.parse(this._pc.localDescription.sdp),c=a.media.find(y=>y.type===r.kind),l.rtcp.cname=xo.getCname({offerMediaObject:c}),l.encodings=hf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let y=0;y<l.encodings.length;++y)n[y]&&Object.assign(l.encodings[y],n[y]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const y of l.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const f=this._pc.getSenders().find(y=>y.track===r);return this._mapSendLocalIdRtpSender.set(p,f),{localId:p,rtpParameters:l,rtpSender:f}}async stopSending(r){this.assertSendDirection(),Y.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(n),n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(r);const s=await this._pc.createOffer();Y.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){Y.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?Y.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Y.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.track;await s.replaceTrack(n),i&&this._sendStream.removeTrack(i),n&&this._sendStream.addTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),Y.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),Y.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");return n.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};Y.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%mf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Gt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),Y.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};Y.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;Y.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Gt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);xo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Gt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),Y.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=l,p=c,f=this._pc.getReceivers().find(y=>y.track&&y.track.id===d);if(!f)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(d,{mid:p,rtpParameters:u,rtpReceiver:f}),n.push({localId:d,track:f.track,rtpReceiver:f})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){Y.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();Y.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){this.assertRecvDirection();const{rtpReceiver:n}=this._mapRecvLocalIdInfo.get(r)??{};if(!n)throw new Error("associated RTCRtpReceiver not found");return n.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};Y.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};Y.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Gt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}Y.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Gt.parse(this._pc.localDescription.sdp));const s=xo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ec.Chrome67=tu;var tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.Chrome55=void 0;const Yt=Ce,nS=ye,fi=xe,gf=be,os=ce,Lo=nt,vf=zn,sS=Ke,iS=ht,re=new nS.Logger("Chrome55"),oS="Chrome55",_f={OS:1024,MIS:1024};class ru extends sS.HandlerInterface{constructor(){super();g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_sendStream",new MediaStream);g(this,"_mapSendLocalIdTrack",new Map);g(this,"_nextSendLocalId",0);g(this,"_mapRecvLocalIdInfo",new Map);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new ru}get name(){return oS}close(){if(re.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){re.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Yt.parse(n.sdp);return Lo.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return re.debug("getNativeSctpCapabilities()"),{numStreams:_f}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){re.debug("run()"),this._direction=r,this._remoteSdp=new iS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:os.getSendingRtpParameters("audio",d),video:os.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:os.getSendingRemoteRtpParameters("audio",d),video:os.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(re.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){re.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(re.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});re.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};re.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};re.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();re.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),re.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&re.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream);let o=await this._pc.createOffer(),a=Yt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=gf.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=os.reduceCodecs(l.codecs);const u=gf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=os.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(re.debug("send() | enabling simulcast"),a=Yt.parse(o.sdp),c=a.media.find(f=>f.type==="video"),vf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Yt.write(a)}),re.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Yt.parse(this._pc.localDescription.sdp),c=a.media.find(f=>f.type===r.kind),l.rtcp.cname=Lo.getCname({offerMediaObject:c}),l.encodings=vf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let f=0;f<l.encodings.length;++f)n[f]&&Object.assign(l.encodings[f],n[f]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of l.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};re.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,r),{localId:p,rtpParameters:l}}async stopSending(r){this.assertSendDirection(),re.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdTrack.get(r);if(!n)throw new Error("track not found");this._mapSendLocalIdTrack.delete(r),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();re.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){re.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};re.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){throw new fi.UnsupportedError("not implemented")}async setMaxSpatialLayer(r,n){throw new fi.UnsupportedError(" not implemented")}async setRtpEncodingParameters(r,n){throw new fi.UnsupportedError("not supported")}async getSenderStats(r){throw new fi.UnsupportedError("not implemented")}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};re.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%_f.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Yt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),re.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};re.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;re.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};re.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Yt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);Lo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Yt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),re.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=c,p=l,f=a.streamId??u.rtcp.cname,w=this._pc.getRemoteStreams().find(b=>b.id===f).getTrackById(p);if(!w)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:u}),n.push({localId:p,track:w})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){re.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};re.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();re.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){throw new fi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};re.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};re.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Yt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}re.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Yt.parse(this._pc.localDescription.sdp));const s=Lo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}tc.Chrome55=ru;var rc={};Object.defineProperty(rc,"__esModule",{value:!0});rc.Firefox120=void 0;const $r=Ce,aS=ye,yf=xe,wf=be,as=ce,Io=nt,Sf=dr,cS=Ke,lS=ht,dS=ur,H=new aS.Logger("Firefox120"),uS="Firefox120",Rf={OS:16,MIS:2048};class nu extends cS.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new nu}get name(){return uS}close(){if(H.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){H.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),n=document.createElement("canvas");n.getContext("2d");const i=n.captureStream().getVideoTracks()[0];try{r.addTransceiver("audio",{direction:"sendrecv"}),r.addTransceiver(i,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const o=await r.createOffer();try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}const a=$r.parse(o.sdp);return Io.extractRtpCapabilities({sdpObject:a})}catch(o){try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}throw o}}async getNativeSctpCapabilities(){return H.debug("getNativeSctpCapabilities()"),{numStreams:Rf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),H.debug("run()"),this._direction=r,this._remoteSdp=new lS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:as.getSendingRtpParameters("audio",d),video:as.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:as.getSendingRemoteRtpParameters("audio",d),video:as.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(H.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){throw this.assertNotClosed(),new yf.UnsupportedError("not supported")}async restartIce(r){if(this.assertNotClosed(),H.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});H.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();H.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),H.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((b,m)=>{b.rid=`r${m}`});const a=wf.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=as.reduceCodecs(a.codecs,i);const c=wf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=as.reduceCodecs(c.codecs,i);const l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(l.sender);const u=await this._pc.createOffer();let d=$r.parse(u.sdp);d.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d});const p=(0,dS.parse)((n??[{}])[0].scalabilityMode);H.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u);const f=l.mid;a.mid=f,d=$r.parse(this._pc.localDescription.sdp);const y=d.media[d.media.length-1];if(a.rtcp.cname=Io.getCname({offerMediaObject:y}),!n)a.encodings=Sf.getRtpEncodings({offerMediaObject:y});else if(n.length===1){const b=Sf.getRtpEncodings({offerMediaObject:y});Object.assign(b[0],n[0]),a.encodings=b}else a.encodings=n;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const b of a.encodings)b.scalabilityMode?b.scalabilityMode=`L1T${p.temporalLayers}`:b.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:y,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const w={type:"answer",sdp:this._remoteSdp.getSdp()};return H.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),await this._pc.setRemoteDescription(w),this._mapMidTransceiver.set(f,l),{localId:f,rtpParameters:a,rtpSender:l.sender}}async stopSending(r){if(this.assertSendDirection(),H.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated transceiver not found");n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid);const s=await this._pc.createOffer();H.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),H.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();H.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),H.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();H.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?H.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):H.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),H.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated transceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();H.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),H.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();H.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};H.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Rf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=$r.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),H.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};H.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;H.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=$r.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Io.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p}),o={type:"answer",sdp:$r.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),H.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){H.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();H.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){H.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();H.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){H.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();H.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};H.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};H.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=$r.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:f})}H.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=$r.parse(this._pc.localDescription.sdp));const s=Io.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new yf.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}rc.Firefox120=nu;var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.Firefox60=void 0;const Fr=Ce,pS=ye,bf=xe,Jc=be,cs=ce,Mo=nt,Cf=dr,fS=Ke,hS=ht,mS=ur,V=new pS.Logger("Firefox60"),gS="Firefox60",kf={OS:16,MIS:2048};class su extends fS.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new su}get name(){return gS}close(){if(V.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){V.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),n=document.createElement("canvas");n.getContext("2d");const i=n.captureStream().getVideoTracks()[0];try{r.addTransceiver("audio",{direction:"sendrecv"});const o=r.addTransceiver(i,{direction:"sendrecv"}),a=o.sender.getParameters(),c=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];a.encodings=c,await o.sender.setParameters(a);const l=await r.createOffer();try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}const u=Fr.parse(l.sdp);return Mo.extractRtpCapabilities({sdpObject:u})}catch(o){try{n.remove()}catch{}try{i.stop()}catch{}try{r.close()}catch{}throw o}}async getNativeSctpCapabilities(){return V.debug("getNativeSctpCapabilities()"),{numStreams:kf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),V.debug("run()"),this._direction=r,this._remoteSdp=new hS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:cs.getSendingRtpParameters("audio",d),video:cs.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:cs.getSendingRemoteRtpParameters("audio",d),video:cs.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(V.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){throw this.assertNotClosed(),new bf.UnsupportedError("not supported")}async restartIce(r){if(this.assertNotClosed(),V.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});V.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),this.assertSendDirection(),V.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&(n=Jc.clone(n),n.forEach((w,b)=>{w.rid=`r${b}`}),n.reverse());const o=Jc.clone(this._sendingRtpParametersByKind[r.kind]);o.codecs=cs.reduceCodecs(o.codecs,i);const a=Jc.clone(this._sendingRemoteRtpParametersByKind[r.kind]);a.codecs=cs.reduceCodecs(a.codecs,i);const c=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});if(n){const w=c.sender.getParameters();w.encodings=n,await c.sender.setParameters(w)}const l=await this._pc.createOffer();let u=Fr.parse(l.sdp);u.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed(),this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:u});const d=(0,mS.parse)((n??[{}])[0].scalabilityMode);V.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const p=c.mid;o.mid=p,u=Fr.parse(this._pc.localDescription.sdp);const f=u.media[u.media.length-1];if(o.rtcp.cname=Mo.getCname({offerMediaObject:f}),!n)o.encodings=Cf.getRtpEncodings({offerMediaObject:f});else if(n.length===1){const w=Cf.getRtpEncodings({offerMediaObject:f});Object.assign(w[0],n[0]),o.encodings=w}else o.encodings=n.reverse();if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const w of o.encodings)w.scalabilityMode?w.scalabilityMode=`L1T${d.temporalLayers}`:w.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,offerRtpParameters:o,answerRtpParameters:a,codecOptions:s});const y={type:"answer",sdp:this._remoteSdp.getSdp()};return V.debug("send() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),this._mapMidTransceiver.set(p,c),{localId:p,rtpParameters:o,rtpSender:c.sender}}async stopSending(r){if(this.assertSendDirection(),V.debug("stopSending() [localId:%s]",r),this._closed)return;const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated transceiver not found");n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid);const s=await this._pc.createOffer();V.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),V.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();V.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),V.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();V.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?V.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):V.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),V.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated transceiver not found");const i=s.sender.getParameters();n=i.encodings.length-1-n,i.encodings.forEach((c,l)=>{l>=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();V.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),V.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();V.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};V.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%kf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Fr.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),V.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;V.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=Fr.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Mo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p}),o={type:"answer",sdp:Fr.write(a)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:a}),V.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){V.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){V.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){V.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();V.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};V.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Fr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:f})}V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Fr.parse(this._pc.localDescription.sdp));const s=Mo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new bf.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}nc.Firefox60=su;var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.Safari12=void 0;const Xt=Ce,vS=ye,Tf=be,ls=ce,Oo=nt,Ef=dr,_S=Ws,yS=xe,wS=Ke,SS=ht,RS=ur,$=new vS.Logger("Safari12"),bS="Safari12",Df={OS:1024,MIS:1024};class iu extends wS.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new iu}get name(){return bS}close(){if($.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){$.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=Xt.parse(n.sdp),i=Oo.extractRtpCapabilities({sdpObject:s});return _S.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return $.debug("getNativeSctpCapabilities()"),{numStreams:Df}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),$.debug("run()"),this._direction=r,this._remoteSdp=new SS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:ls.getSendingRtpParameters("audio",d),video:ls.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ls.getSendingRemoteRtpParameters("audio",d),video:ls.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch($.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){this.assertNotClosed(),$.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),$.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});$.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),$.debug("send() [kind:%s, track.id:%s]",r.kind,r.id);const a=Tf.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=ls.reduceCodecs(a.codecs,i);const c=Tf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=ls.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]});o&&o(u.sender);let d=await this._pc.createOffer(),p=Xt.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let f;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});const y=(0,RS.parse)((n??[{}])[0].scalabilityMode);n&&n.length>1&&($.debug("send() | enabling legacy simulcast"),p=Xt.parse(d.sdp),f=p.media[l.idx],Ef.addLegacySimulcast({offerMediaObject:f,numStreams:n.length}),d={type:"offer",sdp:Xt.write(p)}),$.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const w=u.mid;if(a.mid=w,p=Xt.parse(this._pc.localDescription.sdp),f=p.media[l.idx],a.rtcp.cname=Oo.getCname({offerMediaObject:f}),a.encodings=Ef.getRtpEncodings({offerMediaObject:f}),n)for(let m=0;m<a.encodings.length;++m)n[m]&&Object.assign(a.encodings[m],n[m]);if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of a.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${y.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const b={type:"answer",sdp:this._remoteSdp.getSdp()};return $.debug("send() | calling pc.setRemoteDescription() [answer:%o]",b),await this._pc.setRemoteDescription(b),this._mapMidTransceiver.set(w,u),{localId:w,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),this._closed)return;$.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();$.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),$.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();$.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),$.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(r);const s=await this._pc.createOffer();$.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?$.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):$.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),$.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();$.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),$.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();$.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};$.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Df.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Xt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),$.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};$.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;$.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=Xt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);Oo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:Xt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),$.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver})}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){$.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){$.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){$.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();$.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};$.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Xt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}$.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Xt.parse(this._pc.localDescription.sdp));const s=Oo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new yS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}sc.Safari12=iu;var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.Safari11=void 0;const Jt=Ce,CS=ye,Pf=be,ds=ce,No=nt,xf=zn,kS=Ke,TS=ht,X=new CS.Logger("Safari11"),ES="Safari11",Lf={OS:1024,MIS:1024};class ou extends kS.HandlerInterface{constructor(){super();g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_sendStream",new MediaStream);g(this,"_mapSendLocalIdRtpSender",new Map);g(this,"_nextSendLocalId",0);g(this,"_mapRecvLocalIdInfo",new Map);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new ou}get name(){return ES}close(){if(X.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){X.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=Jt.parse(n.sdp);return No.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return X.debug("getNativeSctpCapabilities()"),{numStreams:Lf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){X.debug("run()"),this._direction=r,this._remoteSdp=new TS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:ds.getSendingRtpParameters("audio",d),video:ds.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ds.getSendingRemoteRtpParameters("audio",d),video:ds.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(X.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){X.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(X.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});X.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();X.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),X.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&X.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream);let o=await this._pc.createOffer(),a=Jt.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=Pf.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=ds.reduceCodecs(l.codecs);const u=Pf.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=ds.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(X.debug("send() | enabling simulcast"),a=Jt.parse(o.sdp),c=a.media.find(y=>y.type==="video"),xf.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:Jt.write(a)}),X.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=Jt.parse(this._pc.localDescription.sdp),c=a.media.find(y=>y.type===r.kind),l.rtcp.cname=No.getCname({offerMediaObject:c}),l.encodings=xf.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let y=0;y<l.encodings.length;++y)n[y]&&Object.assign(l.encodings[y],n[y]);if(l.encodings.length>1&&l.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const y of l.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const f=this._pc.getSenders().find(y=>y.track===r);return this._mapSendLocalIdRtpSender.set(p,f),{localId:p,rtpParameters:l,rtpSender:f}}async stopSending(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(r);const s=await this._pc.createOffer();X.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){X.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){this.assertSendDirection(),n?X.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):X.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.track;await s.replaceTrack(n),i&&this._sendStream.removeTrack(i),n&&this._sendStream.addTrack(n)}async setMaxSpatialLayer(r,n){this.assertSendDirection(),X.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){this.assertSendDirection(),X.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapSendLocalIdRtpSender.get(r);if(!s)throw new Error("associated RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){this.assertSendDirection();const n=this._mapSendLocalIdRtpSender.get(r);if(!n)throw new Error("associated RTCRtpSender not found");return n.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};X.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Lf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Jt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),X.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};X.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[];for(const a of r){const{trackId:c,kind:l,rtpParameters:u,streamId:d}=a;X.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:u,streamId:d??u.rtcp.cname,trackId:c})}const s={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",s),await this._pc.setRemoteDescription(s);let i=await this._pc.createAnswer();const o=Jt.parse(i.sdp);for(const a of r){const{kind:c,rtpParameters:l}=a,u=c,d=o.media.find(p=>String(p.mid)===u);No.applyCodecParameters({offerRtpParameters:l,answerMediaObject:d})}i={type:"answer",sdp:Jt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),X.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const a of r){const{kind:c,trackId:l,rtpParameters:u}=a,d=c,p=l,f=this._pc.getReceivers().find(y=>y.track&&y.track.id===p);if(!f)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:u,rtpReceiver:f}),n.push({localId:p,track:f.track,rtpReceiver:f})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){X.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();X.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertRecvDirection();const{rtpReceiver:n}=this._mapRecvLocalIdInfo.get(r)??{};if(!n)throw new Error("associated RTCRtpReceiver not found");return n.getStats()}async pauseReceiving(r){}async resumeReceiving(r){}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};X.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};X.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Jt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}X.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Jt.parse(this._pc.localDescription.sdp));const s=No.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ic.Safari11=ou;var oc={},ac={};Object.defineProperty(ac,"__esModule",{value:!0});ac.getCapabilities=DS;ac.mangleRtpParameters=PS;const Lm=be;function DS(){const e=RTCRtpReceiver.getCapabilities(),t=Lm.clone(e);for(const r of t.codecs??[]){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType??`${r.kind}/${r.name}`,r.parameters){const n=r.parameters;n.apt&&(n.apt=Number(n.apt)),n["packetization-mode"]&&(n["packetization-mode"]=Number(n["packetization-mode"]))}for(const n of r.rtcpFeedback??[])n.parameter||(n.parameter="")}return t}function PS(e){const t=Lm.clone(e);t.mid&&(t.muxId=t.mid,delete t.mid);for(const r of t.codecs)r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return t}Object.defineProperty(oc,"__esModule",{value:!0});oc.Edge11=void 0;const xS=ye,Zc=xe,Ao=be,el=ce,tl=ac,LS=Ke,ie=new xS.Logger("Edge11"),IS="Edge11";class au extends LS.HandlerInterface{constructor(){super();g(this,"_sendingRtpParametersByKind");g(this,"_remoteIceParameters");g(this,"_remoteIceCandidates");g(this,"_remoteDtlsParameters");g(this,"_iceGatherer");g(this,"_iceTransport");g(this,"_dtlsTransport");g(this,"_rtpSenders",new Map);g(this,"_rtpReceivers",new Map);g(this,"_nextSendLocalId",0);g(this,"_cname");g(this,"_transportReady",!1)}static createFactory(){return()=>new au}get name(){return IS}close(){ie.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const r of this._rtpSenders.values())try{r.stop()}catch{}for(const r of this._rtpReceivers.values())try{r.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return ie.debug("getNativeRtpCapabilities()"),tl.getCapabilities()}async getNativeSctpCapabilities(){return ie.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ie.debug("run()"),this._sendingRtpParametersByKind={audio:el.getSendingRtpParameters("audio",d),video:el.getSendingRtpParameters("video",d)},this._remoteIceParameters=n,this._remoteIceCandidates=s,this._remoteDtlsParameters=i,this._cname=`CNAME-${Ao.generateRandomNumber()}`,this.setIceGatherer({iceServers:a,iceTransportPolicy:c}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(r){throw new Zc.UnsupportedError("not supported")}async restartIce(r){if(ie.debug("restartIce()"),this._remoteIceParameters=r,!!this._transportReady){ie.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,r,"controlling");for(const n of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(n);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){ie.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),ie.debug("send() | calling new RTCRtpSender()");const o=new RTCRtpSender(r,this._dtlsTransport),a=Ao.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=el.reduceCodecs(a.codecs,i);const c=a.codecs.some(d=>/.+\/rtx$/i.test(d.mimeType));n||(n=[{}]);for(const d of n)d.ssrc=Ao.generateRandomNumber(),c&&(d.rtx={ssrc:Ao.generateRandomNumber()});a.encodings=n,a.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const l=tl.mangleRtpParameters(a);ie.debug("send() | calling rtpSender.send() [params:%o]",l),await o.send(l);const u=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(u,o),{localId:u,rtpParameters:a,rtpSender:o}}async stopSending(r){ie.debug("stopSending() [localId:%s]",r);const n=this._rtpSenders.get(r);if(!n)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(r);try{ie.debug("stopSending() | calling rtpSender.stop()"),n.stop()}catch(s){throw ie.warn("stopSending() | rtpSender.stop() failed:%o",s),s}}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){n?ie.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):ie.debug("replaceTrack() [localId:%s, no track]",r);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");s.setTrack(n)}async setMaxSpatialLayer(r,n){ie.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{a<=n?o.active=!0:o.active=!1}),await s.setParameters(i)}async setRtpEncodingParameters(r,n){ie.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._rtpSenders.get(r);if(!s)throw new Error("RTCRtpSender not found");const i=s.getParameters();i.encodings.forEach((o,a)=>{i.encodings[a]={...o,...n}}),await s.setParameters(i)}async getSenderStats(r){const n=this._rtpSenders.get(r);if(!n)throw new Error("RTCRtpSender not found");return n.getStats()}async sendDataChannel(r){throw new Zc.UnsupportedError("not implemented")}async receive(r){const n=[];for(const s of r){const{trackId:i,kind:o}=s;ie.debug("receive() [trackId:%s, kind:%s]",i,o)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const s of r){const{trackId:i,kind:o,rtpParameters:a}=s;ie.debug("receive() | calling new RTCRtpReceiver()");const c=new RTCRtpReceiver(this._dtlsTransport,o);c.addEventListener("error",d=>{ie.error('rtpReceiver "error" event [event:%o]',d)});const l=tl.mangleRtpParameters(a);ie.debug("receive() | calling rtpReceiver.receive() [params:%o]",l),await c.receive(l);const u=i;this._rtpReceivers.set(u,c),n.push({localId:u,track:c.track,rtpReceiver:c})}return n}async stopReceiving(r){for(const n of r){ie.debug("stopReceiving() [localId:%s]",n);const s=this._rtpReceivers.get(n);if(!s)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(n);try{ie.debug("stopReceiving() | calling rtpReceiver.stop()"),s.stop()}catch(i){ie.warn("stopReceiving() | rtpReceiver.stop() failed:%o",i)}}}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){const n=this._rtpReceivers.get(r);if(!n)throw new Error("RTCRtpReceiver not found");return n.getStats()}async receiveDataChannel(r){throw new Zc.UnsupportedError("not implemented")}setIceGatherer({iceServers:r,iceTransportPolicy:n}){const s=new RTCIceGatherer({iceServers:r??[],gatherPolicy:n??"all"});s.addEventListener("error",i=>{ie.error('iceGatherer "error" event [event:%o]',i)});try{s.gather()}catch(i){ie.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=s}setIceTransport(){const r=new RTCIceTransport(this._iceGatherer);r.addEventListener("statechange",()=>{switch(r.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),r.addEventListener("icestatechange",()=>{switch(r.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),r.addEventListener("candidatepairchange",n=>{ie.debug('iceTransport "candidatepairchange" event [pair:%o]',n.pair)}),this._iceTransport=r}setDtlsTransport(){const r=new RTCDtlsTransport(this._iceTransport);r.addEventListener("statechange",()=>{ie.debug('dtlsTransport "statechange" event [state:%s]',r.state)}),r.addEventListener("dtlsstatechange",()=>{ie.debug('dtlsTransport "dtlsstatechange" event [state:%s]',r.state),r.state==="closed"&&this.emit("@connectionstatechange","closed")}),r.addEventListener("error",n=>{ie.error('dtlsTransport "error" event [event:%o]',n)}),this._dtlsTransport=r}async setupTransport({localDtlsRole:r}){ie.debug("setupTransport()");const n=this._dtlsTransport.getLocalParameters();n.role=r,await new Promise((s,i)=>{this.safeEmit("@connect",{dtlsParameters:n},s,i)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const s of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(s);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(s=>s.algorithm==="sha-256"||s.algorithm==="sha-384"||s.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}oc.Edge11=au;var cc={};Object.defineProperty(cc,"__esModule",{value:!0});cc.ReactNativeUnifiedPlan=void 0;const Zt=Ce,MS=ye,If=be,us=ce,jo=nt,rl=dr,OS=Ws,NS=xe,AS=Ke,jS=ht,$S=ur,A=new MS.Logger("ReactNativeUnifiedPlan"),FS="ReactNativeUnifiedPlan",Mf={OS:1024,MIS:1024};class cu extends AS.HandlerInterface{constructor(){super();g(this,"_closed",!1);g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_mapMidTransceiver",new Map);g(this,"_sendStream",new MediaStream);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new cu}get name(){return FS}close(){if(A.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){A.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{r.addTransceiver("audio"),r.addTransceiver("video");const n=await r.createOffer();try{r.close()}catch{}const s=Zt.parse(n.sdp),i=jo.extractRtpCapabilities({sdpObject:s});return OS.addNackSupportForOpus(i),i}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return A.debug("getNativeSctpCapabilities()"),{numStreams:Mf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){this.assertNotClosed(),A.debug("run()"),this._direction=r,this._remoteSdp=new jS.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:us.getSendingRtpParameters("audio",d),video:us.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:us.getSendingRemoteRtpParameters("audio",d),video:us.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(A.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){this.assertNotClosed(),A.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(this.assertNotClosed(),A.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});A.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();A.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i,onRtpSender:o}){this.assertNotClosed(),this.assertSendDirection(),A.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),n&&n.length>1&&n.forEach((v,h)=>{v.rid=`r${h}`});const a=If.clone(this._sendingRtpParametersByKind[r.kind]);a.codecs=us.reduceCodecs(a.codecs,i);const c=If.clone(this._sendingRemoteRtpParametersByKind[r.kind]);c.codecs=us.reduceCodecs(c.codecs,i);const l=this._remoteSdp.getNextMediaSectionIdx(),u=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:n});o&&o(u.sender);let d=await this._pc.createOffer(),p=Zt.parse(d.sdp);p.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let f;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});let y=!1;const w=(0,$S.parse)((n??[{}])[0].scalabilityMode);n&&n.length===1&&w.spatialLayers>1&&a.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(A.debug("send() | enabling legacy simulcast for VP9 SVC"),y=!0,p=Zt.parse(d.sdp),f=p.media[l.idx],rl.addLegacySimulcast({offerMediaObject:f,numStreams:w.spatialLayers}),d={type:"offer",sdp:Zt.write(p)}),A.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);let b=u.mid??void 0;if(b||A.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),a.mid=b,p=Zt.parse(this._pc.localDescription.sdp),f=p.media[l.idx],a.rtcp.cname=jo.getCname({offerMediaObject:f}),!n)a.encodings=rl.getRtpEncodings({offerMediaObject:f});else if(n.length===1){let v=rl.getRtpEncodings({offerMediaObject:f});Object.assign(v[0],n[0]),y&&(v=[v[0]]),a.encodings=v}else a.encodings=n;if(a.encodings.length>1&&(a.codecs[0].mimeType.toLowerCase()==="video/vp8"||a.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const v of a.encodings)v.scalabilityMode?v.scalabilityMode=`L1T${w.temporalLayers}`:v.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,reuseMid:l.reuseMid,offerRtpParameters:a,answerRtpParameters:c,codecOptions:s});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return A.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),b||(b=u.mid,a.mid=b),this._mapMidTransceiver.set(b,u),{localId:b,rtpParameters:a,rtpSender:u.sender}}async stopSending(r){if(this.assertSendDirection(),this._closed)return;A.debug("stopSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch{}const i=await this._pc.createOffer();A.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const o={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o),this._mapMidTransceiver.delete(r)}async pauseSending(r){this.assertNotClosed(),this.assertSendDirection(),A.debug("pauseSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="inactive",this._remoteSdp.pauseMediaSection(r);const s=await this._pc.createOffer();A.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(r){this.assertNotClosed(),this.assertSendDirection(),A.debug("resumeSending() [localId:%s]",r);const n=this._mapMidTransceiver.get(r);if(this._remoteSdp.resumeSendingMediaSection(r),!n)throw new Error("associated RTCRtpTransceiver not found");n.direction="sendonly";const s=await this._pc.createOffer();A.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const i={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(r,n){this.assertNotClosed(),this.assertSendDirection(),n?A.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):A.debug("replaceTrack() [localId:%s, no track]",r);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");await s.sender.replaceTrack(n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),this.assertSendDirection(),A.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{l<=n?c.active=!0:c.active=!1}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();A.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),this.assertSendDirection(),A.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n);const s=this._mapMidTransceiver.get(r);if(!s)throw new Error("associated RTCRtpTransceiver not found");const i=s.sender.getParameters();i.encodings.forEach((c,l)=>{i.encodings[l]={...c,...n}}),await s.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(r,i.encodings);const o=await this._pc.createOffer();A.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o);const a={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",a),await this._pc.setRemoteDescription(a)}async getSenderStats(r){this.assertNotClosed(),this.assertSendDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.sender.getStats()}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,protocol:o};A.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Mf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=Zt.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),A.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};A.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertNotClosed(),this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d,streamId:p}=c;A.debug("receive() [trackId:%s, kind:%s]",l,u);const f=d.mid??String(this._mapMidTransceiver.size);s.set(l,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const c of r){const{trackId:l,onRtpReceiver:u}=c;if(u){const d=s.get(l),p=this._pc.getTransceivers().find(f=>f.mid===d);if(!p)throw new Error("transceiver not found");u(p.receiver)}}let o=await this._pc.createAnswer();const a=Zt.parse(o.sdp);for(const c of r){const{trackId:l,rtpParameters:u}=c,d=s.get(l),p=a.media.find(f=>String(f.mid)===d);jo.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:Zt.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),A.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{trackId:l}=c,u=s.get(l),d=this._pc.getTransceivers().find(p=>p.mid===u);if(d)this._mapMidTransceiver.set(u,d),n.push({localId:u,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return n}async stopReceiving(r){if(this.assertRecvDirection(),this._closed)return;for(const i of r){A.debug("stopReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(o.mid)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();A.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const i of r)this._mapMidTransceiver.delete(i)}async pauseReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){A.debug("pauseReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();A.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async resumeReceiving(r){this.assertNotClosed(),this.assertRecvDirection();for(const i of r){A.debug("resumeReceiving() [localId:%s]",i);const o=this._mapMidTransceiver.get(i);if(!o)throw new Error("associated RTCRtpTransceiver not found");o.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const n={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();A.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async getReceiverStats(r){this.assertNotClosed(),this.assertRecvDirection();const n=this._mapMidTransceiver.get(r);if(!n)throw new Error("associated RTCRtpTransceiver not found");return n.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c,protocol:s};A.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};A.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=Zt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}A.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=Zt.parse(this._pc.localDescription.sdp));const s=jo.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new NS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}cc.ReactNativeUnifiedPlan=cu;var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.ReactNative=void 0;const er=Ce,zS=ye,hi=xe,nl=be,ps=ce,$o=nt,Of=zn,BS=Ke,US=ht,ee=new zS.Logger("ReactNative"),HS="ReactNative",Nf={OS:1024,MIS:1024};class lu extends BS.HandlerInterface{constructor(){super();g(this,"_direction");g(this,"_remoteSdp");g(this,"_sendingRtpParametersByKind");g(this,"_sendingRemoteRtpParametersByKind");g(this,"_forcedLocalDtlsRole");g(this,"_pc");g(this,"_sendStream",new MediaStream);g(this,"_mapSendLocalIdTrack",new Map);g(this,"_nextSendLocalId",0);g(this,"_mapRecvLocalIdInfo",new Map);g(this,"_hasDataChannelMediaSection",!1);g(this,"_nextSendSctpStreamId",0);g(this,"_transportReady",!1)}static createFactory(){return()=>new lu}get name(){return HS}close(){if(ee.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){ee.debug("getNativeRtpCapabilities()");const r=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const n=await r.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{r.close()}catch{}const s=er.parse(n.sdp);return $o.extractRtpCapabilities({sdpObject:s})}catch(n){try{r.close()}catch{}throw n}}async getNativeSctpCapabilities(){return ee.debug("getNativeSctpCapabilities()"),{numStreams:Nf}}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,extendedRtpCapabilities:d}){ee.debug("run()"),this._direction=r,this._remoteSdp=new US.RemoteSdp({iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:ps.getSendingRtpParameters("audio",d),video:ps.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:ps.getSendingRemoteRtpParameters("audio",d),video:ps.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:a??[],iceTransportPolicy:c??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...l},u),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.addEventListener("icecandidateerror",p=>{this.emit("@icecandidateerror",p)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(ee.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(r){ee.debug("updateIceServers()");const n=this._pc.getConfiguration();n.iceServers=r,this._pc.setConfiguration(n)}async restartIce(r){if(ee.debug("restartIce()"),this._remoteSdp.updateIceParameters(r),!!this._transportReady)if(this._direction==="send"){const n=await this._pc.createOffer({iceRestart:!0});ee.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const s={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s)}else{const n={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ee.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}}async getTransportStats(){return this._pc.getStats()}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertSendDirection(),ee.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),i&&ee.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream);let o=await this._pc.createOffer(),a=er.parse(o.sdp);a.extmapAllowMixed&&this._remoteSdp.setSessionExtmapAllowMixed();let c;const l=nl.clone(this._sendingRtpParametersByKind[r.kind]);l.codecs=ps.reduceCodecs(l.codecs);const u=nl.clone(this._sendingRemoteRtpParametersByKind[r.kind]);if(u.codecs=ps.reduceCodecs(u.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),r.kind==="video"&&n&&n.length>1&&(ee.debug("send() | enabling simulcast"),a=er.parse(o.sdp),c=a.media.find(f=>f.type==="video"),Of.addLegacySimulcast({offerMediaObject:c,track:r,numStreams:n.length}),o={type:"offer",sdp:er.write(a)}),ee.debug("send() | calling pc.setLocalDescription() [offer:%o]",o),await this._pc.setLocalDescription(o),a=er.parse(this._pc.localDescription.sdp),c=a.media.find(f=>f.type===r.kind),l.rtcp.cname=$o.getCname({offerMediaObject:c}),l.encodings=Of.getRtpEncodings({offerMediaObject:c,track:r}),n)for(let f=0;f<l.encodings.length;++f)n[f]&&Object.assign(l.encodings[f],n[f]);if(l.encodings.length>1&&(l.codecs[0].mimeType.toLowerCase()==="video/vp8"||l.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const f of l.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:c,offerRtpParameters:l,answerRtpParameters:u,codecOptions:s});const d={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,r),{localId:p,rtpParameters:l}}async stopSending(r){this.assertSendDirection(),ee.debug("stopSending() [localId:%s]",r);const n=this._mapSendLocalIdTrack.get(r);if(!n)throw new Error("track not found");this._mapSendLocalIdTrack.delete(r),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream);const s=await this._pc.createOffer();ee.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",s);try{await this._pc.setLocalDescription(s)}catch(o){if(this._sendStream.getTracks().length===0){ee.warn("stopSending() | ignoring expected error due no sending tracks: %s",o.toString());return}throw o}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(r){}async resumeSending(r){}async replaceTrack(r,n){throw new hi.UnsupportedError("not implemented")}async setMaxSpatialLayer(r,n){throw new hi.UnsupportedError("not implemented")}async setRtpEncodingParameters(r,n){throw new hi.UnsupportedError("not implemented")}async getSenderStats(r){throw new hi.UnsupportedError("not implemented")}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertSendDirection();const a={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:s,protocol:o};ee.debug("sendDataChannel() [options:%o]",a);const c=this._pc.createDataChannel(i,a);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Nf.MIS,!this._hasDataChannelMediaSection){const u=await this._pc.createOffer(),d=er.parse(u.sdp),p=d.media.find(y=>y.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),ee.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),await this._pc.setLocalDescription(u),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const f={type:"answer",sdp:this._remoteSdp.getSdp()};ee.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._hasDataChannelMediaSection=!0}const l={streamId:a.id,ordered:a.ordered,maxPacketLifeTime:a.maxPacketLifeTime,maxRetransmits:a.maxRetransmits};return{dataChannel:c,sctpStreamParameters:l}}async receive(r){this.assertRecvDirection();const n=[],s=new Map;for(const c of r){const{trackId:l,kind:u,rtpParameters:d}=c;ee.debug("receive() [trackId:%s, kind:%s]",l,u);const p=u;let f=c.streamId??d.rtcp.cname;ee.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),f+=`-hack-${nl.generateRandomNumber()}`,s.set(l,f),this._remoteSdp.receive({mid:p,kind:u,offerRtpParameters:d,streamId:f,trackId:l})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let o=await this._pc.createAnswer();const a=er.parse(o.sdp);for(const c of r){const{kind:l,rtpParameters:u}=c,d=l,p=a.media.find(f=>String(f.mid)===d);$o.applyCodecParameters({offerRtpParameters:u,answerMediaObject:p})}o={type:"answer",sdp:er.write(a)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:a}),ee.debug("receive() | calling pc.setLocalDescription() [answer:%o]",o),await this._pc.setLocalDescription(o);for(const c of r){const{kind:l,trackId:u,rtpParameters:d}=c,p=u,f=l,y=s.get(u),b=this._pc.getRemoteStreams().find(m=>m.id===y).getTrackById(p);if(!b)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:f,rtpParameters:d}),n.push({localId:p,track:b})}return n}async stopReceiving(r){this.assertRecvDirection();for(const i of r){ee.debug("stopReceiving() [localId:%s]",i);const{mid:o,rtpParameters:a}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);const s=await this._pc.createAnswer();ee.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s)}async pauseReceiving(r){}async resumeReceiving(r){}async getReceiverStats(r){throw new hi.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){this.assertRecvDirection();const{streamId:i,ordered:o,maxPacketLifeTime:a,maxRetransmits:c}=r,l={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:a,maxRetransmitTime:a,maxRetransmits:c,protocol:s};ee.debug("receiveDataChannel() [options:%o]",l);const u=this._pc.createDataChannel(n,l);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};ee.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const f=er.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:f})}ee.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:u}}async setupTransport({localDtlsRole:r,localSdpObject:n}){n||(n=er.parse(this._pc.localDescription.sdp));const s=$o.extractDtlsParameters({sdpObject:n});s.role=r,this._remoteSdp.updateDtlsRole(r==="client"?"server":"client"),await new Promise((i,o)=>{this.safeEmit("@connect",{dtlsParameters:s},i,o)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}lc.ReactNative=lu;Object.defineProperty($n,"__esModule",{value:!0});$n.Device=void 0;$n.detectDeviceAsync=Mm;$n.detectDevice=Om;const Im=V_,VS=ye,KS=Vt,hn=xe,Af=be,zr=ce,QS=io,WS=Xa,qS=Ja,GS=Za,YS=ec,XS=tc,JS=rc,ZS=nc,e0=sc,t0=ic,r0=oc,n0=cc,s0=lc,Le=new VS.Logger("Device");async function Mm(e){Le.debug("detectDeviceAsync() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=await(0,Im.UAParser)(e).withFeatureCheck();return Nm(t)}function Om(e){Le.debug("detectDevice() [userAgent:%s]",e),!e&&typeof navigator=="object"&&(e=navigator.userAgent);const t=(0,Im.UAParser)(e);return Nm(t)}class du{constructor({handlerName:t,handlerFactory:r}={}){g(this,"_handlerFactory");g(this,"_handlerName");g(this,"_loaded",!1);g(this,"_extendedRtpCapabilities");g(this,"_recvRtpCapabilities");g(this,"_canProduceByKind");g(this,"_sctpCapabilities");g(this,"_observer",new KS.EnhancedEventEmitter);if(Le.debug("constructor()"),t&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(t)Le.debug("constructor() | handler given: %s",t);else if(t=Om(),t)Le.debug("constructor() | detected handler: %s",t);else throw new hn.UnsupportedError("device not supported");switch(t){case"Chrome111":{this._handlerFactory=WS.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=qS.Chrome74.createFactory();break}case"Chrome70":{this._handlerFactory=GS.Chrome70.createFactory();break}case"Chrome67":{this._handlerFactory=YS.Chrome67.createFactory();break}case"Chrome55":{this._handlerFactory=XS.Chrome55.createFactory();break}case"Firefox120":{this._handlerFactory=JS.Firefox120.createFactory();break}case"Firefox60":{this._handlerFactory=ZS.Firefox60.createFactory();break}case"Safari12":{this._handlerFactory=e0.Safari12.createFactory();break}case"Safari11":{this._handlerFactory=t0.Safari11.createFactory();break}case"Edge11":{this._handlerFactory=r0.Edge11.createFactory();break}case"ReactNativeUnifiedPlan":{this._handlerFactory=n0.ReactNativeUnifiedPlan.createFactory();break}case"ReactNative":{this._handlerFactory=s0.ReactNative.createFactory();break}default:throw new TypeError(`unknown handlerName "${t}"`)}}const n=this._handlerFactory();this._handlerName=n.name,n.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}static async factory({handlerName:t,handlerFactory:r}={}){if(Le.debug("factory()"),t&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(!t&&!r&&(t=await Mm(),!t))throw new hn.UnsupportedError("device not supported");return new du({handlerName:t,handlerFactory:r})}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new hn.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new hn.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:t,preferLocalCodecsOrder:r=!1}){Le.debug("load() [routerRtpCapabilities:%o]",t);let n;try{if(this._loaded)throw new hn.InvalidStateError("already loaded");const s=Af.clone(t);zr.validateRtpCapabilities(s),n=this._handlerFactory();const i=await n.getNativeRtpCapabilities();Le.debug("load() | got native RTP capabilities:%o",i);const o=Af.clone(i);zr.validateRtpCapabilities(o),this._extendedRtpCapabilities=zr.getExtendedRtpCapabilities(o,s,r),Le.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=zr.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=zr.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=zr.getRecvRtpCapabilities(this._extendedRtpCapabilities),zr.validateRtpCapabilities(this._recvRtpCapabilities),Le.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await n.getNativeSctpCapabilities(),Le.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),zr.validateSctpCapabilities(this._sctpCapabilities),Le.debug("load() succeeded"),this._loaded=!0,n.close()}catch(s){throw n&&n.close(),s}}canProduce(t){if(this._loaded){if(t!=="audio"&&t!=="video")throw new TypeError(`invalid kind "${t}"`)}else throw new hn.InvalidStateError("not loaded");return this._canProduceByKind[t]}createSendTransport({id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u}){return Le.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u})}createRecvTransport({id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u}){return Le.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:s,sctpParameters:i,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:u})}createTransport({direction:t,id:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:d}){if(this._loaded){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="object")throw new TypeError("missing iceParameters");if(Array.isArray(s)){if(typeof i!="object")throw new TypeError("missing dtlsParameters");if(o&&typeof o!="object")throw new TypeError("wrong sctpParameters");if(d&&typeof d!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new hn.InvalidStateError("not loaded");const p=new QS.Transport({direction:t,id:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u,appData:d,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",p),p}}$n.Device=du;function Nm(e){var t,r,n,s;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(Le.debug("detectDeviceImpl() | React-Native detected"),typeof RTCPeerConnection>"u"){Le.warn("detectDeviceImpl() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(Le.debug("detectDeviceImpl() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(Le.debug("detectDeviceImpl() | ReactNative PlanB handler chosen"),"ReactNative")}else{Le.debug("detectDeviceImpl() | browser detected [userAgent:%s, parsed:%o]",e.ua,e);const i=e.browser,o=(t=i.name)==null?void 0:t.toLowerCase(),a=parseInt(i.major??"0"),l=(r=e.engine.name)==null?void 0:r.toLowerCase(),u=e.os,d=(n=u.name)==null?void 0:n.toLowerCase(),p=parseFloat(u.version??"0"),y=(s=e.device.model)==null?void 0:s.toLowerCase(),w=d==="ios"||y==="ipad",b=o&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(o),m=o&&["firefox","mobile firefox","mobile focus"].includes(o),v=o&&["safari","mobile safari"].includes(o),h=o&&["edge"].includes(o);if((b||h)&&!w&&a>=111)return"Chrome111";if(b&&!w&&a>=74||h&&!w&&a>=88)return"Chrome74";if(b&&!w&&a>=70)return"Chrome70";if(b&&!w&&a>=67)return"Chrome67";if(b&&!w&&a>=55)return"Chrome55";if(m&&!w&&a>=120)return"Firefox120";if(m&&!w&&a>=60)return"Firefox60";if(m&&w&&p>=14.3)return"Safari12";if(v&&a>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(v&&a>=11)return"Safari11";if(h&&!w&&a>=11&&a<=18)return"Edge11";if(l==="webkit"&&w&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(l==="blink"){const _=e.ua.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(_){const S=Number(_[1]);return S>=111?"Chrome111":S>=74?"Chrome74":S>=70?"Chrome70":S>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{Le.warn("detectDeviceImpl() | browser not supported [name:%s, version:%s]",o,a);return}}}var Am={};Object.defineProperty(Am,"__esModule",{value:!0});var jm={};Object.defineProperty(jm,"__esModule",{value:!0});(function(e){var t=vn&&vn.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=vn&&vn.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&t(s,n,i)};Object.defineProperty(e,"__esModule",{value:!0}),r($n,e),r(io,e),r(oo,e),r(ao,e),r(co,e),r(lo,e),r(Am,e),r(jm,e),r(Ke,e),r(xe,e)})(hm);var dc={},uc={},$m={},uu={};Object.defineProperty(uu,"__esModule",{value:!0});uu.default="ffffffff-ffff-ffff-ffff-ffffffffffff";var pu={};Object.defineProperty(pu,"__esModule",{value:!0});pu.default="00000000-0000-0000-0000-000000000000";var qs={},Gs={},fu={};Object.defineProperty(fu,"__esModule",{value:!0});fu.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;Object.defineProperty(Gs,"__esModule",{value:!0});const i0=fu;function o0(e){return typeof e=="string"&&i0.default.test(e)}Gs.default=o0;Object.defineProperty(qs,"__esModule",{value:!0});const a0=Gs;function c0(e){if(!(0,a0.default)(e))throw TypeError("Invalid UUID");let t;return Uint8Array.of((t=parseInt(e.slice(0,8),16))>>>24,t>>>16&255,t>>>8&255,t&255,(t=parseInt(e.slice(9,13),16))>>>8,t&255,(t=parseInt(e.slice(14,18),16))>>>8,t&255,(t=parseInt(e.slice(19,23),16))>>>8,t&255,(t=parseInt(e.slice(24,36),16))/1099511627776&255,t/4294967296&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255)}qs.default=c0;var It={};Object.defineProperty(It,"__esModule",{value:!0});It.unsafeStringify=void 0;const l0=Gs,ze=[];for(let e=0;e<256;++e)ze.push((e+256).toString(16).slice(1));function Fm(e,t=0){return(ze[e[t+0]]+ze[e[t+1]]+ze[e[t+2]]+ze[e[t+3]]+"-"+ze[e[t+4]]+ze[e[t+5]]+"-"+ze[e[t+6]]+ze[e[t+7]]+"-"+ze[e[t+8]]+ze[e[t+9]]+"-"+ze[e[t+10]]+ze[e[t+11]]+ze[e[t+12]]+ze[e[t+13]]+ze[e[t+14]]+ze[e[t+15]]).toLowerCase()}It.unsafeStringify=Fm;function d0(e,t=0){const r=Fm(e,t);if(!(0,l0.default)(r))throw TypeError("Stringified UUID is invalid");return r}It.default=d0;var Ys={},uo={};Object.defineProperty(uo,"__esModule",{value:!0});let sl;const u0=new Uint8Array(16);function p0(){if(!sl){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");sl=crypto.getRandomValues.bind(crypto)}return sl(u0)}uo.default=p0;Object.defineProperty(Ys,"__esModule",{value:!0});Ys.updateV1State=void 0;const jf=uo,f0=It,mi={};function h0(e,t,r){var i;let n;const s=(e==null?void 0:e._v6)??!1;if(e){const o=Object.keys(e);o.length===1&&o[0]==="_v6"&&(e=void 0)}if(e)n=$f(e.random??((i=e.rng)==null?void 0:i.call(e))??(0,jf.default)(),e.msecs,e.nsecs,e.clockseq,e.node,t,r);else{const o=Date.now(),a=(0,jf.default)();zm(mi,o,a),n=$f(a,mi.msecs,mi.nsecs,s?void 0:mi.clockseq,s?void 0:mi.node,t,r)}return t??(0,f0.unsafeStringify)(n)}function zm(e,t,r){return e.msecs??(e.msecs=-1/0),e.nsecs??(e.nsecs=0),t===e.msecs?(e.nsecs++,e.nsecs>=1e4&&(e.node=void 0,e.nsecs=0)):t>e.msecs?e.nsecs=0:t<e.msecs&&(e.node=void 0),e.node||(e.node=r.slice(10,16),e.node[0]|=1,e.clockseq=(r[8]<<8|r[9])&16383),e.msecs=t,e}Ys.updateV1State=zm;function $f(e,t,r,n,s,i,o=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),o=0;else if(o<0||o+16>i.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);t??(t=Date.now()),r??(r=0),n??(n=(e[8]<<8|e[9])&16383),s??(s=e.slice(10,16)),t+=122192928e5;const a=((t&268435455)*1e4+r)%4294967296;i[o++]=a>>>24&255,i[o++]=a>>>16&255,i[o++]=a>>>8&255,i[o++]=a&255;const c=t/4294967296*1e4&268435455;i[o++]=c>>>8&255,i[o++]=c&255,i[o++]=c>>>24&15|16,i[o++]=c>>>16&255,i[o++]=n>>>8|128,i[o++]=n&255;for(let l=0;l<6;++l)i[o++]=s[l];return i}Ys.default=h0;var pc={};Object.defineProperty(pc,"__esModule",{value:!0});const m0=qs,g0=It;function v0(e){const t=typeof e=="string"?(0,m0.default)(e):e,r=_0(t);return typeof e=="string"?(0,g0.unsafeStringify)(r):r}pc.default=v0;function _0(e){return Uint8Array.of((e[6]&15)<<4|e[7]>>4&15,(e[7]&15)<<4|(e[4]&240)>>4,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,(e[1]&15)<<4|(e[2]&240)>>4,96|e[2]&15,e[3],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var Bm={},hu={};Object.defineProperty(hu,"__esModule",{value:!0});function y0(e){const t=R0(e),r=S0(t,e.length*8);return w0(r)}function w0(e){const t=new Uint8Array(e.length*4);for(let r=0;r<e.length*4;r++)t[r]=e[r>>2]>>>r%4*8&255;return t}function Um(e){return(e+64>>>9<<4)+14+1}function S0(e,t){const r=new Uint32Array(Um(t)).fill(0);r.set(e),r[t>>5]|=128<<t%32,r[r.length-1]=t,e=r;let n=1732584193,s=-271733879,i=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const c=n,l=s,u=i,d=o;n=We(n,s,i,o,e[a],7,-680876936),o=We(o,n,s,i,e[a+1],12,-389564586),i=We(i,o,n,s,e[a+2],17,606105819),s=We(s,i,o,n,e[a+3],22,-1044525330),n=We(n,s,i,o,e[a+4],7,-176418897),o=We(o,n,s,i,e[a+5],12,1200080426),i=We(i,o,n,s,e[a+6],17,-1473231341),s=We(s,i,o,n,e[a+7],22,-45705983),n=We(n,s,i,o,e[a+8],7,1770035416),o=We(o,n,s,i,e[a+9],12,-1958414417),i=We(i,o,n,s,e[a+10],17,-42063),s=We(s,i,o,n,e[a+11],22,-1990404162),n=We(n,s,i,o,e[a+12],7,1804603682),o=We(o,n,s,i,e[a+13],12,-40341101),i=We(i,o,n,s,e[a+14],17,-1502002290),s=We(s,i,o,n,e[a+15],22,1236535329),n=qe(n,s,i,o,e[a+1],5,-165796510),o=qe(o,n,s,i,e[a+6],9,-1069501632),i=qe(i,o,n,s,e[a+11],14,643717713),s=qe(s,i,o,n,e[a],20,-373897302),n=qe(n,s,i,o,e[a+5],5,-701558691),o=qe(o,n,s,i,e[a+10],9,38016083),i=qe(i,o,n,s,e[a+15],14,-660478335),s=qe(s,i,o,n,e[a+4],20,-405537848),n=qe(n,s,i,o,e[a+9],5,568446438),o=qe(o,n,s,i,e[a+14],9,-1019803690),i=qe(i,o,n,s,e[a+3],14,-187363961),s=qe(s,i,o,n,e[a+8],20,1163531501),n=qe(n,s,i,o,e[a+13],5,-1444681467),o=qe(o,n,s,i,e[a+2],9,-51403784),i=qe(i,o,n,s,e[a+7],14,1735328473),s=qe(s,i,o,n,e[a+12],20,-1926607734),n=Ge(n,s,i,o,e[a+5],4,-378558),o=Ge(o,n,s,i,e[a+8],11,-2022574463),i=Ge(i,o,n,s,e[a+11],16,1839030562),s=Ge(s,i,o,n,e[a+14],23,-35309556),n=Ge(n,s,i,o,e[a+1],4,-1530992060),o=Ge(o,n,s,i,e[a+4],11,1272893353),i=Ge(i,o,n,s,e[a+7],16,-155497632),s=Ge(s,i,o,n,e[a+10],23,-1094730640),n=Ge(n,s,i,o,e[a+13],4,681279174),o=Ge(o,n,s,i,e[a],11,-358537222),i=Ge(i,o,n,s,e[a+3],16,-722521979),s=Ge(s,i,o,n,e[a+6],23,76029189),n=Ge(n,s,i,o,e[a+9],4,-640364487),o=Ge(o,n,s,i,e[a+12],11,-421815835),i=Ge(i,o,n,s,e[a+15],16,530742520),s=Ge(s,i,o,n,e[a+2],23,-995338651),n=Ye(n,s,i,o,e[a],6,-198630844),o=Ye(o,n,s,i,e[a+7],10,1126891415),i=Ye(i,o,n,s,e[a+14],15,-1416354905),s=Ye(s,i,o,n,e[a+5],21,-57434055),n=Ye(n,s,i,o,e[a+12],6,1700485571),o=Ye(o,n,s,i,e[a+3],10,-1894986606),i=Ye(i,o,n,s,e[a+10],15,-1051523),s=Ye(s,i,o,n,e[a+1],21,-2054922799),n=Ye(n,s,i,o,e[a+8],6,1873313359),o=Ye(o,n,s,i,e[a+15],10,-30611744),i=Ye(i,o,n,s,e[a+6],15,-1560198380),s=Ye(s,i,o,n,e[a+13],21,1309151649),n=Ye(n,s,i,o,e[a+4],6,-145523070),o=Ye(o,n,s,i,e[a+11],10,-1120210379),i=Ye(i,o,n,s,e[a+2],15,718787259),s=Ye(s,i,o,n,e[a+9],21,-343485551),n=Wr(n,c),s=Wr(s,l),i=Wr(i,u),o=Wr(o,d)}return Uint32Array.of(n,s,i,o)}function R0(e){if(e.length===0)return new Uint32Array;const t=new Uint32Array(Um(e.length*8)).fill(0);for(let r=0;r<e.length;r++)t[r>>2]|=(e[r]&255)<<r%4*8;return t}function Wr(e,t){const r=(e&65535)+(t&65535);return(e>>16)+(t>>16)+(r>>16)<<16|r&65535}function b0(e,t){return e<<t|e>>>32-t}function fc(e,t,r,n,s,i){return Wr(b0(Wr(Wr(t,e),Wr(n,i)),s),r)}function We(e,t,r,n,s,i,o){return fc(t&r|~t&n,e,t,s,i,o)}function qe(e,t,r,n,s,i,o){return fc(t&n|r&~n,e,t,s,i,o)}function Ge(e,t,r,n,s,i,o){return fc(t^r^n,e,t,s,i,o)}function Ye(e,t,r,n,s,i,o){return fc(r^(t|~n),e,t,s,i,o)}hu.default=y0;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});Dt.URL=Dt.DNS=Dt.stringToBytes=void 0;const Ff=qs,C0=It;function Hm(e){e=unescape(encodeURIComponent(e));const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return t}Dt.stringToBytes=Hm;Dt.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Dt.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function k0(e,t,r,n,s,i){const o=typeof r=="string"?Hm(r):r,a=typeof n=="string"?(0,Ff.default)(n):n;if(typeof n=="string"&&(n=(0,Ff.default)(n)),(n==null?void 0:n.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+o.length);if(c.set(a),c.set(o,a.length),c=t(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){i=i||0;for(let l=0;l<16;++l)s[i+l]=c[l];return s}return(0,C0.unsafeStringify)(c)}Dt.default=k0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=hu,r=Dt;var n=Dt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return n.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return n.URL}});function s(i,o,a,c){return(0,r.default)(48,t.default,i,o,a,c)}s.DNS=r.DNS,s.URL=r.URL,e.default=s})(Bm);var mu={},gu={};Object.defineProperty(gu,"__esModule",{value:!0});const T0=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);gu.default={randomUUID:T0};Object.defineProperty(mu,"__esModule",{value:!0});const zf=gu,E0=uo,D0=It;function P0(e,t,r){var s;if(zf.default.randomUUID&&!t&&!e)return zf.default.randomUUID();e=e||{};const n=e.random??((s=e.rng)==null?void 0:s.call(e))??(0,E0.default)();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let i=0;i<16;++i)t[r+i]=n[i];return t}return(0,D0.unsafeStringify)(n)}mu.default=P0;var Vm={},vu={};Object.defineProperty(vu,"__esModule",{value:!0});function x0(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function il(e,t){return e<<t|e>>>32-t}function L0(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520],n=new Uint8Array(e.length+1);n.set(e),n[e.length]=128,e=n;const s=e.length/4+2,i=Math.ceil(s/16),o=new Array(i);for(let a=0;a<i;++a){const c=new Uint32Array(16);for(let l=0;l<16;++l)c[l]=e[a*64+l*4]<<24|e[a*64+l*4+1]<<16|e[a*64+l*4+2]<<8|e[a*64+l*4+3];o[a]=c}o[i-1][14]=(e.length-1)*8/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=(e.length-1)*8&4294967295;for(let a=0;a<i;++a){const c=new Uint32Array(80);for(let y=0;y<16;++y)c[y]=o[a][y];for(let y=16;y<80;++y)c[y]=il(c[y-3]^c[y-8]^c[y-14]^c[y-16],1);let l=r[0],u=r[1],d=r[2],p=r[3],f=r[4];for(let y=0;y<80;++y){const w=Math.floor(y/20),b=il(l,5)+x0(w,u,d,p)+f+t[w]+c[y]>>>0;f=p,p=d,d=il(u,30)>>>0,u=l,l=b}r[0]=r[0]+l>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+d>>>0,r[3]=r[3]+p>>>0,r[4]=r[4]+f>>>0}return Uint8Array.of(r[0]>>24,r[0]>>16,r[0]>>8,r[0],r[1]>>24,r[1]>>16,r[1]>>8,r[1],r[2]>>24,r[2]>>16,r[2]>>8,r[2],r[3]>>24,r[3]>>16,r[3]>>8,r[3],r[4]>>24,r[4]>>16,r[4]>>8,r[4])}vu.default=L0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0;const t=vu,r=Dt;var n=Dt;Object.defineProperty(e,"DNS",{enumerable:!0,get:function(){return n.DNS}}),Object.defineProperty(e,"URL",{enumerable:!0,get:function(){return n.URL}});function s(i,o,a,c){return(0,r.default)(80,t.default,i,o,a,c)}s.DNS=r.DNS,s.URL=r.URL,e.default=s})(Vm);var _u={};Object.defineProperty(_u,"__esModule",{value:!0});const I0=It,M0=Ys,O0=pc;function N0(e,t,r){e??(e={}),r??(r=0);let n=(0,M0.default)({...e,_v6:!0},new Uint8Array(16));if(n=(0,O0.default)(n),t){for(let s=0;s<16;s++)t[r+s]=n[s];return t}return(0,I0.unsafeStringify)(n)}_u.default=N0;var yu={};Object.defineProperty(yu,"__esModule",{value:!0});const A0=qs,j0=It;function $0(e){const t=typeof e=="string"?(0,A0.default)(e):e,r=F0(t);return typeof e=="string"?(0,j0.unsafeStringify)(r):r}yu.default=$0;function F0(e){return Uint8Array.of((e[3]&15)<<4|e[4]>>4&15,(e[4]&15)<<4|(e[5]&240)>>4,(e[5]&15)<<4|e[6]&15,e[7],(e[1]&15)<<4|(e[2]&240)>>4,(e[2]&15)<<4|(e[3]&240)>>4,16|(e[0]&240)>>4,(e[0]&15)<<4|(e[1]&240)>>4,e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}var po={};Object.defineProperty(po,"__esModule",{value:!0});po.updateV7State=void 0;const Bf=uo,z0=It,ol={};function B0(e,t,r){var s;let n;if(e)n=Uf(e.random??((s=e.rng)==null?void 0:s.call(e))??(0,Bf.default)(),e.msecs,e.seq,t,r);else{const i=Date.now(),o=(0,Bf.default)();Km(ol,i,o),n=Uf(o,ol.msecs,ol.seq,t,r)}return t??(0,z0.unsafeStringify)(n)}function Km(e,t,r){return e.msecs??(e.msecs=-1/0),e.seq??(e.seq=0),t>e.msecs?(e.seq=r[6]<<23|r[7]<<16|r[8]<<8|r[9],e.msecs=t):(e.seq=e.seq+1|0,e.seq===0&&e.msecs++),e}po.updateV7State=Km;function Uf(e,t,r,n,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!n)n=new Uint8Array(16),s=0;else if(s<0||s+16>n.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`);return t??(t=Date.now()),r??(r=e[6]*127<<24|e[7]<<16|e[8]<<8|e[9]),n[s++]=t/1099511627776&255,n[s++]=t/4294967296&255,n[s++]=t/16777216&255,n[s++]=t/65536&255,n[s++]=t/256&255,n[s++]=t&255,n[s++]=112|r>>>28&15,n[s++]=r>>>20&255,n[s++]=128|r>>>14&63,n[s++]=r>>>6&255,n[s++]=r<<2&255|e[10]&3,n[s++]=e[11],n[s++]=e[12],n[s++]=e[13],n[s++]=e[14],n[s++]=e[15],n}po.default=B0;var wu={};Object.defineProperty(wu,"__esModule",{value:!0});const U0=Gs;function H0(e){if(!(0,U0.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}wu.default=H0;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.validate=e.v7=e.v6ToV1=e.v6=e.v5=e.v4=e.v3=e.v1ToV6=e.v1=e.stringify=e.parse=e.NIL=e.MAX=void 0;var t=uu;Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return t.default}});var r=pu;Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return r.default}});var n=qs;Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return n.default}});var s=It;Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return s.default}});var i=Ys;Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return i.default}});var o=pc;Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return o.default}});var a=Bm;Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return a.default}});var c=mu;Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return c.default}});var l=Vm;Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return l.default}});var u=_u;Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return u.default}});var d=yu;Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return d.default}});var p=po;Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return p.default}});var f=Gs;Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return f.default}});var y=wu;Object.defineProperty(e,"version",{enumerable:!0,get:function(){return y.default}})})($m);var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.FakeEventTarget=void 0;class V0{constructor(){g(this,"listeners",{})}addEventListener(t,r,n={}){var s;r&&((s=this.listeners)[t]??(s[t]=[]),this.listeners[t].push({callback:r,once:n.once===!0}))}removeEventListener(t,r){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter(n=>n.callback!==r))}dispatchEvent(t){if(!t||typeof t.type!="string")throw new Error("invalid event object");const r=this.listeners[t.type];if(!r)return!0;for(const n of[...r]){try{n.callback.call(this,t)}catch(s){setTimeout(()=>{throw s},0)}n.once&&this.removeEventListener(t.type,n.callback)}return!t.defaultPrevented}}hc.FakeEventTarget=V0;var Su={};Object.defineProperty(Su,"__esModule",{value:!0});Su.clone=K0;function K0(e){if(e!==void 0)return Number.isNaN(e)?NaN:typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e))}Object.defineProperty(uc,"__esModule",{value:!0});uc.FakeMediaStreamTrack=void 0;const Hf=$m,Q0=hc,Fo=Su;var no,Ns,As,nr,Qr,sr,Sn,js,Rn,$s,bn,Cn,kn,Tn,En,Dn;const _p=class _p extends Q0.FakeEventTarget{constructor({kind:r,id:n,label:s,contentHint:i,enabled:o,muted:a,readyState:c,capabilities:l,constraints:u,settings:d,data:p}){super();Fe(this,no);Fe(this,Ns);Fe(this,As);Fe(this,nr);Fe(this,Qr);Fe(this,sr);Fe(this,Sn);Fe(this,js);Fe(this,Rn);Fe(this,$s);Fe(this,bn);Fe(this,Cn,null);Fe(this,kn,null);Fe(this,Tn,null);Fe(this,En,null);Fe(this,Dn,null);me(this,no,n??(0,Hf.v4)()),me(this,Ns,r),me(this,As,s??""),me(this,Sn,i??""),me(this,Qr,o??!0),me(this,sr,a??!1),me(this,nr,c??"live"),me(this,js,l??{}),me(this,Rn,u??{}),me(this,$s,d??{}),me(this,bn,p??{})}get id(){return Q(this,no)}get kind(){return Q(this,Ns)}get label(){return Q(this,As)}get contentHint(){return Q(this,Sn)}set contentHint(r){me(this,Sn,r)}get enabled(){return Q(this,Qr)}set enabled(r){const n=Q(this,Qr)!==r;me(this,Qr,r),n&&this.dispatchEvent(new Event("enabledchange"))}get muted(){return Q(this,sr)}get readyState(){return Q(this,nr)}get data(){return Q(this,bn)}set data(r){me(this,bn,r)}get onmute(){return Q(this,Cn)}set onmute(r){Q(this,Cn)&&this.removeEventListener("mute",Q(this,Cn)),me(this,Cn,r),r&&this.addEventListener("mute",r)}get onunmute(){return Q(this,kn)}set onunmute(r){Q(this,kn)&&this.removeEventListener("unmute",Q(this,kn)),me(this,kn,r),r&&this.addEventListener("unmute",r)}get onended(){return Q(this,Tn)}set onended(r){Q(this,Tn)&&this.removeEventListener("ended",Q(this,Tn)),me(this,Tn,r),r&&this.addEventListener("ended",r)}get onenabledchange(){return Q(this,En)}set onenabledchange(r){Q(this,En)&&this.removeEventListener("enabledchange",Q(this,En)),me(this,En,r),r&&this.addEventListener("enabledchange",r)}get onstopped(){return Q(this,Dn)}set onstopped(r){Q(this,Dn)&&this.removeEventListener("stopped",Q(this,Dn)),me(this,Dn,r),r&&this.addEventListener("stopped",r)}addEventListener(r,n,s){super.addEventListener(r,n,s)}removeEventListener(r,n){super.removeEventListener(r,n)}stop(){Q(this,nr)!=="ended"&&(me(this,nr,"ended"),this.dispatchEvent(new Event("stopped")))}clone({id:r,data:n}={}){return new _p({id:r??(0,Hf.v4)(),kind:Q(this,Ns),label:Q(this,As),contentHint:Q(this,Sn),enabled:Q(this,Qr),muted:Q(this,sr),readyState:Q(this,nr),capabilities:(0,Fo.clone)(Q(this,js)),constraints:(0,Fo.clone)(Q(this,Rn)),settings:(0,Fo.clone)(Q(this,$s)),data:n??(0,Fo.clone)(Q(this,bn))})}getCapabilities(){return Q(this,js)}getConstraints(){return Q(this,Rn)}async applyConstraints(r={}){return me(this,Rn,r),Promise.resolve()}getSettings(){return Q(this,$s)}remoteStop(){Q(this,nr)!=="ended"&&(me(this,nr,"ended"),this.dispatchEvent(new Event("stopped")),this.dispatchEvent(new Event("ended")))}remoteMute(){Q(this,sr)||(me(this,sr,!0),this.dispatchEvent(new Event("mute")))}remoteUnmute(){Q(this,sr)&&(me(this,sr,!1),this.dispatchEvent(new Event("unmute")))}};no=new WeakMap,Ns=new WeakMap,As=new WeakMap,nr=new WeakMap,Qr=new WeakMap,sr=new WeakMap,Sn=new WeakMap,js=new WeakMap,Rn=new WeakMap,$s=new WeakMap,bn=new WeakMap,Cn=new WeakMap,kn=new WeakMap,Tn=new WeakMap,En=new WeakMap,Dn=new WeakMap;let Fl=_p;uc.FakeMediaStreamTrack=Fl;Object.defineProperty(dc,"__esModule",{value:!0});dc.FakeHandler=void 0;const W0=uc,q0=Vt,G0=ye,fs=be,Vf=ce,Y0=xe,X0=Ke,Xe=new G0.Logger("FakeHandler"),J0="FakeHandler";class Kf extends q0.EnhancedEventEmitter{constructor({id:r,ordered:n,maxPacketLifeTime:s,maxRetransmits:i,label:o,protocol:a}){super();g(this,"id");g(this,"ordered");g(this,"maxPacketLifeTime");g(this,"maxRetransmits");g(this,"label");g(this,"protocol");this.id=r,this.ordered=n,this.maxPacketLifeTime=s,this.maxRetransmits=i,this.label=o,this.protocol=a}close(){this.safeEmit("close"),this.emit("@close")}send(r){this.safeEmit("message",r)}addEventListener(r,n){this.on(r,n)}}class Ru extends X0.HandlerInterface{constructor(r){super();g(this,"_closed",!1);g(this,"fakeParameters");g(this,"_rtpParametersByKind");g(this,"_cname",`CNAME-${fs.generateRandomNumber()}`);g(this,"_transportReady",!1);g(this,"_nextLocalId",1);g(this,"_tracks",new Map);g(this,"_nextSctpStreamId",0);this.fakeParameters=r}static createFactory(r){return()=>new Ru(r)}get name(){return J0}close(){Xe.debug("close()"),!this._closed&&(this._closed=!0)}setIceGatheringState(r){this.emit("@icegatheringstatechange",r)}setConnectionState(r){this.emit("@connectionstatechange",r)}async getNativeRtpCapabilities(){return Xe.debug("getNativeRtpCapabilities()"),this.fakeParameters.generateNativeRtpCapabilities()}async getNativeSctpCapabilities(){return Xe.debug("getNativeSctpCapabilities()"),this.fakeParameters.generateNativeSctpCapabilities()}run({direction:r,iceParameters:n,iceCandidates:s,dtlsParameters:i,sctpParameters:o,iceServers:a,iceTransportPolicy:c,proprietaryConstraints:l,extendedRtpCapabilities:u}){this.assertNotClosed(),Xe.debug("run()"),this._rtpParametersByKind={audio:Vf.getSendingRtpParameters("audio",u),video:Vf.getSendingRtpParameters("video",u)}}async updateIceServers(r){this.assertNotClosed(),Xe.debug("updateIceServers()")}async restartIce(r){this.assertNotClosed(),Xe.debug("restartIce()")}async getTransportStats(){return this.assertNotClosed(),new Map}async send({track:r,encodings:n,codecOptions:s,codec:i}){this.assertNotClosed(),Xe.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"});const o=fs.clone(this._rtpParametersByKind[r.kind]),a=o.codecs.some(l=>/.+\/rtx$/i.test(l.mimeType));o.mid=`mid-${fs.generateRandomNumber()}`,n||(n=[{}]);for(const l of n)l.ssrc=fs.generateRandomNumber(),a&&(l.rtx={ssrc:fs.generateRandomNumber()});o.encodings=n,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const c=this._nextLocalId++;return this._tracks.set(c,r),{localId:String(c),rtpParameters:o}}async stopSending(r){if(Xe.debug("stopSending() [localId:%s]",r),!this._closed){if(!this._tracks.has(Number(r)))throw new Error("local track not found");this._tracks.delete(Number(r))}}async pauseSending(r){this.assertNotClosed()}async resumeSending(r){this.assertNotClosed()}async replaceTrack(r,n){this.assertNotClosed(),n?Xe.debug("replaceTrack() [localId:%s, track.id:%s]",r,n.id):Xe.debug("replaceTrack() [localId:%s, no track]",r),this._tracks.delete(Number(r)),this._tracks.set(Number(r),n)}async setMaxSpatialLayer(r,n){this.assertNotClosed(),Xe.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",r,n)}async setRtpEncodingParameters(r,n){this.assertNotClosed(),Xe.debug("setRtpEncodingParameters() [localId:%s, params:%o]",r,n)}async getSenderStats(r){return this.assertNotClosed(),new Map}async sendDataChannel({ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}){this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),Xe.debug("sendDataChannel()");const a=new Kf({id:this._nextSctpStreamId++,ordered:r,maxPacketLifeTime:n,maxRetransmits:s,label:i,protocol:o}),c={streamId:this._nextSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:s};return{dataChannel:a,sctpStreamParameters:c}}async receive(r){this.assertNotClosed();const n=[];for(const s of r){const{trackId:i,kind:o}=s;this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Xe.debug("receive() [trackId:%s, kind:%s]",i,o);const a=this._nextLocalId++,c=new W0.FakeMediaStreamTrack({kind:o});this._tracks.set(a,c),n.push({localId:String(a),track:c})}return n}async stopReceiving(r){if(!this._closed)for(const n of r)Xe.debug("stopReceiving() [localId:%s]",n),this._tracks.delete(Number(n))}async pauseReceiving(r){this.assertNotClosed()}async resumeReceiving(r){this.assertNotClosed()}async getReceiverStats(r){return this.assertNotClosed(),new Map}async receiveDataChannel({sctpStreamParameters:r,label:n,protocol:s}){return this.assertNotClosed(),this._transportReady||await this.setupTransport({localDtlsRole:"client"}),Xe.debug("receiveDataChannel()"),{dataChannel:new Kf({id:r.streamId,ordered:r.ordered,maxPacketLifeTime:r.maxPacketLifeTime,maxRetransmits:r.maxRetransmits,label:n,protocol:s})}}async setupTransport({localDtlsRole:r,localSdpObject:n}){const s=fs.clone(this.fakeParameters.generateLocalDtlsParameters());r&&(s.role=r),this.emit("@connectionstatechange","connecting"),await new Promise((i,o)=>this.emit("@connect",{dtlsParameters:s},i,o)),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Y0.InvalidStateError("method called in a closed handler")}}dc.FakeHandler=Ru;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.generateRouterRtpCapabilities=Z0;Kt.generateNativeRtpCapabilities=eR;Kt.generateNativeSctpCapabilities=tR;Kt.generateLocalDtlsParameters=rR;Kt.generateTransportRemoteParameters=nR;Kt.generateProducerRemoteParameters=sR;Kt.generateConsumerRemoteParameters=iR;Kt.generateDataProducerRemoteParameters=oR;Kt.generateDataConsumerRemoteParameters=aR;const tt=be;function gt(){return String(tt.generateRandomNumber())}function Z0(){return tt.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}},{mimeType:"video/H264",kind:"video",preferredPayloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:105,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"profile-id":0,"x-google-start-bitrate":1500}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:106,clockRate:9e4,rtcpFeedback:[],parameters:{apt:105}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id",preferredId:2,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id",preferredId:3,preferredEncrypt:!1,direction:"recvonly"},{kind:"audio",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:4,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"recvonly"},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"http://tools.ietf.org/html/draft-ietf-avtext-framemarking-07",preferredId:6,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:framemarking",preferredId:7,preferredEncrypt:!1,direction:"sendrecv"},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:11,preferredEncrypt:!1,direction:"sendrecv"},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:12,preferredEncrypt:!1,direction:"sendrecv"}]})}function eR(){return tt.deepFreeze({codecs:[{mimeType:"audio/opus",kind:"audio",preferredPayloadType:111,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{minptime:10,useinbandfec:1}},{mimeType:"audio/ISAC",kind:"audio",preferredPayloadType:103,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"audio/CN",kind:"audio",preferredPayloadType:106,clockRate:32e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}},{mimeType:"video/VP8",kind:"video",preferredPayloadType:96,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{baz:"1234abcd"}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:97,clockRate:9e4,rtcpFeedback:[],parameters:{apt:96}},{mimeType:"video/VP9",kind:"video",preferredPayloadType:98,clockRate:9e4,rtcpFeedback:[{type:"goog-remb"},{type:"transport-cc"},{type:"ccm",parameter:"fir"},{type:"nack"},{type:"nack",parameter:"pli"}],parameters:{"profile-id":0}},{mimeType:"video/rtx",kind:"video",preferredPayloadType:99,clockRate:9e4,rtcpFeedback:[],parameters:{apt:98}}],headerExtensions:[{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:sdes:mid",preferredId:1},{kind:"video",uri:"urn:ietf:params:rtp-hdrext:toffset",preferredId:2},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",preferredId:3},{kind:"video",uri:"urn:3gpp:video-orientation",preferredId:4},{kind:"video",uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",preferredId:5},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay",preferredId:6},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type",preferredId:7},{kind:"video",uri:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing",preferredId:8},{kind:"audio",uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",preferredId:10}]})}function tR(){return tt.deepFreeze({numStreams:{OS:2048,MIS:2048}})}function rR(){return tt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"82:5A:68:3D:36:C3:0A:DE:AF:E7:32:43:D2:88:83:57:AC:2D:65:E5:80:C4:B6:FB:AF:1A:A0:21:9F:6D:0C:AD"}],role:"auto"})}function nR(){return{id:gt(),iceParameters:tt.deepFreeze({iceLite:!0,password:"yku5ej8nvfaor28lvtrabcx0wkrpkztz",usernameFragment:"h3hk1iz6qqlnqlne"}),iceCandidates:tt.deepFreeze([{foundation:"udpcandidate",address:"9.9.9.9",ip:"9.9.9.9",port:40533,priority:1078862079,protocol:"udp",type:"host",tcpType:"passive"},{foundation:"udpcandidate",address:"9.9.9.9",ip:"9:9:9:9:9:9",port:41333,priority:1078862089,protocol:"udp",type:"host",tcpType:"passive"}]),dtlsParameters:tt.deepFreeze({fingerprints:[{algorithm:"sha-256",value:"A9:F4:E0:D2:74:D3:0F:D9:CA:A5:2F:9F:7F:47:FA:F0:C4:72:DD:73:49:D0:3B:14:90:20:51:30:1B:90:8E:71"},{algorithm:"sha-384",value:"03:D9:0B:87:13:98:F6:6D:BC:FC:92:2E:39:D4:E1:97:32:61:30:56:84:70:81:6E:D1:82:97:EA:D9:C1:21:0F:6B:C5:E7:7F:E1:97:0C:17:97:6E:CF:B3:EF:2E:74:B0"},{algorithm:"sha-512",value:"84:27:A4:28:A4:73:AF:43:02:2A:44:68:FF:2F:29:5C:3B:11:9A:60:F4:A8:F0:F5:AC:A0:E3:49:3E:B1:34:53:A9:85:CE:51:9B:ED:87:5E:B8:F4:8E:3D:FA:20:51:B8:96:EE:DA:56:DC:2F:5C:62:79:15:23:E0:21:82:2B:2C"}],role:"auto"}),sctpParameters:tt.deepFreeze({port:5e3,OS:2048,MIS:2048,maxMessageSize:2e6})}}function sR(){return tt.deepFreeze({id:gt()})}function iR({id:e,codecMimeType:t}={}){switch(t){case"audio/opus":return{id:e??gt(),producerId:gt(),kind:"audio",rtpParameters:tt.deepFreeze({codecs:[{mimeType:"audio/opus",payloadType:100,clockRate:48e3,channels:2,rtcpFeedback:[{type:"transport-cc"}],parameters:{useinbandfec:1,foo:"bar"}}],encodings:[{ssrc:46687003}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:ietf:params:rtp-hdrext:ssrc-audio-level",id:10}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"audio/ISAC":return{id:e??gt(),producerId:gt(),kind:"audio",rtpParameters:tt.deepFreeze({codecs:[{mimeType:"audio/ISAC",payloadType:111,clockRate:16e3,channels:1,rtcpFeedback:[{type:"transport-cc"}],parameters:{}}],encodings:[{ssrc:46687004}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/VP8":return{id:e??gt(),producerId:gt(),kind:"video",rtpParameters:tt.deepFreeze({codecs:[{mimeType:"video/VP8",payloadType:101,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"x-google-start-bitrate":1500}},{mimeType:"video/rtx",payloadType:102,clockRate:9e4,rtcpFeedback:[],parameters:{apt:101}}],encodings:[{ssrc:99991111,rtx:{ssrc:99991112}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};case"video/H264":return{id:e??gt(),producerId:gt(),kind:"video",rtpParameters:tt.deepFreeze({codecs:[{mimeType:"video/H264",payloadType:103,clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"ccm",parameter:"fir"},{type:"goog-remb"},{type:"transport-cc"}],parameters:{"level-asymmetry-allowed":1,"packetization-mode":1,"profile-level-id":"42e01f"}},{mimeType:"video/rtx",payloadType:104,clockRate:9e4,rtcpFeedback:[],parameters:{apt:103}}],encodings:[{ssrc:99991113,rtx:{ssrc:99991114}}],headerExtensions:[{uri:"urn:ietf:params:rtp-hdrext:sdes:mid",id:1},{uri:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",id:4},{uri:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01",id:5},{uri:"urn:3gpp:video-orientation",id:11},{uri:"urn:ietf:params:rtp-hdrext:toffset",id:12}],rtcp:{cname:"wB4Ql4lrsxYLjzuN",reducedSize:!0,mux:!0}})};default:throw new TypeError(`unknown codecMimeType '${t}'`)}}function oR(){return tt.deepFreeze({id:gt()})}function aR({id:e}={}){return{id:e??gt(),dataProducerId:gt(),sctpStreamParameters:tt.deepFreeze({streamId:666,maxPacketLifeTime:5e3,maxRetransmits:void 0})}}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.debug=e.testFakeParameters=e.FakeHandler=e.ortc=e.parseScalabilityMode=e.detectDeviceAsync=e.detectDevice=e.Device=e.version=e.types=void 0;const t=Ka;e.debug=t.default,e.types=hm,e.version="3.11.0";var r=$n;Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return r.Device}}),Object.defineProperty(e,"detectDevice",{enumerable:!0,get:function(){return r.detectDevice}}),Object.defineProperty(e,"detectDeviceAsync",{enumerable:!0,get:function(){return r.detectDeviceAsync}});var n=ur;Object.defineProperty(e,"parseScalabilityMode",{enumerable:!0,get:function(){return n.parse}}),e.ortc=ce;var s=dc;Object.defineProperty(e,"FakeHandler",{enumerable:!0,get:function(){return s.FakeHandler}}),e.testFakeParameters=Kt})(Hd);const lr=Object.create(null);lr.open="0";lr.close="1";lr.ping="2";lr.pong="3";lr.message="4";lr.upgrade="5";lr.noop="6";const aa=Object.create(null);Object.keys(lr).forEach(e=>{aa[lr[e]]=e});const zl={type:"error",data:"parser error"},Qm=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Wm=typeof ArrayBuffer=="function",qm=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,bu=({type:e,data:t},r,n)=>Qm&&t instanceof Blob?r?n(t):Qf(t,n):Wm&&(t instanceof ArrayBuffer||qm(t))?r?n(t):Qf(new Blob([t]),n):n(lr[e]+(t||"")),Qf=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function Wf(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let al;function cR(e,t){if(Qm&&e.data instanceof Blob)return e.data.arrayBuffer().then(Wf).then(t);if(Wm&&(e.data instanceof ArrayBuffer||qm(e.data)))return t(Wf(e.data));bu(e,!1,r=>{al||(al=new TextEncoder),t(al.encode(r))})}const qf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ki=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<qf.length;e++)ki[qf.charCodeAt(e)]=e;const lR=e=>{let t=e.length*.75,r=e.length,n,s=0,i,o,a,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const l=new ArrayBuffer(t),u=new Uint8Array(l);for(n=0;n<r;n+=4)i=ki[e.charCodeAt(n)],o=ki[e.charCodeAt(n+1)],a=ki[e.charCodeAt(n+2)],c=ki[e.charCodeAt(n+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|a>>2,u[s++]=(a&3)<<6|c&63;return l},dR=typeof ArrayBuffer=="function",Cu=(e,t)=>{if(typeof e!="string")return{type:"message",data:Gm(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:uR(e.substring(1),t)}:aa[r]?e.length>1?{type:aa[r],data:e.substring(1)}:{type:aa[r]}:zl},uR=(e,t)=>{if(dR){const r=lR(e);return Gm(r,t)}else return{base64:!0,data:e}},Gm=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},Ym="",pR=(e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach((i,o)=>{bu(i,!1,a=>{n[o]=a,++s===r&&t(n.join(Ym))})})},fR=(e,t)=>{const r=e.split(Ym),n=[];for(let s=0;s<r.length;s++){const i=Cu(r[s],t);if(n.push(i),i.type==="error")break}return n};function hR(){return new TransformStream({transform(e,t){cR(e,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const i=new DataView(s.buffer);i.setUint8(0,126),i.setUint16(1,n)}else{s=new Uint8Array(9);const i=new DataView(s.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let cl;function zo(e){return e.reduce((t,r)=>t+r.length,0)}function Bo(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function mR(e,t){cl||(cl=new TextDecoder);const r=[];let n=0,s=-1,i=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(n===0){if(zo(r)<1)break;const c=Bo(r,1);i=(c[0]&128)===128,s=c[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(zo(r)<2)break;const c=Bo(r,2);s=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(zo(r)<8)break;const c=Bo(r,8),l=new DataView(c.buffer,c.byteOffset,c.length),u=l.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(zl);break}s=u*Math.pow(2,32)+l.getUint32(4),n=3}else{if(zo(r)<s)break;const c=Bo(r,s);a.enqueue(Cu(i?c:cl.decode(c),t)),n=0}if(s===0||s>e){a.enqueue(zl);break}}}})}const Xm=4;function Me(e){if(e)return gR(e)}function gR(e){for(var t in Me.prototype)e[t]=Me.prototype[t];return e}Me.prototype.on=Me.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Me.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Me.prototype.off=Me.prototype.removeListener=Me.prototype.removeAllListeners=Me.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Me.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,t)}return this};Me.prototype.emitReserved=Me.prototype.emit;Me.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Me.prototype.hasListeners=function(e){return!!this.listeners(e).length};const mc=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Ct=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),vR="arraybuffer";function Jm(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const _R=Ct.setTimeout,yR=Ct.clearTimeout;function gc(e,t){t.useNativeTimers?(e.setTimeoutFn=_R.bind(Ct),e.clearTimeoutFn=yR.bind(Ct)):(e.setTimeoutFn=Ct.setTimeout.bind(Ct),e.clearTimeoutFn=Ct.clearTimeout.bind(Ct))}const wR=1.33;function SR(e){return typeof e=="string"?RR(e):Math.ceil((e.byteLength||e.size)*wR)}function RR(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function Zm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function bR(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function CR(e){let t={},r=e.split("&");for(let n=0,s=r.length;n<s;n++){let i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class kR extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class ku extends Me{constructor(t){super(),this.writable=!1,gc(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new kR(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Cu(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=bR(t);return r.length?"?"+r:""}}class TR extends ku{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};fR(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,pR(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Zm()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let eg=!1;try{eg=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ER=eg;function DR(){}class PR extends TR{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(s,i)=>{this.onError("xhr post error",s,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class or extends Me{constructor(t,r,n){super(),this.createRequest=t,gc(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=Jm(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=or.requestsCount++,or.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=DR,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete or.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}or.requestsCount=0;or.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Gf);else if(typeof addEventListener=="function"){const e="onpagehide"in Ct?"pagehide":"unload";addEventListener(e,Gf,!1)}}function Gf(){for(let e in or.requests)or.requests.hasOwnProperty(e)&&or.requests[e].abort()}const xR=function(){const e=tg({xdomain:!1});return e&&e.responseType!==null}();class LR extends PR{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=xR&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new or(tg,this.uri(),t)}}function tg(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||ER))return new XMLHttpRequest}catch{}if(!t)try{return new Ct[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const rg=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class IR extends ku{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=rg?{}:Jm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;bu(n,this.supportsBinary,i=>{try{this.doWrite(n,i)}catch{}s&&mc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Zm()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const ll=Ct.WebSocket||Ct.MozWebSocket;class MR extends IR{createSocket(t,r,n){return rg?new ll(t,r,n):r?new ll(t,r):new ll(t)}doWrite(t,r){this.ws.send(r)}}class OR extends ku{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=mR(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),s=hR();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const i=()=>{n.read().then(({done:a,value:c})=>{a||(this.onPacket(c),i())}).catch(a=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;this._writer.write(n).then(()=>{s&&mc(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const NR={websocket:MR,webtransport:OR,polling:LR},AR=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,jR=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Bl(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=AR.exec(e||""),i={},o=14;for(;o--;)i[jR[o]]=s[o]||"";return r!=-1&&n!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=$R(i,i.path),i.queryKey=FR(i,i.query),i}function $R(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function FR(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,i){s&&(r[s]=i)}),r}const Ul=typeof addEventListener=="function"&&typeof removeEventListener=="function",ca=[];Ul&&addEventListener("offline",()=>{ca.forEach(e=>e())},!1);class Xr extends Me{constructor(t,r){if(super(),this.binaryType=vR,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=Bl(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=Bl(r.host).host);gc(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=CR(this.opts.query)),Ul&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ca.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=Xm,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Xr.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",Xr.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=SR(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,mc(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const i={type:t,data:r,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(Xr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ul&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=ca.indexOf(this._offlineEventListener);n!==-1&&ca.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}Xr.protocol=Xm;class zR extends Xr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;Xr.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",d=>{if(!n)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Xr.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function i(){n||(n=!0,u(),r.close(),r=null)}const o=d=>{const p=new Error("probe error: "+d);p.transport=r.name,i(),this.emitReserved("upgradeError",p)};function a(){o("transport closed")}function c(){o("socket closed")}function l(d){r&&d.name!==r.name&&i()}const u=()=>{r.removeListener("open",s),r.removeListener("error",o),r.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};r.once("open",s),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",l),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let BR=class extends zR{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>NR[s]).filter(s=>!!s)),super(t,n)}};function UR(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=Bl(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const i=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}const HR=typeof ArrayBuffer=="function",VR=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,ng=Object.prototype.toString,KR=typeof Blob=="function"||typeof Blob<"u"&&ng.call(Blob)==="[object BlobConstructor]",QR=typeof File=="function"||typeof File<"u"&&ng.call(File)==="[object FileConstructor]";function Tu(e){return HR&&(e instanceof ArrayBuffer||VR(e))||KR&&e instanceof Blob||QR&&e instanceof File}function la(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(la(e[r]))return!0;return!1}if(Tu(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return la(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&la(e[r]))return!0;return!1}function WR(e){const t=[],r=e.data,n=e;return n.data=Hl(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Hl(e,t){if(!e)return e;if(Tu(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Hl(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Hl(e[n],t));return r}return e}function qR(e,t){return e.data=Vl(e.data,t),delete e.attachments,e}function Vl(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Vl(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Vl(e[r],t));return e}const GR=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],YR=5;var J;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(J||(J={}));class XR{constructor(t){this.replacer=t}encode(t){return(t.type===J.EVENT||t.type===J.ACK)&&la(t)?this.encodeAsBinary({type:t.type===J.EVENT?J.BINARY_EVENT:J.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===J.BINARY_EVENT||t.type===J.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=WR(t),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function Yf(e){return Object.prototype.toString.call(e)==="[object Object]"}class Eu extends Me{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===J.BINARY_EVENT;n||r.type===J.BINARY_ACK?(r.type=n?J.EVENT:J.ACK,this.reconstructor=new JR(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Tu(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(J[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===J.BINARY_EVENT||n.type===J.BINARY_ACK){const i=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const o=t.substring(i,r);if(o!=Number(o)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(t.charAt(r+1)==="/"){const i=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(i,r)}else n.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const i=r+1;for(;++r;){const o=t.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===t.length)break}n.id=Number(t.substring(i,r+1))}if(t.charAt(++r)){const i=this.tryParse(t.substr(r));if(Eu.isPayloadValid(n.type,i))n.data=i;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case J.CONNECT:return Yf(r);case J.DISCONNECT:return r===void 0;case J.CONNECT_ERROR:return typeof r=="string"||Yf(r);case J.EVENT:case J.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&GR.indexOf(r[0])===-1);case J.ACK:case J.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class JR{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=qR(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ZR=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Eu,Encoder:XR,get PacketType(){return J},protocol:YR},Symbol.toStringTag,{value:"Module"}));function At(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const e1=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class sg extends Me{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[At(t,"open",this.onopen.bind(this)),At(t,"packet",this.onpacket.bind(this)),At(t,"error",this.onerror.bind(this)),At(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,s,i;if(e1.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const o={type:J.EVENT,data:r};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,d=r.pop();this._registerAckCallback(u,d),o.id=u}const a=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,c=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!a||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},s),o=(...a)=>{this.io.clearTimeoutFn(i),r.apply(this,a)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...r){return new Promise((n,s)=>{const i=(o,a)=>o?s(o):n(a);i.withError=!0,r.push(i),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...i)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...i)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:J.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case J.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case J.EVENT:case J.BINARY_EVENT:this.onevent(t);break;case J.ACK:case J.BINARY_ACK:this.onack(t);break;case J.DISCONNECT:this.ondisconnect();break;case J.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:J.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:J.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Xs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Xs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Xs.prototype.reset=function(){this.attempts=0};Xs.prototype.setMin=function(e){this.ms=e};Xs.prototype.setMax=function(e){this.max=e};Xs.prototype.setJitter=function(e){this.jitter=e};class Kl extends Me{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,gc(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Xs({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||ZR;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new BR(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=At(r,"open",function(){n.onopen(),t&&t()}),i=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),t?t(a):this.maybeReconnectOnOpen()},o=At(r,"error",i);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{s(),i(new Error("timeout")),r.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(s),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(At(t,"ping",this.onping.bind(this)),At(t,"data",this.ondata.bind(this)),At(t,"error",this.onerror.bind(this)),At(t,"close",this.onclose.bind(this)),At(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){mc(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new sg(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const gi={};function xi(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=UR(e,t.path||"/socket.io"),n=r.source,s=r.id,i=r.path,o=gi[s]&&i in gi[s].nsps,a=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let c;return a?c=new Kl(n,t):(gi[s]||(gi[s]=new Kl(n,t)),c=gi[s]),r.query&&!t.query&&(t.query=r.queryKey),c.socket(r.path,t)}Object.assign(xi,{Manager:Kl,Socket:sg,io:xi,connect:xi});const t1="http://localhost:3000";function r1(){const[e,t]=Ft.useState("Idle"),r=Ft.useRef(null);return Ft.useEffect(()=>{async function n(){t("Requesting media...");const s=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});r.current&&(r.current.srcObject=s),t("Connecting to server...");const i=new Hd.Device,o=xi(t1);await new Promise(p=>o.on("connect",()=>p()));const a=await new Promise(p=>o.emit("getRtpCapabilities",f=>p(f)));await i.load({routerRtpCapabilities:a});const c=await new Promise(p=>o.emit("createProducerTransport",f=>p(f))),l=i.createSendTransport(c);l.on("connect",({dtlsParameters:p},f)=>{o.emit("connectTransport",{dtlsParameters:p},f)}),l.on("produce",({kind:p,rtpParameters:f},y)=>{o.emit("produce",{kind:p,rtpParameters:f},y)}),t("Sending video...");const u=s.getVideoTracks()[0];u&&await l.produce({track:u}),t("Sending audio...");const d=s.getAudioTracks()[0];d&&await l.produce({track:d}),t("✅ AV streaming started.")}n()},[]),se.jsxs("div",{children:[se.jsx("h2",{children:"AV Sender"}),se.jsxs("p",{children:["Status: ",e]}),se.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,style:{width:320}})]})}const n1="http://localhost:3000";function s1(){const[e,t]=Ft.useState("Idle"),r=Ft.useRef(null);return Ft.useEffect(()=>{async function n(){t("Connecting to server...");const s=new Hd.Device,i=xi(n1);await new Promise(y=>i.on("connect",()=>y()));const o=s.rtpCapabilities,a=await new Promise(y=>i.emit("createConsumerTransport",{rtpCapabilities:o},w=>y(w))),c=s.createRecvTransport(a);c.on("connect",({dtlsParameters:y},w)=>{i.emit("connectConsumerTransport",{dtlsParameters:y},w)});const{id:l,kind:u,rtpParameters:d}=await new Promise(y=>i.emit("consume",{rtpCapabilities:o},w=>y(w))),p=await c.consume({id:l,kind:u,rtpParameters:d}),f=new MediaStream([p.track]);r.current&&(r.current.srcObject=f),t("✅ Receiving stream.")}n()},[]),se.jsxs("div",{children:[se.jsx("h2",{children:"AV Receiver"}),se.jsxs("p",{children:["Status: ",e]}),se.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,controls:!0,style:{width:320}})]})}const i1=()=>se.jsxs("div",{className:"container mx-auto px-6 py-8",children:[se.jsxs("div",{className:"text-center mb-8",children:[se.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"🎥 CrossStream"}),se.jsx("p",{className:"text-gray-400 text-lg",children:"Cross-platform streaming application"})]}),se.jsx("div",{className:"max-w-md mx-auto",children:se.jsx(z_,{})}),se.jsx("div",{className:"mt-8 text-center text-sm text-gray-500",children:se.jsx("p",{children:"Ready to stream audio and video across platforms"})}),se.jsxs("div",{className:"mt-8 flex flex-col md:flex-row justify-center gap-8",children:[se.jsx(r1,{}),se.jsx(s1,{})]})]}),o1=()=>se.jsx("div",{className:"min-h-screen bg-gray-900 text-white",children:se.jsx(i1,{})});var Ql={},ig={exports:{}},St={},og={exports:{}},ag={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(D,F){var K=D.length;D.push(F);e:for(;0<K;){var le=K-1>>>1,ke=D[le];if(0<s(ke,F))D[le]=F,D[K]=ke,K=le;else break e}}function r(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var F=D[0],K=D.pop();if(K!==F){D[0]=K;e:for(var le=0,ke=D.length,hr=ke>>>1;le<hr;){var Qe=2*(le+1)-1,ti=D[Qe],mr=Qe+1,Hn=D[mr];if(0>s(ti,K))mr<ke&&0>s(Hn,ti)?(D[le]=Hn,D[mr]=K,le=mr):(D[le]=ti,D[Qe]=K,le=Qe);else if(mr<ke&&0>s(Hn,K))D[le]=Hn,D[mr]=K,le=mr;else break e}}return F}function s(D,F){var K=D.sortIndex-F.sortIndex;return K!==0?K:D.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,d=null,p=3,f=!1,y=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function h(D){for(var F=r(l);F!==null;){if(F.callback===null)n(l);else if(F.startTime<=D)n(l),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(l)}}function _(D){if(w=!1,h(D),!y)if(r(c)!==null)y=!0,pr(S);else{var F=r(l);F!==null&&fr(_,F.startTime-D)}}function S(D,F){y=!1,w&&(w=!1,m(x),x=-1),f=!0;var K=p;try{for(h(F),d=r(c);d!==null&&(!(d.expirationTime>F)||D&&!M());){var le=d.callback;if(typeof le=="function"){d.callback=null,p=d.priorityLevel;var ke=le(d.expirationTime<=F);F=e.unstable_now(),typeof ke=="function"?d.callback=ke:d===r(c)&&n(c),h(F)}else n(c);d=r(c)}if(d!==null)var hr=!0;else{var Qe=r(l);Qe!==null&&fr(_,Qe.startTime-F),hr=!1}return hr}finally{d=null,p=K,f=!1}}var R=!1,E=null,x=-1,C=5,B=-1;function M(){return!(e.unstable_now()-B<C)}function Z(){if(E!==null){var D=e.unstable_now();B=D;var F=!0;try{F=E(!0,D)}finally{F?fe():(R=!1,E=null)}}else R=!1}var fe;if(typeof v=="function")fe=function(){v(Z)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,ei=mt.port2;mt.port1.onmessage=Z,fe=function(){ei.postMessage(null)}}else fe=function(){b(Z,0)};function pr(D){E=D,R||(R=!0,fe())}function fr(D,F){x=b(function(){D(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_continueExecution=function(){y||f||(y=!0,pr(S))},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(D){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var K=p;p=F;try{return D()}finally{p=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D,F){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var K=p;p=D;try{return F()}finally{p=K}},e.unstable_scheduleCallback=function(D,F,K){var le=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?le+K:le):K=le,D){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=K+ke,D={id:u++,callback:F,priorityLevel:D,startTime:K,expirationTime:ke,sortIndex:-1},K>le?(D.sortIndex=K,t(l,D),r(c)===null&&D===r(l)&&(w?(m(x),x=-1):w=!0,fr(_,K-le))):(D.sortIndex=ke,t(c,D),y||f||(y=!0,pr(S))),D},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(D){var F=p;return function(){var K=p;p=F;try{return D.apply(this,arguments)}finally{p=K}}}})(ag);og.exports=ag;var a1=og.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1=Ft,wt=a1;function k(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cg=new Set,zi={};function Bn(e,t){Fs(e,t),Fs(e+"Capture",t)}function Fs(e,t){for(zi[e]=t,e=0;e<t.length;e++)cg.add(t[e])}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wl=Object.prototype.hasOwnProperty,l1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xf={},Jf={};function d1(e){return Wl.call(Jf,e)?!0:Wl.call(Xf,e)?!1:l1.test(e)?Jf[e]=!0:(Xf[e]=!0,!1)}function u1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function p1(e,t,r,n){if(t===null||typeof t>"u"||u1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function at(e,t,r,n,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Ve={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ve[e]=new at(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ve[t]=new at(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ve[e]=new at(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ve[e]=new at(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ve[e]=new at(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ve[e]=new at(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ve[e]=new at(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ve[e]=new at(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ve[e]=new at(e,5,!1,e.toLowerCase(),null,!1,!1)});var Du=/[\-:]([a-z])/g;function Pu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Du,Pu);Ve[t]=new at(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Du,Pu);Ve[t]=new at(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Du,Pu);Ve[t]=new at(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ve[e]=new at(e,1,!1,e.toLowerCase(),null,!1,!1)});Ve.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ve[e]=new at(e,1,!1,e.toLowerCase(),null,!0,!0)});function xu(e,t,r,n){var s=Ve.hasOwnProperty(t)?Ve[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(p1(t,r,s,n)&&(r=null),n||s===null?d1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ir=c1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Uo=Symbol.for("react.element"),gs=Symbol.for("react.portal"),vs=Symbol.for("react.fragment"),Lu=Symbol.for("react.strict_mode"),ql=Symbol.for("react.profiler"),lg=Symbol.for("react.provider"),dg=Symbol.for("react.context"),Iu=Symbol.for("react.forward_ref"),Gl=Symbol.for("react.suspense"),Yl=Symbol.for("react.suspense_list"),Mu=Symbol.for("react.memo"),Ur=Symbol.for("react.lazy"),ug=Symbol.for("react.offscreen"),Zf=Symbol.iterator;function vi(e){return e===null||typeof e!="object"?null:(e=Zf&&e[Zf]||e["@@iterator"],typeof e=="function"?e:null)}var Re=Object.assign,dl;function Ti(e){if(dl===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);dl=t&&t[1]||""}return`
`+dl+e}var ul=!1;function pl(e,t){if(!e||ul)return"";ul=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var n=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){n=l}e.call(t.prototype)}else{try{throw Error()}catch(l){n=l}e()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=a);break}}}finally{ul=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ti(e):""}function f1(e){switch(e.tag){case 5:return Ti(e.type);case 16:return Ti("Lazy");case 13:return Ti("Suspense");case 19:return Ti("SuspenseList");case 0:case 2:case 15:return e=pl(e.type,!1),e;case 11:return e=pl(e.type.render,!1),e;case 1:return e=pl(e.type,!0),e;default:return""}}function Xl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vs:return"Fragment";case gs:return"Portal";case ql:return"Profiler";case Lu:return"StrictMode";case Gl:return"Suspense";case Yl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dg:return(e.displayName||"Context")+".Consumer";case lg:return(e._context.displayName||"Context")+".Provider";case Iu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Mu:return t=e.displayName||null,t!==null?t:Xl(e.type)||"Memo";case Ur:t=e._payload,e=e._init;try{return Xl(e(t))}catch{}}return null}function h1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xl(t);case 8:return t===Lu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function an(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function m1(e){var t=pg(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ho(e){e._valueTracker||(e._valueTracker=m1(e))}function fg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=pg(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function wa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Jl(e,t){var r=t.checked;return Re({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function eh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=an(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hg(e,t){t=t.checked,t!=null&&xu(e,"checked",t,!1)}function Zl(e,t){hg(e,t);var r=an(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ed(e,t.type,r):t.hasOwnProperty("defaultValue")&&ed(e,t.type,an(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function th(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ed(e,t,r){(t!=="number"||wa(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ei=Array.isArray;function Ps(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+an(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function td(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(k(91));return Re({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(k(92));if(Ei(r)){if(1<r.length)throw Error(k(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:an(r)}}function mg(e,t){var r=an(t.value),n=an(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function nh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vo,vg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Vo=Vo||document.createElement("div"),Vo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Vo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Bi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},g1=["Webkit","ms","Moz","O"];Object.keys(Li).forEach(function(e){g1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Li[t]=Li[e]})});function _g(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Li.hasOwnProperty(e)&&Li[e]?(""+t).trim():t+"px"}function yg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=_g(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var v1=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nd(e,t){if(t){if(v1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(k(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(k(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(k(61))}if(t.style!=null&&typeof t.style!="object")throw Error(k(62))}}function sd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var id=null;function Ou(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var od=null,xs=null,Ls=null;function sh(e){if(e=mo(e)){if(typeof od!="function")throw Error(k(280));var t=e.stateNode;t&&(t=Sc(t),od(e.stateNode,e.type,t))}}function wg(e){xs?Ls?Ls.push(e):Ls=[e]:xs=e}function Sg(){if(xs){var e=xs,t=Ls;if(Ls=xs=null,sh(e),t)for(e=0;e<t.length;e++)sh(t[e])}}function Rg(e,t){return e(t)}function bg(){}var fl=!1;function Cg(e,t,r){if(fl)return e(t,r);fl=!0;try{return Rg(e,t,r)}finally{fl=!1,(xs!==null||Ls!==null)&&(bg(),Sg())}}function Ui(e,t){var r=e.stateNode;if(r===null)return null;var n=Sc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(k(231,t,typeof r));return r}var ad=!1;if(Dr)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){ad=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{ad=!1}function _1(e,t,r,n,s,i,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var Ii=!1,Sa=null,Ra=!1,cd=null,y1={onError:function(e){Ii=!0,Sa=e}};function w1(e,t,r,n,s,i,o,a,c){Ii=!1,Sa=null,_1.apply(y1,arguments)}function S1(e,t,r,n,s,i,o,a,c){if(w1.apply(this,arguments),Ii){if(Ii){var l=Sa;Ii=!1,Sa=null}else throw Error(k(198));Ra||(Ra=!0,cd=l)}}function Un(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function kg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ih(e){if(Un(e)!==e)throw Error(k(188))}function R1(e){var t=e.alternate;if(!t){if(t=Un(e),t===null)throw Error(k(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return ih(s),e;if(i===n)return ih(s),t;i=i.sibling}throw Error(k(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o)throw Error(k(189))}}if(r.alternate!==n)throw Error(k(190))}if(r.tag!==3)throw Error(k(188));return r.stateNode.current===r?e:t}function Tg(e){return e=R1(e),e!==null?Eg(e):null}function Eg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Eg(e);if(t!==null)return t;e=e.sibling}return null}var Dg=wt.unstable_scheduleCallback,oh=wt.unstable_cancelCallback,b1=wt.unstable_shouldYield,C1=wt.unstable_requestPaint,Pe=wt.unstable_now,k1=wt.unstable_getCurrentPriorityLevel,Nu=wt.unstable_ImmediatePriority,Pg=wt.unstable_UserBlockingPriority,ba=wt.unstable_NormalPriority,T1=wt.unstable_LowPriority,xg=wt.unstable_IdlePriority,vc=null,ar=null;function E1(e){if(ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(vc,e,void 0,(e.current.flags&128)===128)}catch{}}var Bt=Math.clz32?Math.clz32:x1,D1=Math.log,P1=Math.LN2;function x1(e){return e>>>=0,e===0?32:31-(D1(e)/P1|0)|0}var Ko=64,Qo=4194304;function Di(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ca(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var a=o&~s;a!==0?n=Di(a):(i&=o,i!==0&&(n=Di(i)))}else o=r&~s,o!==0?n=Di(o):i!==0&&(n=Di(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Bt(t),s=1<<r,n|=e[r],t&=~s;return n}function L1(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I1(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Bt(i),a=1<<o,c=s[o];c===-1?(!(a&r)||a&n)&&(s[o]=L1(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}function ld(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Lg(){var e=Ko;return Ko<<=1,!(Ko&4194240)&&(Ko=64),e}function hl(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function fo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bt(t),e[t]=r}function M1(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Bt(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Au(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Bt(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var ae=0;function Ig(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Mg,ju,Og,Ng,Ag,dd=!1,Wo=[],Jr=null,Zr=null,en=null,Hi=new Map,Vi=new Map,Vr=[],O1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ah(e,t){switch(e){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Zr=null;break;case"mouseover":case"mouseout":en=null;break;case"pointerover":case"pointerout":Hi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vi.delete(t.pointerId)}}function yi(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=mo(t),t!==null&&ju(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function N1(e,t,r,n,s){switch(t){case"focusin":return Jr=yi(Jr,e,t,r,n,s),!0;case"dragenter":return Zr=yi(Zr,e,t,r,n,s),!0;case"mouseover":return en=yi(en,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return Hi.set(i,yi(Hi.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Vi.set(i,yi(Vi.get(i)||null,e,t,r,n,s)),!0}return!1}function jg(e){var t=_n(e.target);if(t!==null){var r=Un(t);if(r!==null){if(t=r.tag,t===13){if(t=kg(r),t!==null){e.blockedOn=t,Ag(e.priority,function(){Og(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function da(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ud(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);id=n,r.target.dispatchEvent(n),id=null}else return t=mo(r),t!==null&&ju(t),e.blockedOn=r,!1;t.shift()}return!0}function ch(e,t,r){da(e)&&r.delete(t)}function A1(){dd=!1,Jr!==null&&da(Jr)&&(Jr=null),Zr!==null&&da(Zr)&&(Zr=null),en!==null&&da(en)&&(en=null),Hi.forEach(ch),Vi.forEach(ch)}function wi(e,t){e.blockedOn===t&&(e.blockedOn=null,dd||(dd=!0,wt.unstable_scheduleCallback(wt.unstable_NormalPriority,A1)))}function Ki(e){function t(s){return wi(s,e)}if(0<Wo.length){wi(Wo[0],e);for(var r=1;r<Wo.length;r++){var n=Wo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Jr!==null&&wi(Jr,e),Zr!==null&&wi(Zr,e),en!==null&&wi(en,e),Hi.forEach(t),Vi.forEach(t),r=0;r<Vr.length;r++)n=Vr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vr.length&&(r=Vr[0],r.blockedOn===null);)jg(r),r.blockedOn===null&&Vr.shift()}var Is=Ir.ReactCurrentBatchConfig,ka=!0;function j1(e,t,r,n){var s=ae,i=Is.transition;Is.transition=null;try{ae=1,$u(e,t,r,n)}finally{ae=s,Is.transition=i}}function $1(e,t,r,n){var s=ae,i=Is.transition;Is.transition=null;try{ae=4,$u(e,t,r,n)}finally{ae=s,Is.transition=i}}function $u(e,t,r,n){if(ka){var s=ud(e,t,r,n);if(s===null)Cl(e,t,n,Ta,r),ah(e,n);else if(N1(s,e,t,r,n))n.stopPropagation();else if(ah(e,n),t&4&&-1<O1.indexOf(e)){for(;s!==null;){var i=mo(s);if(i!==null&&Mg(i),i=ud(e,t,r,n),i===null&&Cl(e,t,n,Ta,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Cl(e,t,n,null,r)}}var Ta=null;function ud(e,t,r,n){if(Ta=null,e=Ou(n),e=_n(e),e!==null)if(t=Un(e),t===null)e=null;else if(r=t.tag,r===13){if(e=kg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ta=e,null}function $g(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(k1()){case Nu:return 1;case Pg:return 4;case ba:case T1:return 16;case xg:return 536870912;default:return 16}default:return 16}}var qr=null,Fu=null,ua=null;function Fg(){if(ua)return ua;var e,t=Fu,r=t.length,n,s="value"in qr?qr.value:qr.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===s[i-n];n++);return ua=s.slice(e,1<n?1-n:void 0)}function pa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function qo(){return!0}function lh(){return!1}function Rt(e){function t(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?qo:lh,this.isPropagationStopped=lh,this}return Re(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qo)},persist:function(){},isPersistent:qo}),t}var Js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zu=Rt(Js),ho=Re({},Js,{view:0,detail:0}),F1=Rt(ho),ml,gl,Si,_c=Re({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Si&&(Si&&e.type==="mousemove"?(ml=e.screenX-Si.screenX,gl=e.screenY-Si.screenY):gl=ml=0,Si=e),ml)},movementY:function(e){return"movementY"in e?e.movementY:gl}}),dh=Rt(_c),z1=Re({},_c,{dataTransfer:0}),B1=Rt(z1),U1=Re({},ho,{relatedTarget:0}),vl=Rt(U1),H1=Re({},Js,{animationName:0,elapsedTime:0,pseudoElement:0}),V1=Rt(H1),K1=Re({},Js,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Q1=Rt(K1),W1=Re({},Js,{data:0}),uh=Rt(W1),q1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},G1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function X1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Y1[e])?!!t[e]:!1}function Bu(){return X1}var J1=Re({},ho,{key:function(e){if(e.key){var t=q1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=pa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?G1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bu,charCode:function(e){return e.type==="keypress"?pa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?pa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Z1=Rt(J1),eb=Re({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ph=Rt(eb),tb=Re({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bu}),rb=Rt(tb),nb=Re({},Js,{propertyName:0,elapsedTime:0,pseudoElement:0}),sb=Rt(nb),ib=Re({},_c,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ob=Rt(ib),ab=[9,13,27,32],Uu=Dr&&"CompositionEvent"in window,Mi=null;Dr&&"documentMode"in document&&(Mi=document.documentMode);var cb=Dr&&"TextEvent"in window&&!Mi,zg=Dr&&(!Uu||Mi&&8<Mi&&11>=Mi),fh=" ",hh=!1;function Bg(e,t){switch(e){case"keyup":return ab.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ug(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _s=!1;function lb(e,t){switch(e){case"compositionend":return Ug(t);case"keypress":return t.which!==32?null:(hh=!0,fh);case"textInput":return e=t.data,e===fh&&hh?null:e;default:return null}}function db(e,t){if(_s)return e==="compositionend"||!Uu&&Bg(e,t)?(e=Fg(),ua=Fu=qr=null,_s=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zg&&t.locale!=="ko"?null:t.data;default:return null}}var ub={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ub[e.type]:t==="textarea"}function Hg(e,t,r,n){wg(n),t=Ea(t,"onChange"),0<t.length&&(r=new zu("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oi=null,Qi=null;function pb(e){ev(e,0)}function yc(e){var t=Ss(e);if(fg(t))return e}function fb(e,t){if(e==="change")return t}var Vg=!1;if(Dr){var _l;if(Dr){var yl="oninput"in document;if(!yl){var gh=document.createElement("div");gh.setAttribute("oninput","return;"),yl=typeof gh.oninput=="function"}_l=yl}else _l=!1;Vg=_l&&(!document.documentMode||9<document.documentMode)}function vh(){Oi&&(Oi.detachEvent("onpropertychange",Kg),Qi=Oi=null)}function Kg(e){if(e.propertyName==="value"&&yc(Qi)){var t=[];Hg(t,Qi,e,Ou(e)),Cg(pb,t)}}function hb(e,t,r){e==="focusin"?(vh(),Oi=t,Qi=r,Oi.attachEvent("onpropertychange",Kg)):e==="focusout"&&vh()}function mb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return yc(Qi)}function gb(e,t){if(e==="click")return yc(t)}function vb(e,t){if(e==="input"||e==="change")return yc(t)}function _b(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ht=typeof Object.is=="function"?Object.is:_b;function Wi(e,t){if(Ht(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Wl.call(t,s)||!Ht(e[s],t[s]))return!1}return!0}function _h(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function yh(e,t){var r=_h(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_h(r)}}function Qg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Qg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Wg(){for(var e=window,t=wa();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=wa(e.document)}return t}function Hu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yb(e){var t=Wg(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Qg(r.ownerDocument.documentElement,r)){if(n!==null&&Hu(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=yh(r,i);var o=yh(r,n);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var wb=Dr&&"documentMode"in document&&11>=document.documentMode,ys=null,pd=null,Ni=null,fd=!1;function wh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;fd||ys==null||ys!==wa(n)||(n=ys,"selectionStart"in n&&Hu(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ni&&Wi(Ni,n)||(Ni=n,n=Ea(pd,"onSelect"),0<n.length&&(t=new zu("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ys)))}function Go(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ws={animationend:Go("Animation","AnimationEnd"),animationiteration:Go("Animation","AnimationIteration"),animationstart:Go("Animation","AnimationStart"),transitionend:Go("Transition","TransitionEnd")},wl={},qg={};Dr&&(qg=document.createElement("div").style,"AnimationEvent"in window||(delete ws.animationend.animation,delete ws.animationiteration.animation,delete ws.animationstart.animation),"TransitionEvent"in window||delete ws.transitionend.transition);function wc(e){if(wl[e])return wl[e];if(!ws[e])return e;var t=ws[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in qg)return wl[e]=t[r];return e}var Gg=wc("animationend"),Yg=wc("animationiteration"),Xg=wc("animationstart"),Jg=wc("transitionend"),Zg=new Map,Sh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ln(e,t){Zg.set(e,t),Bn(t,[e])}for(var Sl=0;Sl<Sh.length;Sl++){var Rl=Sh[Sl],Sb=Rl.toLowerCase(),Rb=Rl[0].toUpperCase()+Rl.slice(1);ln(Sb,"on"+Rb)}ln(Gg,"onAnimationEnd");ln(Yg,"onAnimationIteration");ln(Xg,"onAnimationStart");ln("dblclick","onDoubleClick");ln("focusin","onFocus");ln("focusout","onBlur");ln(Jg,"onTransitionEnd");Fs("onMouseEnter",["mouseout","mouseover"]);Fs("onMouseLeave",["mouseout","mouseover"]);Fs("onPointerEnter",["pointerout","pointerover"]);Fs("onPointerLeave",["pointerout","pointerover"]);Bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pi));function Rh(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,S1(n,t,void 0,e),e.currentTarget=null}function ev(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;Rh(s,a,l),i=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;Rh(s,a,l),i=c}}}if(Ra)throw e=cd,Ra=!1,cd=null,e}function ge(e,t){var r=t[_d];r===void 0&&(r=t[_d]=new Set);var n=e+"__bubble";r.has(n)||(tv(t,e,2,!1),r.add(n))}function bl(e,t,r){var n=0;t&&(n|=4),tv(r,e,n,t)}var Yo="_reactListening"+Math.random().toString(36).slice(2);function qi(e){if(!e[Yo]){e[Yo]=!0,cg.forEach(function(r){r!=="selectionchange"&&(bb.has(r)||bl(r,!1,e),bl(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Yo]||(t[Yo]=!0,bl("selectionchange",!1,t))}}function tv(e,t,r,n){switch($g(t)){case 1:var s=j1;break;case 4:s=$1;break;default:s=$u}r=s.bind(null,t,r,e),s=void 0,!ad||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Cl(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=_n(a),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}a=a.parentNode}}n=n.return}Cg(function(){var l=i,u=Ou(r),d=[];e:{var p=Zg.get(e);if(p!==void 0){var f=zu,y=e;switch(e){case"keypress":if(pa(r)===0)break e;case"keydown":case"keyup":f=Z1;break;case"focusin":y="focus",f=vl;break;case"focusout":y="blur",f=vl;break;case"beforeblur":case"afterblur":f=vl;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=dh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=B1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=rb;break;case Gg:case Yg:case Xg:f=V1;break;case Jg:f=sb;break;case"scroll":f=F1;break;case"wheel":f=ob;break;case"copy":case"cut":case"paste":f=Q1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ph}var w=(t&4)!==0,b=!w&&e==="scroll",m=w?p!==null?p+"Capture":null:p;w=[];for(var v=l,h;v!==null;){h=v;var _=h.stateNode;if(h.tag===5&&_!==null&&(h=_,m!==null&&(_=Ui(v,m),_!=null&&w.push(Gi(v,_,h)))),b)break;v=v.return}0<w.length&&(p=new f(p,y,null,r,u),d.push({event:p,listeners:w}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&r!==id&&(y=r.relatedTarget||r.fromElement)&&(_n(y)||y[Pr]))break e;if((f||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,f?(y=r.relatedTarget||r.toElement,f=l,y=y?_n(y):null,y!==null&&(b=Un(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(f=null,y=l),f!==y)){if(w=dh,_="onMouseLeave",m="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(w=ph,_="onPointerLeave",m="onPointerEnter",v="pointer"),b=f==null?p:Ss(f),h=y==null?p:Ss(y),p=new w(_,v+"leave",f,r,u),p.target=b,p.relatedTarget=h,_=null,_n(u)===l&&(w=new w(m,v+"enter",y,r,u),w.target=h,w.relatedTarget=b,_=w),b=_,f&&y)t:{for(w=f,m=y,v=0,h=w;h;h=hs(h))v++;for(h=0,_=m;_;_=hs(_))h++;for(;0<v-h;)w=hs(w),v--;for(;0<h-v;)m=hs(m),h--;for(;v--;){if(w===m||m!==null&&w===m.alternate)break t;w=hs(w),m=hs(m)}w=null}else w=null;f!==null&&bh(d,p,f,w,!1),y!==null&&b!==null&&bh(d,b,y,w,!0)}}e:{if(p=l?Ss(l):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=fb;else if(mh(p))if(Vg)S=vb;else{S=mb;var R=hb}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=gb);if(S&&(S=S(e,l))){Hg(d,S,r,u);break e}R&&R(e,p,l),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&ed(p,"number",p.value)}switch(R=l?Ss(l):window,e){case"focusin":(mh(R)||R.contentEditable==="true")&&(ys=R,pd=l,Ni=null);break;case"focusout":Ni=pd=ys=null;break;case"mousedown":fd=!0;break;case"contextmenu":case"mouseup":case"dragend":fd=!1,wh(d,r,u);break;case"selectionchange":if(wb)break;case"keydown":case"keyup":wh(d,r,u)}var E;if(Uu)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else _s?Bg(e,r)&&(x="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(zg&&r.locale!=="ko"&&(_s||x!=="onCompositionStart"?x==="onCompositionEnd"&&_s&&(E=Fg()):(qr=u,Fu="value"in qr?qr.value:qr.textContent,_s=!0)),R=Ea(l,x),0<R.length&&(x=new uh(x,e,null,r,u),d.push({event:x,listeners:R}),E?x.data=E:(E=Ug(r),E!==null&&(x.data=E)))),(E=cb?lb(e,r):db(e,r))&&(l=Ea(l,"onBeforeInput"),0<l.length&&(u=new uh("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:l}),u.data=E))}ev(d,t)})}function Gi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ea(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ui(e,r),i!=null&&n.unshift(Gi(e,i,s)),i=Ui(e,t),i!=null&&n.push(Gi(e,i,s))),e=e.return}return n}function hs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function bh(e,t,r,n,s){for(var i=t._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,l=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&l!==null&&(a=l,s?(c=Ui(r,i),c!=null&&o.unshift(Gi(r,c,a))):s||(c=Ui(r,i),c!=null&&o.push(Gi(r,c,a)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var Cb=/\r\n?/g,kb=/\u0000|\uFFFD/g;function Ch(e){return(typeof e=="string"?e:""+e).replace(Cb,`
`).replace(kb,"")}function Xo(e,t,r){if(t=Ch(t),Ch(e)!==t&&r)throw Error(k(425))}function Da(){}var hd=null,md=null;function gd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vd=typeof setTimeout=="function"?setTimeout:void 0,Tb=typeof clearTimeout=="function"?clearTimeout:void 0,kh=typeof Promise=="function"?Promise:void 0,Eb=typeof queueMicrotask=="function"?queueMicrotask:typeof kh<"u"?function(e){return kh.resolve(null).then(e).catch(Db)}:vd;function Db(e){setTimeout(function(){throw e})}function kl(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Ki(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ki(t)}function tn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Th(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Zs=Math.random().toString(36).slice(2),ir="__reactFiber$"+Zs,Yi="__reactProps$"+Zs,Pr="__reactContainer$"+Zs,_d="__reactEvents$"+Zs,Pb="__reactListeners$"+Zs,xb="__reactHandles$"+Zs;function _n(e){var t=e[ir];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Pr]||r[ir]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Th(e);e!==null;){if(r=e[ir])return r;e=Th(e)}return t}e=r,r=e.parentNode}return null}function mo(e){return e=e[ir]||e[Pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ss(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(k(33))}function Sc(e){return e[Yi]||null}var yd=[],Rs=-1;function dn(e){return{current:e}}function ve(e){0>Rs||(e.current=yd[Rs],yd[Rs]=null,Rs--)}function he(e,t){Rs++,yd[Rs]=e.current,e.current=t}var cn={},rt=dn(cn),ut=dn(!1),Mn=cn;function zs(e,t){var r=e.type.contextTypes;if(!r)return cn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function pt(e){return e=e.childContextTypes,e!=null}function Pa(){ve(ut),ve(rt)}function Eh(e,t,r){if(rt.current!==cn)throw Error(k(168));he(rt,t),he(ut,r)}function rv(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(k(108,h1(e)||"Unknown",s));return Re({},r,n)}function xa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||cn,Mn=rt.current,he(rt,e),he(ut,ut.current),!0}function Dh(e,t,r){var n=e.stateNode;if(!n)throw Error(k(169));r?(e=rv(e,t,Mn),n.__reactInternalMemoizedMergedChildContext=e,ve(ut),ve(rt),he(rt,e)):ve(ut),he(ut,r)}var Cr=null,Rc=!1,Tl=!1;function nv(e){Cr===null?Cr=[e]:Cr.push(e)}function Lb(e){Rc=!0,nv(e)}function un(){if(!Tl&&Cr!==null){Tl=!0;var e=0,t=ae;try{var r=Cr;for(ae=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Cr=null,Rc=!1}catch(s){throw Cr!==null&&(Cr=Cr.slice(e+1)),Dg(Nu,un),s}finally{ae=t,Tl=!1}}return null}var bs=[],Cs=0,La=null,Ia=0,kt=[],Tt=0,On=null,kr=1,Tr="";function mn(e,t){bs[Cs++]=Ia,bs[Cs++]=La,La=e,Ia=t}function sv(e,t,r){kt[Tt++]=kr,kt[Tt++]=Tr,kt[Tt++]=On,On=e;var n=kr;e=Tr;var s=32-Bt(n)-1;n&=~(1<<s),r+=1;var i=32-Bt(t)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,kr=1<<32-Bt(t)+s|r<<s|n,Tr=i+e}else kr=1<<i|r<<s|n,Tr=e}function Vu(e){e.return!==null&&(mn(e,1),sv(e,1,0))}function Ku(e){for(;e===La;)La=bs[--Cs],bs[Cs]=null,Ia=bs[--Cs],bs[Cs]=null;for(;e===On;)On=kt[--Tt],kt[Tt]=null,Tr=kt[--Tt],kt[Tt]=null,kr=kt[--Tt],kt[Tt]=null}var yt=null,_t=null,_e=!1,$t=null;function iv(e,t){var r=Et(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Ph(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,yt=e,_t=tn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,yt=e,_t=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=On!==null?{id:kr,overflow:Tr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Et(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,yt=e,_t=null,!0):!1;default:return!1}}function wd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Sd(e){if(_e){var t=_t;if(t){var r=t;if(!Ph(e,t)){if(wd(e))throw Error(k(418));t=tn(r.nextSibling);var n=yt;t&&Ph(e,t)?iv(n,r):(e.flags=e.flags&-4097|2,_e=!1,yt=e)}}else{if(wd(e))throw Error(k(418));e.flags=e.flags&-4097|2,_e=!1,yt=e}}}function xh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;yt=e}function Jo(e){if(e!==yt)return!1;if(!_e)return xh(e),_e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!gd(e.type,e.memoizedProps)),t&&(t=_t)){if(wd(e))throw ov(),Error(k(418));for(;t;)iv(e,t),t=tn(t.nextSibling)}if(xh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(k(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_t=tn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_t=null}}else _t=yt?tn(e.stateNode.nextSibling):null;return!0}function ov(){for(var e=_t;e;)e=tn(e.nextSibling)}function Bs(){_t=yt=null,_e=!1}function Qu(e){$t===null?$t=[e]:$t.push(e)}var Ib=Ir.ReactCurrentBatchConfig;function Ri(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(k(309));var n=r.stateNode}if(!n)throw Error(k(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(k(284));if(!r._owner)throw Error(k(290,e))}return e}function Zo(e,t){throw e=Object.prototype.toString.call(t),Error(k(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Lh(e){var t=e._init;return t(e._payload)}function av(e){function t(m,v){if(e){var h=m.deletions;h===null?(m.deletions=[v],m.flags|=16):h.push(v)}}function r(m,v){if(!e)return null;for(;v!==null;)t(m,v),v=v.sibling;return null}function n(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function s(m,v){return m=on(m,v),m.index=0,m.sibling=null,m}function i(m,v,h){return m.index=h,e?(h=m.alternate,h!==null?(h=h.index,h<v?(m.flags|=2,v):h):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function a(m,v,h,_){return v===null||v.tag!==6?(v=Ml(h,m.mode,_),v.return=m,v):(v=s(v,h),v.return=m,v)}function c(m,v,h,_){var S=h.type;return S===vs?u(m,v,h.props.children,_,h.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ur&&Lh(S)===v.type)?(_=s(v,h.props),_.ref=Ri(m,v,h),_.return=m,_):(_=ya(h.type,h.key,h.props,null,m.mode,_),_.ref=Ri(m,v,h),_.return=m,_)}function l(m,v,h,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==h.containerInfo||v.stateNode.implementation!==h.implementation?(v=Ol(h,m.mode,_),v.return=m,v):(v=s(v,h.children||[]),v.return=m,v)}function u(m,v,h,_,S){return v===null||v.tag!==7?(v=xn(h,m.mode,_,S),v.return=m,v):(v=s(v,h),v.return=m,v)}function d(m,v,h){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Ml(""+v,m.mode,h),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Uo:return h=ya(v.type,v.key,v.props,null,m.mode,h),h.ref=Ri(m,null,v),h.return=m,h;case gs:return v=Ol(v,m.mode,h),v.return=m,v;case Ur:var _=v._init;return d(m,_(v._payload),h)}if(Ei(v)||vi(v))return v=xn(v,m.mode,h,null),v.return=m,v;Zo(m,v)}return null}function p(m,v,h,_){var S=v!==null?v.key:null;if(typeof h=="string"&&h!==""||typeof h=="number")return S!==null?null:a(m,v,""+h,_);if(typeof h=="object"&&h!==null){switch(h.$$typeof){case Uo:return h.key===S?c(m,v,h,_):null;case gs:return h.key===S?l(m,v,h,_):null;case Ur:return S=h._init,p(m,v,S(h._payload),_)}if(Ei(h)||vi(h))return S!==null?null:u(m,v,h,_,null);Zo(m,h)}return null}function f(m,v,h,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return m=m.get(h)||null,a(v,m,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Uo:return m=m.get(_.key===null?h:_.key)||null,c(v,m,_,S);case gs:return m=m.get(_.key===null?h:_.key)||null,l(v,m,_,S);case Ur:var R=_._init;return f(m,v,h,R(_._payload),S)}if(Ei(_)||vi(_))return m=m.get(h)||null,u(v,m,_,S,null);Zo(v,_)}return null}function y(m,v,h,_){for(var S=null,R=null,E=v,x=v=0,C=null;E!==null&&x<h.length;x++){E.index>x?(C=E,E=null):C=E.sibling;var B=p(m,E,h[x],_);if(B===null){E===null&&(E=C);break}e&&E&&B.alternate===null&&t(m,E),v=i(B,v,x),R===null?S=B:R.sibling=B,R=B,E=C}if(x===h.length)return r(m,E),_e&&mn(m,x),S;if(E===null){for(;x<h.length;x++)E=d(m,h[x],_),E!==null&&(v=i(E,v,x),R===null?S=E:R.sibling=E,R=E);return _e&&mn(m,x),S}for(E=n(m,E);x<h.length;x++)C=f(E,m,x,h[x],_),C!==null&&(e&&C.alternate!==null&&E.delete(C.key===null?x:C.key),v=i(C,v,x),R===null?S=C:R.sibling=C,R=C);return e&&E.forEach(function(M){return t(m,M)}),_e&&mn(m,x),S}function w(m,v,h,_){var S=vi(h);if(typeof S!="function")throw Error(k(150));if(h=S.call(h),h==null)throw Error(k(151));for(var R=S=null,E=v,x=v=0,C=null,B=h.next();E!==null&&!B.done;x++,B=h.next()){E.index>x?(C=E,E=null):C=E.sibling;var M=p(m,E,B.value,_);if(M===null){E===null&&(E=C);break}e&&E&&M.alternate===null&&t(m,E),v=i(M,v,x),R===null?S=M:R.sibling=M,R=M,E=C}if(B.done)return r(m,E),_e&&mn(m,x),S;if(E===null){for(;!B.done;x++,B=h.next())B=d(m,B.value,_),B!==null&&(v=i(B,v,x),R===null?S=B:R.sibling=B,R=B);return _e&&mn(m,x),S}for(E=n(m,E);!B.done;x++,B=h.next())B=f(E,m,x,B.value,_),B!==null&&(e&&B.alternate!==null&&E.delete(B.key===null?x:B.key),v=i(B,v,x),R===null?S=B:R.sibling=B,R=B);return e&&E.forEach(function(Z){return t(m,Z)}),_e&&mn(m,x),S}function b(m,v,h,_){if(typeof h=="object"&&h!==null&&h.type===vs&&h.key===null&&(h=h.props.children),typeof h=="object"&&h!==null){switch(h.$$typeof){case Uo:e:{for(var S=h.key,R=v;R!==null;){if(R.key===S){if(S=h.type,S===vs){if(R.tag===7){r(m,R.sibling),v=s(R,h.props.children),v.return=m,m=v;break e}}else if(R.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ur&&Lh(S)===R.type){r(m,R.sibling),v=s(R,h.props),v.ref=Ri(m,R,h),v.return=m,m=v;break e}r(m,R);break}else t(m,R);R=R.sibling}h.type===vs?(v=xn(h.props.children,m.mode,_,h.key),v.return=m,m=v):(_=ya(h.type,h.key,h.props,null,m.mode,_),_.ref=Ri(m,v,h),_.return=m,m=_)}return o(m);case gs:e:{for(R=h.key;v!==null;){if(v.key===R)if(v.tag===4&&v.stateNode.containerInfo===h.containerInfo&&v.stateNode.implementation===h.implementation){r(m,v.sibling),v=s(v,h.children||[]),v.return=m,m=v;break e}else{r(m,v);break}else t(m,v);v=v.sibling}v=Ol(h,m.mode,_),v.return=m,m=v}return o(m);case Ur:return R=h._init,b(m,v,R(h._payload),_)}if(Ei(h))return y(m,v,h,_);if(vi(h))return w(m,v,h,_);Zo(m,h)}return typeof h=="string"&&h!==""||typeof h=="number"?(h=""+h,v!==null&&v.tag===6?(r(m,v.sibling),v=s(v,h),v.return=m,m=v):(r(m,v),v=Ml(h,m.mode,_),v.return=m,m=v),o(m)):r(m,v)}return b}var Us=av(!0),cv=av(!1),Ma=dn(null),Oa=null,ks=null,Wu=null;function qu(){Wu=ks=Oa=null}function Gu(e){var t=Ma.current;ve(Ma),e._currentValue=t}function Rd(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ms(e,t){Oa=e,Wu=ks=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(dt=!0),e.firstContext=null)}function xt(e){var t=e._currentValue;if(Wu!==e)if(e={context:e,memoizedValue:t,next:null},ks===null){if(Oa===null)throw Error(k(308));ks=e,Oa.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var yn=null;function Yu(e){yn===null?yn=[e]:yn.push(e)}function lv(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Yu(t)):(r.next=s.next,s.next=r),t.interleaved=r,xr(e,n)}function xr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Hr=!1;function Xu(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Er(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,te&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,xr(e,r)}return s=n.interleaved,s===null?(t.next=t,Yu(n)):(t.next=s.next,s.next=t),n.interleaved=t,xr(e,r)}function fa(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Au(e,r)}}function Ih(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Na(e,t,r,n){var s=e.updateQueue;Hr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?i=l:o.next=l,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(i!==null){var d=s.baseState;o=0,u=l=c=null,a=i;do{var p=a.lane,f=a.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,w=a;switch(p=t,f=r,w.tag){case 1:if(y=w.payload,typeof y=="function"){d=y.call(f,d,p);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,p=typeof y=="function"?y.call(f,d,p):y,p==null)break e;d=Re({},d,p);break e;case 2:Hr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else f={eventTime:f,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=f,c=d):u=u.next=f,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=d),s.baseState=c,s.firstBaseUpdate=l,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);An|=o,e.lanes=o,e.memoizedState=d}}function Mh(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(k(191,s));s.call(n)}}}var go={},cr=dn(go),Xi=dn(go),Ji=dn(go);function wn(e){if(e===go)throw Error(k(174));return e}function Ju(e,t){switch(he(Ji,t),he(Xi,e),he(cr,go),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rd(t,e)}ve(cr),he(cr,t)}function Hs(){ve(cr),ve(Xi),ve(Ji)}function uv(e){wn(Ji.current);var t=wn(cr.current),r=rd(t,e.type);t!==r&&(he(Xi,e),he(cr,r))}function Zu(e){Xi.current===e&&(ve(cr),ve(Xi))}var we=dn(0);function Aa(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var El=[];function ep(){for(var e=0;e<El.length;e++)El[e]._workInProgressVersionPrimary=null;El.length=0}var ha=Ir.ReactCurrentDispatcher,Dl=Ir.ReactCurrentBatchConfig,Nn=0,Se=null,Ne=null,je=null,ja=!1,Ai=!1,Zi=0,Mb=0;function Je(){throw Error(k(321))}function tp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ht(e[r],t[r]))return!1;return!0}function rp(e,t,r,n,s,i){if(Nn=i,Se=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ha.current=e===null||e.memoizedState===null?jb:$b,e=r(n,s),Ai){i=0;do{if(Ai=!1,Zi=0,25<=i)throw Error(k(301));i+=1,je=Ne=null,t.updateQueue=null,ha.current=Fb,e=r(n,s)}while(Ai)}if(ha.current=$a,t=Ne!==null&&Ne.next!==null,Nn=0,je=Ne=Se=null,ja=!1,t)throw Error(k(300));return e}function np(){var e=Zi!==0;return Zi=0,e}function rr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return je===null?Se.memoizedState=je=e:je=je.next=e,je}function Lt(){if(Ne===null){var e=Se.alternate;e=e!==null?e.memoizedState:null}else e=Ne.next;var t=je===null?Se.memoizedState:je.next;if(t!==null)je=t,Ne=e;else{if(e===null)throw Error(k(310));Ne=e,e={memoizedState:Ne.memoizedState,baseState:Ne.baseState,baseQueue:Ne.baseQueue,queue:Ne.queue,next:null},je===null?Se.memoizedState=je=e:je=je.next=e}return je}function eo(e,t){return typeof t=="function"?t(e):t}function Pl(e){var t=Lt(),r=t.queue;if(r===null)throw Error(k(311));r.lastRenderedReducer=e;var n=Ne,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,c=null,l=i;do{var u=l.lane;if((Nn&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var d={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=d,o=n):c=c.next=d,Se.lanes|=u,An|=u}l=l.next}while(l!==null&&l!==i);c===null?o=n:c.next=a,Ht(n,t.memoizedState)||(dt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Se.lanes|=i,An|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function xl(e){var t=Lt(),r=t.queue;if(r===null)throw Error(k(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Ht(i,t.memoizedState)||(dt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function pv(){}function fv(e,t){var r=Se,n=Lt(),s=t(),i=!Ht(n.memoizedState,s);if(i&&(n.memoizedState=s,dt=!0),n=n.queue,sp(gv.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||je!==null&&je.memoizedState.tag&1){if(r.flags|=2048,to(9,mv.bind(null,r,n,s,t),void 0,null),$e===null)throw Error(k(349));Nn&30||hv(r,t,s)}return s}function hv(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Se.updateQueue,t===null?(t={lastEffect:null,stores:null},Se.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function mv(e,t,r,n){t.value=r,t.getSnapshot=n,vv(t)&&_v(e)}function gv(e,t,r){return r(function(){vv(t)&&_v(e)})}function vv(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ht(e,r)}catch{return!0}}function _v(e){var t=xr(e,1);t!==null&&Ut(t,e,1,-1)}function Oh(e){var t=rr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:e},t.queue=e,e=e.dispatch=Ab.bind(null,Se,e),[t.memoizedState,e]}function to(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Se.updateQueue,t===null?(t={lastEffect:null,stores:null},Se.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function yv(){return Lt().memoizedState}function ma(e,t,r,n){var s=rr();Se.flags|=e,s.memoizedState=to(1|t,r,void 0,n===void 0?null:n)}function bc(e,t,r,n){var s=Lt();n=n===void 0?null:n;var i=void 0;if(Ne!==null){var o=Ne.memoizedState;if(i=o.destroy,n!==null&&tp(n,o.deps)){s.memoizedState=to(t,r,i,n);return}}Se.flags|=e,s.memoizedState=to(1|t,r,i,n)}function Nh(e,t){return ma(8390656,8,e,t)}function sp(e,t){return bc(2048,8,e,t)}function wv(e,t){return bc(4,2,e,t)}function Sv(e,t){return bc(4,4,e,t)}function Rv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function bv(e,t,r){return r=r!=null?r.concat([e]):null,bc(4,4,Rv.bind(null,t,e),r)}function ip(){}function Cv(e,t){var r=Lt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function kv(e,t){var r=Lt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&tp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Tv(e,t,r){return Nn&21?(Ht(r,t)||(r=Lg(),Se.lanes|=r,An|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dt=!0),e.memoizedState=r)}function Ob(e,t){var r=ae;ae=r!==0&&4>r?r:4,e(!0);var n=Dl.transition;Dl.transition={};try{e(!1),t()}finally{ae=r,Dl.transition=n}}function Ev(){return Lt().memoizedState}function Nb(e,t,r){var n=sn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Dv(e))Pv(t,r);else if(r=lv(e,t,r,n),r!==null){var s=it();Ut(r,e,n,s),xv(r,t,n)}}function Ab(e,t,r){var n=sn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Dv(e))Pv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,a=i(o,r);if(s.hasEagerState=!0,s.eagerState=a,Ht(a,o)){var c=t.interleaved;c===null?(s.next=s,Yu(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=lv(e,t,s,n),r!==null&&(s=it(),Ut(r,e,n,s),xv(r,t,n))}}function Dv(e){var t=e.alternate;return e===Se||t!==null&&t===Se}function Pv(e,t){Ai=ja=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function xv(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Au(e,r)}}var $a={readContext:xt,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useInsertionEffect:Je,useLayoutEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useMutableSource:Je,useSyncExternalStore:Je,useId:Je,unstable_isNewReconciler:!1},jb={readContext:xt,useCallback:function(e,t){return rr().memoizedState=[e,t===void 0?null:t],e},useContext:xt,useEffect:Nh,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ma(4194308,4,Rv.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ma(4194308,4,e,t)},useInsertionEffect:function(e,t){return ma(4,2,e,t)},useMemo:function(e,t){var r=rr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=rr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Nb.bind(null,Se,e),[n.memoizedState,e]},useRef:function(e){var t=rr();return e={current:e},t.memoizedState=e},useState:Oh,useDebugValue:ip,useDeferredValue:function(e){return rr().memoizedState=e},useTransition:function(){var e=Oh(!1),t=e[0];return e=Ob.bind(null,e[1]),rr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Se,s=rr();if(_e){if(r===void 0)throw Error(k(407));r=r()}else{if(r=t(),$e===null)throw Error(k(349));Nn&30||hv(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Nh(gv.bind(null,n,i,e),[e]),n.flags|=2048,to(9,mv.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=rr(),t=$e.identifierPrefix;if(_e){var r=Tr,n=kr;r=(n&~(1<<32-Bt(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Zi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Mb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$b={readContext:xt,useCallback:Cv,useContext:xt,useEffect:sp,useImperativeHandle:bv,useInsertionEffect:wv,useLayoutEffect:Sv,useMemo:kv,useReducer:Pl,useRef:yv,useState:function(){return Pl(eo)},useDebugValue:ip,useDeferredValue:function(e){var t=Lt();return Tv(t,Ne.memoizedState,e)},useTransition:function(){var e=Pl(eo)[0],t=Lt().memoizedState;return[e,t]},useMutableSource:pv,useSyncExternalStore:fv,useId:Ev,unstable_isNewReconciler:!1},Fb={readContext:xt,useCallback:Cv,useContext:xt,useEffect:sp,useImperativeHandle:bv,useInsertionEffect:wv,useLayoutEffect:Sv,useMemo:kv,useReducer:xl,useRef:yv,useState:function(){return xl(eo)},useDebugValue:ip,useDeferredValue:function(e){var t=Lt();return Ne===null?t.memoizedState=e:Tv(t,Ne.memoizedState,e)},useTransition:function(){var e=xl(eo)[0],t=Lt().memoizedState;return[e,t]},useMutableSource:pv,useSyncExternalStore:fv,useId:Ev,unstable_isNewReconciler:!1};function Nt(e,t){if(e&&e.defaultProps){t=Re({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function bd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Re({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Cc={isMounted:function(e){return(e=e._reactInternals)?Un(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=it(),s=sn(e),i=Er(n,s);i.payload=t,r!=null&&(i.callback=r),t=rn(e,i,s),t!==null&&(Ut(t,e,s,n),fa(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=it(),s=sn(e),i=Er(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=rn(e,i,s),t!==null&&(Ut(t,e,s,n),fa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=it(),n=sn(e),s=Er(r,n);s.tag=2,t!=null&&(s.callback=t),t=rn(e,s,n),t!==null&&(Ut(t,e,n,r),fa(t,e,n))}};function Ah(e,t,r,n,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!Wi(r,n)||!Wi(s,i):!0}function Lv(e,t,r){var n=!1,s=cn,i=t.contextType;return typeof i=="object"&&i!==null?i=xt(i):(s=pt(t)?Mn:rt.current,n=t.contextTypes,i=(n=n!=null)?zs(e,s):cn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function jh(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Cc.enqueueReplaceState(t,t.state,null)}function Cd(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Xu(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=xt(i):(i=pt(t)?Mn:rt.current,s.context=zs(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(bd(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Cc.enqueueReplaceState(s,s.state,null),Na(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Vs(e,t){try{var r="",n=t;do r+=f1(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ll(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function kd(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zb=typeof WeakMap=="function"?WeakMap:Map;function Iv(e,t,r){r=Er(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){za||(za=!0,Nd=n),kd(e,t)},r}function Mv(e,t,r){r=Er(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){kd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){kd(e,t),typeof n!="function"&&(nn===null?nn=new Set([this]):nn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function $h(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zb;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=eC.bind(null,e,t,r),t.then(e,e))}function Fh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function zh(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Er(-1,1),t.tag=2,rn(r,t,1))),r.lanes|=1),e)}var Bb=Ir.ReactCurrentOwner,dt=!1;function st(e,t,r,n){t.child=e===null?cv(t,null,r,n):Us(t,e.child,r,n)}function Bh(e,t,r,n,s){r=r.render;var i=t.ref;return Ms(t,s),n=rp(e,t,r,n,i,s),r=np(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Lr(e,t,s)):(_e&&r&&Vu(t),t.flags|=1,st(e,t,n,s),t.child)}function Uh(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!fp(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Ov(e,t,i,n,s)):(e=ya(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Wi,r(o,n)&&e.ref===t.ref)return Lr(e,t,s)}return t.flags|=1,e=on(i,n),e.ref=t.ref,e.return=t,t.child=e}function Ov(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(Wi(i,n)&&e.ref===t.ref)if(dt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(dt=!0);else return t.lanes=e.lanes,Lr(e,t,s)}return Td(e,t,r,n,s)}function Nv(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(Es,vt),vt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,he(Es,vt),vt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,he(Es,vt),vt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,he(Es,vt),vt|=n;return st(e,t,s,r),t.child}function Av(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Td(e,t,r,n,s){var i=pt(r)?Mn:rt.current;return i=zs(t,i),Ms(t,s),r=rp(e,t,r,n,i,s),n=np(),e!==null&&!dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Lr(e,t,s)):(_e&&n&&Vu(t),t.flags|=1,st(e,t,r,s),t.child)}function Hh(e,t,r,n,s){if(pt(r)){var i=!0;xa(t)}else i=!1;if(Ms(t,s),t.stateNode===null)ga(e,t),Lv(t,r,n),Cd(t,r,n,s),n=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var c=o.context,l=r.contextType;typeof l=="object"&&l!==null?l=xt(l):(l=pt(r)?Mn:rt.current,l=zs(t,l));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&jh(t,o,n,l),Hr=!1;var p=t.memoizedState;o.state=p,Na(t,n,o,s),c=t.memoizedState,a!==n||p!==c||ut.current||Hr?(typeof u=="function"&&(bd(t,r,u,n),c=t.memoizedState),(a=Hr||Ah(t,r,a,n,p,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=l,n=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,dv(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Nt(t.type,a),o.props=l,d=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=xt(c):(c=pt(r)?Mn:rt.current,c=zs(t,c));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||p!==c)&&jh(t,o,n,c),Hr=!1,p=t.memoizedState,o.state=p,Na(t,n,o,s);var y=t.memoizedState;a!==d||p!==y||ut.current||Hr?(typeof f=="function"&&(bd(t,r,f,n),y=t.memoizedState),(l=Hr||Ah(t,r,l,n,p,y,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=l):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Ed(e,t,r,n,i,s)}function Ed(e,t,r,n,s,i){Av(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return s&&Dh(t,r,!1),Lr(e,t,i);n=t.stateNode,Bb.current=t;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Us(t,e.child,null,i),t.child=Us(t,null,a,i)):st(e,t,a,i),t.memoizedState=n.state,s&&Dh(t,r,!0),t.child}function jv(e){var t=e.stateNode;t.pendingContext?Eh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Eh(e,t.context,!1),Ju(e,t.containerInfo)}function Vh(e,t,r,n,s){return Bs(),Qu(s),t.flags|=256,st(e,t,r,n),t.child}var Dd={dehydrated:null,treeContext:null,retryLane:0};function Pd(e){return{baseLanes:e,cachePool:null,transitions:null}}function $v(e,t,r){var n=t.pendingProps,s=we.current,i=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),he(we,s&1),e===null)return Sd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ec(o,n,0,null),e=xn(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Pd(r),t.memoizedState=Dd,e):op(t,o));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Ub(e,t,o,n,a,s,r);if(i){i=n.fallback,o=t.mode,s=e.child,a=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=on(s,c),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=on(a,i):(i=xn(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Pd(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Dd,n}return i=e.child,e=i.sibling,n=on(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function op(e,t){return t=Ec({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ea(e,t,r,n){return n!==null&&Qu(n),Us(t,e.child,null,r),e=op(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ub(e,t,r,n,s,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Ll(Error(k(422))),ea(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Ec({mode:"visible",children:n.children},s,0,null),i=xn(i,s,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Us(t,e.child,null,o),t.child.memoizedState=Pd(o),t.memoizedState=Dd,i);if(!(t.mode&1))return ea(e,t,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(k(419)),n=Ll(i,n,void 0),ea(e,t,o,n)}if(a=(o&e.childLanes)!==0,dt||a){if(n=$e,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xr(e,s),Ut(n,e,s,-1))}return pp(),n=Ll(Error(k(421))),ea(e,t,o,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=tC.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,_t=tn(s.nextSibling),yt=t,_e=!0,$t=null,e!==null&&(kt[Tt++]=kr,kt[Tt++]=Tr,kt[Tt++]=On,kr=e.id,Tr=e.overflow,On=t),t=op(t,n.children),t.flags|=4096,t)}function Kh(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Rd(e.return,t,r)}function Il(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Fv(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(st(e,t,n.children,r),n=we.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Kh(e,r,t);else if(e.tag===19)Kh(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(he(we,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Aa(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Il(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Aa(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Il(t,!0,r,null,i);break;case"together":Il(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ga(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Lr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),An|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(k(153));if(t.child!==null){for(e=t.child,r=on(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=on(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Hb(e,t,r){switch(t.tag){case 3:jv(t),Bs();break;case 5:uv(t);break;case 1:pt(t.type)&&xa(t);break;case 4:Ju(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;he(Ma,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(he(we,we.current&1),t.flags|=128,null):r&t.child.childLanes?$v(e,t,r):(he(we,we.current&1),e=Lr(e,t,r),e!==null?e.sibling:null);he(we,we.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Fv(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),he(we,we.current),n)break;return null;case 22:case 23:return t.lanes=0,Nv(e,t,r)}return Lr(e,t,r)}var zv,xd,Bv,Uv;zv=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};xd=function(){};Bv=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,wn(cr.current);var i=null;switch(r){case"input":s=Jl(e,s),n=Jl(e,n),i=[];break;case"select":s=Re({},s,{value:void 0}),n=Re({},n,{value:void 0}),i=[];break;case"textarea":s=td(e,s),n=td(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Da)}nd(r,n);var o;r=null;for(l in s)if(!n.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var a=s[l];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(zi.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in n){var c=n[l];if(a=s!=null?s[l]:void 0,n.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(zi.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&ge("scroll",e),i||a===c||(i=[])):(i=i||[]).push(l,c))}r&&(i=i||[]).push("style",r);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};Uv=function(e,t,r,n){r!==n&&(t.flags|=4)};function bi(e,t){if(!_e)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ze(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Vb(e,t,r){var n=t.pendingProps;switch(Ku(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(t),null;case 1:return pt(t.type)&&Pa(),Ze(t),null;case 3:return n=t.stateNode,Hs(),ve(ut),ve(rt),ep(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Jo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$t!==null&&($d($t),$t=null))),xd(e,t),Ze(t),null;case 5:Zu(t);var s=wn(Ji.current);if(r=t.type,e!==null&&t.stateNode!=null)Bv(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(k(166));return Ze(t),null}if(e=wn(cr.current),Jo(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[ir]=t,n[Yi]=i,e=(t.mode&1)!==0,r){case"dialog":ge("cancel",n),ge("close",n);break;case"iframe":case"object":case"embed":ge("load",n);break;case"video":case"audio":for(s=0;s<Pi.length;s++)ge(Pi[s],n);break;case"source":ge("error",n);break;case"img":case"image":case"link":ge("error",n),ge("load",n);break;case"details":ge("toggle",n);break;case"input":eh(n,i),ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},ge("invalid",n);break;case"textarea":rh(n,i),ge("invalid",n)}nd(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&Xo(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Xo(n.textContent,a,e),s=["children",""+a]):zi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ge("scroll",n)}switch(r){case"input":Ho(n),th(n,i,!0);break;case"textarea":Ho(n),nh(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Da)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[ir]=t,e[Yi]=n,zv(e,t,!1,!1),t.stateNode=e;e:{switch(o=sd(r,n),r){case"dialog":ge("cancel",e),ge("close",e),s=n;break;case"iframe":case"object":case"embed":ge("load",e),s=n;break;case"video":case"audio":for(s=0;s<Pi.length;s++)ge(Pi[s],e);s=n;break;case"source":ge("error",e),s=n;break;case"img":case"image":case"link":ge("error",e),ge("load",e),s=n;break;case"details":ge("toggle",e),s=n;break;case"input":eh(e,n),s=Jl(e,n),ge("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Re({},n,{value:void 0}),ge("invalid",e);break;case"textarea":rh(e,n),s=td(e,n),ge("invalid",e);break;default:s=n}nd(r,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?yg(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vg(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Bi(e,c):typeof c=="number"&&Bi(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zi.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ge("scroll",e):c!=null&&xu(e,i,c,o))}switch(r){case"input":Ho(e),th(e,n,!1);break;case"textarea":Ho(e),nh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+an(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ps(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ps(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Da)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ze(t),null;case 6:if(e&&t.stateNode!=null)Uv(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(k(166));if(r=wn(Ji.current),wn(cr.current),Jo(t)){if(n=t.stateNode,r=t.memoizedProps,n[ir]=t,(i=n.nodeValue!==r)&&(e=yt,e!==null))switch(e.tag){case 3:Xo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xo(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ir]=t,t.stateNode=n}return Ze(t),null;case 13:if(ve(we),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_e&&_t!==null&&t.mode&1&&!(t.flags&128))ov(),Bs(),t.flags|=98560,i=!1;else if(i=Jo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(k(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(k(317));i[ir]=t}else Bs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ze(t),i=!1}else $t!==null&&($d($t),$t=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||we.current&1?Ae===0&&(Ae=3):pp())),t.updateQueue!==null&&(t.flags|=4),Ze(t),null);case 4:return Hs(),xd(e,t),e===null&&qi(t.stateNode.containerInfo),Ze(t),null;case 10:return Gu(t.type._context),Ze(t),null;case 17:return pt(t.type)&&Pa(),Ze(t),null;case 19:if(ve(we),i=t.memoizedState,i===null)return Ze(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)bi(i,!1);else{if(Ae!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Aa(e),o!==null){for(t.flags|=128,bi(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return he(we,we.current&1|2),t.child}e=e.sibling}i.tail!==null&&Pe()>Ks&&(t.flags|=128,n=!0,bi(i,!1),t.lanes=4194304)}else{if(!n)if(e=Aa(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!_e)return Ze(t),null}else 2*Pe()-i.renderingStartTime>Ks&&r!==1073741824&&(t.flags|=128,n=!0,bi(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Pe(),t.sibling=null,r=we.current,he(we,n?r&1|2:r&1),t):(Ze(t),null);case 22:case 23:return up(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?vt&1073741824&&(Ze(t),t.subtreeFlags&6&&(t.flags|=8192)):Ze(t),null;case 24:return null;case 25:return null}throw Error(k(156,t.tag))}function Kb(e,t){switch(Ku(t),t.tag){case 1:return pt(t.type)&&Pa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hs(),ve(ut),ve(rt),ep(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zu(t),null;case 13:if(ve(we),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(k(340));Bs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ve(we),null;case 4:return Hs(),null;case 10:return Gu(t.type._context),null;case 22:case 23:return up(),null;case 24:return null;default:return null}}var ta=!1,et=!1,Qb=typeof WeakSet=="function"?WeakSet:Set,P=null;function Ts(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Te(e,t,n)}else r.current=null}function Ld(e,t,r){try{r()}catch(n){Te(e,t,n)}}var Qh=!1;function Wb(e,t){if(hd=ka,e=Wg(),Hu(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,l=0,u=0,d=e,p=null;t:for(;;){for(var f;d!==r||s!==0&&d.nodeType!==3||(a=o+s),d!==i||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===e)break t;if(p===r&&++l===s&&(a=o),p===i&&++u===n&&(c=o),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(md={focusedElem:e,selectionRange:r},ka=!1,P=t;P!==null;)if(t=P,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,P=e;else for(;P!==null;){t=P;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,b=y.memoizedState,m=t.stateNode,v=m.getSnapshotBeforeUpdate(t.elementType===t.type?w:Nt(t.type,w),b);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var h=t.stateNode.containerInfo;h.nodeType===1?h.textContent="":h.nodeType===9&&h.documentElement&&h.removeChild(h.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(k(163))}}catch(_){Te(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,P=e;break}P=t.return}return y=Qh,Qh=!1,y}function ji(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ld(t,r,i)}s=s.next}while(s!==n)}}function kc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Id(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Hv(e){var t=e.alternate;t!==null&&(e.alternate=null,Hv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ir],delete t[Yi],delete t[_d],delete t[Pb],delete t[xb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Vv(e){return e.tag===5||e.tag===3||e.tag===4}function Wh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Vv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Md(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Da));else if(n!==4&&(e=e.child,e!==null))for(Md(e,t,r),e=e.sibling;e!==null;)Md(e,t,r),e=e.sibling}function Od(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Od(e,t,r),e=e.sibling;e!==null;)Od(e,t,r),e=e.sibling}var Be=null,jt=!1;function Br(e,t,r){for(r=r.child;r!==null;)Kv(e,t,r),r=r.sibling}function Kv(e,t,r){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(vc,r)}catch{}switch(r.tag){case 5:et||Ts(r,t);case 6:var n=Be,s=jt;Be=null,Br(e,t,r),Be=n,jt=s,Be!==null&&(jt?(e=Be,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Be.removeChild(r.stateNode));break;case 18:Be!==null&&(jt?(e=Be,r=r.stateNode,e.nodeType===8?kl(e.parentNode,r):e.nodeType===1&&kl(e,r),Ki(e)):kl(Be,r.stateNode));break;case 4:n=Be,s=jt,Be=r.stateNode.containerInfo,jt=!0,Br(e,t,r),Be=n,jt=s;break;case 0:case 11:case 14:case 15:if(!et&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Ld(r,t,o),s=s.next}while(s!==n)}Br(e,t,r);break;case 1:if(!et&&(Ts(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Te(r,t,a)}Br(e,t,r);break;case 21:Br(e,t,r);break;case 22:r.mode&1?(et=(n=et)||r.memoizedState!==null,Br(e,t,r),et=n):Br(e,t,r);break;default:Br(e,t,r)}}function qh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Qb),t.forEach(function(n){var s=rC.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ot(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Be=a.stateNode,jt=!1;break e;case 3:Be=a.stateNode.containerInfo,jt=!0;break e;case 4:Be=a.stateNode.containerInfo,jt=!0;break e}a=a.return}if(Be===null)throw Error(k(160));Kv(i,o,s),Be=null,jt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(l){Te(s,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qv(t,e),t=t.sibling}function Qv(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ot(t,e),tr(e),n&4){try{ji(3,e,e.return),kc(3,e)}catch(w){Te(e,e.return,w)}try{ji(5,e,e.return)}catch(w){Te(e,e.return,w)}}break;case 1:Ot(t,e),tr(e),n&512&&r!==null&&Ts(r,r.return);break;case 5:if(Ot(t,e),tr(e),n&512&&r!==null&&Ts(r,r.return),e.flags&32){var s=e.stateNode;try{Bi(s,"")}catch(w){Te(e,e.return,w)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&hg(s,i),sd(a,o);var l=sd(a,i);for(o=0;o<c.length;o+=2){var u=c[o],d=c[o+1];u==="style"?yg(s,d):u==="dangerouslySetInnerHTML"?vg(s,d):u==="children"?Bi(s,d):xu(s,u,d,l)}switch(a){case"input":Zl(s,i);break;case"textarea":mg(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Ps(s,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Ps(s,!!i.multiple,i.defaultValue,!0):Ps(s,!!i.multiple,i.multiple?[]:"",!1))}s[Yi]=i}catch(w){Te(e,e.return,w)}}break;case 6:if(Ot(t,e),tr(e),n&4){if(e.stateNode===null)throw Error(k(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(w){Te(e,e.return,w)}}break;case 3:if(Ot(t,e),tr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ki(t.containerInfo)}catch(w){Te(e,e.return,w)}break;case 4:Ot(t,e),tr(e);break;case 13:Ot(t,e),tr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(lp=Pe())),n&4&&qh(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(et=(l=et)||u,Ot(t,e),et=l):Ot(t,e),tr(e),n&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(P=e,u=e.child;u!==null;){for(d=P=u;P!==null;){switch(p=P,f=p.child,p.tag){case 0:case 11:case 14:case 15:ji(4,p,p.return);break;case 1:Ts(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(w){Te(n,r,w)}}break;case 5:Ts(p,p.return);break;case 22:if(p.memoizedState!==null){Yh(d);continue}}f!==null?(f.return=p,P=f):Yh(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,l?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=_g("display",o))}catch(w){Te(e,e.return,w)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(w){Te(e,e.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ot(t,e),tr(e),n&4&&qh(e);break;case 21:break;default:Ot(t,e),tr(e)}}function tr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Vv(r)){var n=r;break e}r=r.return}throw Error(k(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Bi(s,""),n.flags&=-33);var i=Wh(e);Od(e,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=Wh(e);Md(e,a,o);break;default:throw Error(k(161))}}catch(c){Te(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function qb(e,t,r){P=e,Wv(e)}function Wv(e,t,r){for(var n=(e.mode&1)!==0;P!==null;){var s=P,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||ta;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||et;a=ta;var l=et;if(ta=o,(et=c)&&!l)for(P=s;P!==null;)o=P,c=o.child,o.tag===22&&o.memoizedState!==null?Xh(s):c!==null?(c.return=o,P=c):Xh(s);for(;i!==null;)P=i,Wv(i),i=i.sibling;P=s,ta=a,et=l}Gh(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,P=i):Gh(e)}}function Gh(e){for(;P!==null;){var t=P;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:et||kc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!et)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Nt(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Mh(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Mh(t,o,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ki(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(k(163))}et||t.flags&512&&Id(t)}catch(p){Te(t,t.return,p)}}if(t===e){P=null;break}if(r=t.sibling,r!==null){r.return=t.return,P=r;break}P=t.return}}function Yh(e){for(;P!==null;){var t=P;if(t===e){P=null;break}var r=t.sibling;if(r!==null){r.return=t.return,P=r;break}P=t.return}}function Xh(e){for(;P!==null;){var t=P;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{kc(4,t)}catch(c){Te(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Te(t,s,c)}}var i=t.return;try{Id(t)}catch(c){Te(t,i,c)}break;case 5:var o=t.return;try{Id(t)}catch(c){Te(t,o,c)}}}catch(c){Te(t,t.return,c)}if(t===e){P=null;break}var a=t.sibling;if(a!==null){a.return=t.return,P=a;break}P=t.return}}var Gb=Math.ceil,Fa=Ir.ReactCurrentDispatcher,ap=Ir.ReactCurrentOwner,Pt=Ir.ReactCurrentBatchConfig,te=0,$e=null,Ie=null,He=0,vt=0,Es=dn(0),Ae=0,ro=null,An=0,Tc=0,cp=0,$i=null,lt=null,lp=0,Ks=1/0,br=null,za=!1,Nd=null,nn=null,ra=!1,Gr=null,Ba=0,Fi=0,Ad=null,va=-1,_a=0;function it(){return te&6?Pe():va!==-1?va:va=Pe()}function sn(e){return e.mode&1?te&2&&He!==0?He&-He:Ib.transition!==null?(_a===0&&(_a=Lg()),_a):(e=ae,e!==0||(e=window.event,e=e===void 0?16:$g(e.type)),e):1}function Ut(e,t,r,n){if(50<Fi)throw Fi=0,Ad=null,Error(k(185));fo(e,r,n),(!(te&2)||e!==$e)&&(e===$e&&(!(te&2)&&(Tc|=r),Ae===4&&Kr(e,He)),ft(e,n),r===1&&te===0&&!(t.mode&1)&&(Ks=Pe()+500,Rc&&un()))}function ft(e,t){var r=e.callbackNode;I1(e,t);var n=Ca(e,e===$e?He:0);if(n===0)r!==null&&oh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&oh(r),t===1)e.tag===0?Lb(Jh.bind(null,e)):nv(Jh.bind(null,e)),Eb(function(){!(te&6)&&un()}),r=null;else{switch(Ig(n)){case 1:r=Nu;break;case 4:r=Pg;break;case 16:r=ba;break;case 536870912:r=xg;break;default:r=ba}r=t_(r,qv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function qv(e,t){if(va=-1,_a=0,te&6)throw Error(k(327));var r=e.callbackNode;if(Os()&&e.callbackNode!==r)return null;var n=Ca(e,e===$e?He:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ua(e,n);else{t=n;var s=te;te|=2;var i=Yv();($e!==e||He!==t)&&(br=null,Ks=Pe()+500,Pn(e,t));do try{Jb();break}catch(a){Gv(e,a)}while(!0);qu(),Fa.current=i,te=s,Ie!==null?t=0:($e=null,He=0,t=Ae)}if(t!==0){if(t===2&&(s=ld(e),s!==0&&(n=s,t=jd(e,s))),t===1)throw r=ro,Pn(e,0),Kr(e,n),ft(e,Pe()),r;if(t===6)Kr(e,n);else{if(s=e.current.alternate,!(n&30)&&!Yb(s)&&(t=Ua(e,n),t===2&&(i=ld(e),i!==0&&(n=i,t=jd(e,i))),t===1))throw r=ro,Pn(e,0),Kr(e,n),ft(e,Pe()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(k(345));case 2:gn(e,lt,br);break;case 3:if(Kr(e,n),(n&130023424)===n&&(t=lp+500-Pe(),10<t)){if(Ca(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){it(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=vd(gn.bind(null,e,lt,br),t);break}gn(e,lt,br);break;case 4:if(Kr(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var o=31-Bt(n);i=1<<o,o=t[o],o>s&&(s=o),n&=~i}if(n=s,n=Pe()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Gb(n/1960))-n,10<n){e.timeoutHandle=vd(gn.bind(null,e,lt,br),n);break}gn(e,lt,br);break;case 5:gn(e,lt,br);break;default:throw Error(k(329))}}}return ft(e,Pe()),e.callbackNode===r?qv.bind(null,e):null}function jd(e,t){var r=$i;return e.current.memoizedState.isDehydrated&&(Pn(e,t).flags|=256),e=Ua(e,t),e!==2&&(t=lt,lt=r,t!==null&&$d(t)),e}function $d(e){lt===null?lt=e:lt.push.apply(lt,e)}function Yb(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ht(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kr(e,t){for(t&=~cp,t&=~Tc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Bt(t),n=1<<r;e[r]=-1,t&=~n}}function Jh(e){if(te&6)throw Error(k(327));Os();var t=Ca(e,0);if(!(t&1))return ft(e,Pe()),null;var r=Ua(e,t);if(e.tag!==0&&r===2){var n=ld(e);n!==0&&(t=n,r=jd(e,n))}if(r===1)throw r=ro,Pn(e,0),Kr(e,t),ft(e,Pe()),r;if(r===6)throw Error(k(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,gn(e,lt,br),ft(e,Pe()),null}function dp(e,t){var r=te;te|=1;try{return e(t)}finally{te=r,te===0&&(Ks=Pe()+500,Rc&&un())}}function jn(e){Gr!==null&&Gr.tag===0&&!(te&6)&&Os();var t=te;te|=1;var r=Pt.transition,n=ae;try{if(Pt.transition=null,ae=1,e)return e()}finally{ae=n,Pt.transition=r,te=t,!(te&6)&&un()}}function up(){vt=Es.current,ve(Es)}function Pn(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Tb(r)),Ie!==null)for(r=Ie.return;r!==null;){var n=r;switch(Ku(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Pa();break;case 3:Hs(),ve(ut),ve(rt),ep();break;case 5:Zu(n);break;case 4:Hs();break;case 13:ve(we);break;case 19:ve(we);break;case 10:Gu(n.type._context);break;case 22:case 23:up()}r=r.return}if($e=e,Ie=e=on(e.current,null),He=vt=t,Ae=0,ro=null,cp=Tc=An=0,lt=$i=null,yn!==null){for(t=0;t<yn.length;t++)if(r=yn[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}yn=null}return e}function Gv(e,t){do{var r=Ie;try{if(qu(),ha.current=$a,ja){for(var n=Se.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ja=!1}if(Nn=0,je=Ne=Se=null,Ai=!1,Zi=0,ap.current=null,r===null||r.return===null){Ae=1,ro=t,Ie=null;break}e:{var i=e,o=r.return,a=r,c=t;if(t=He,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Fh(o);if(f!==null){f.flags&=-257,zh(f,o,a,i,t),f.mode&1&&$h(i,l,t),t=f,c=l;var y=t.updateQueue;if(y===null){var w=new Set;w.add(c),t.updateQueue=w}else y.add(c);break e}else{if(!(t&1)){$h(i,l,t),pp();break e}c=Error(k(426))}}else if(_e&&a.mode&1){var b=Fh(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),zh(b,o,a,i,t),Qu(Vs(c,a));break e}}i=c=Vs(c,a),Ae!==4&&(Ae=2),$i===null?$i=[i]:$i.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=Iv(i,c,t);Ih(i,m);break e;case 1:a=c;var v=i.type,h=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(nn===null||!nn.has(h)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=Mv(i,a,t);Ih(i,_);break e}}i=i.return}while(i!==null)}Jv(r)}catch(S){t=S,Ie===r&&r!==null&&(Ie=r=r.return);continue}break}while(!0)}function Yv(){var e=Fa.current;return Fa.current=$a,e===null?$a:e}function pp(){(Ae===0||Ae===3||Ae===2)&&(Ae=4),$e===null||!(An&268435455)&&!(Tc&268435455)||Kr($e,He)}function Ua(e,t){var r=te;te|=2;var n=Yv();($e!==e||He!==t)&&(br=null,Pn(e,t));do try{Xb();break}catch(s){Gv(e,s)}while(!0);if(qu(),te=r,Fa.current=n,Ie!==null)throw Error(k(261));return $e=null,He=0,Ae}function Xb(){for(;Ie!==null;)Xv(Ie)}function Jb(){for(;Ie!==null&&!b1();)Xv(Ie)}function Xv(e){var t=e_(e.alternate,e,vt);e.memoizedProps=e.pendingProps,t===null?Jv(e):Ie=t,ap.current=null}function Jv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Kb(r,t),r!==null){r.flags&=32767,Ie=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ae=6,Ie=null;return}}else if(r=Vb(r,t,vt),r!==null){Ie=r;return}if(t=t.sibling,t!==null){Ie=t;return}Ie=t=e}while(t!==null);Ae===0&&(Ae=5)}function gn(e,t,r){var n=ae,s=Pt.transition;try{Pt.transition=null,ae=1,Zb(e,t,r,n)}finally{Pt.transition=s,ae=n}return null}function Zb(e,t,r,n){do Os();while(Gr!==null);if(te&6)throw Error(k(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(k(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(M1(e,i),e===$e&&(Ie=$e=null,He=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ra||(ra=!0,t_(ba,function(){return Os(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Pt.transition,Pt.transition=null;var o=ae;ae=1;var a=te;te|=4,ap.current=null,Wb(e,r),Qv(r,e),yb(md),ka=!!hd,md=hd=null,e.current=r,qb(r),C1(),te=a,ae=o,Pt.transition=i}else e.current=r;if(ra&&(ra=!1,Gr=e,Ba=s),i=e.pendingLanes,i===0&&(nn=null),E1(r.stateNode),ft(e,Pe()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(za)throw za=!1,e=Nd,Nd=null,e;return Ba&1&&e.tag!==0&&Os(),i=e.pendingLanes,i&1?e===Ad?Fi++:(Fi=0,Ad=e):Fi=0,un(),null}function Os(){if(Gr!==null){var e=Ig(Ba),t=Pt.transition,r=ae;try{if(Pt.transition=null,ae=16>e?16:e,Gr===null)var n=!1;else{if(e=Gr,Gr=null,Ba=0,te&6)throw Error(k(331));var s=te;for(te|=4,P=e.current;P!==null;){var i=P,o=i.child;if(P.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(P=l;P!==null;){var u=P;switch(u.tag){case 0:case 11:case 15:ji(8,u,i)}var d=u.child;if(d!==null)d.return=u,P=d;else for(;P!==null;){u=P;var p=u.sibling,f=u.return;if(Hv(u),u===l){P=null;break}if(p!==null){p.return=f,P=p;break}P=f}}}var y=i.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var b=w.sibling;w.sibling=null,w=b}while(w!==null)}}P=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,P=o;else e:for(;P!==null;){if(i=P,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ji(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,P=m;break e}P=i.return}}var v=e.current;for(P=v;P!==null;){o=P;var h=o.child;if(o.subtreeFlags&2064&&h!==null)h.return=o,P=h;else e:for(o=v;P!==null;){if(a=P,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kc(9,a)}}catch(S){Te(a,a.return,S)}if(a===o){P=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,P=_;break e}P=a.return}}if(te=s,un(),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(vc,e)}catch{}n=!0}return n}finally{ae=r,Pt.transition=t}}return!1}function Zh(e,t,r){t=Vs(r,t),t=Iv(e,t,1),e=rn(e,t,1),t=it(),e!==null&&(fo(e,1,t),ft(e,t))}function Te(e,t,r){if(e.tag===3)Zh(e,e,r);else for(;t!==null;){if(t.tag===3){Zh(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(nn===null||!nn.has(n))){e=Vs(r,e),e=Mv(t,e,1),t=rn(t,e,1),e=it(),t!==null&&(fo(t,1,e),ft(t,e));break}}t=t.return}}function eC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=it(),e.pingedLanes|=e.suspendedLanes&r,$e===e&&(He&r)===r&&(Ae===4||Ae===3&&(He&130023424)===He&&500>Pe()-lp?Pn(e,0):cp|=r),ft(e,t)}function Zv(e,t){t===0&&(e.mode&1?(t=Qo,Qo<<=1,!(Qo&130023424)&&(Qo=4194304)):t=1);var r=it();e=xr(e,t),e!==null&&(fo(e,t,r),ft(e,r))}function tC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Zv(e,r)}function rC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(k(314))}n!==null&&n.delete(t),Zv(e,r)}var e_;e_=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ut.current)dt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return dt=!1,Hb(e,t,r);dt=!!(e.flags&131072)}else dt=!1,_e&&t.flags&1048576&&sv(t,Ia,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ga(e,t),e=t.pendingProps;var s=zs(t,rt.current);Ms(t,r),s=rp(null,t,n,e,s,r);var i=np();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pt(n)?(i=!0,xa(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xu(t),s.updater=Cc,t.stateNode=s,s._reactInternals=t,Cd(t,n,e,r),t=Ed(null,t,n,!0,i,r)):(t.tag=0,_e&&i&&Vu(t),st(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ga(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=sC(n),e=Nt(n,e),s){case 0:t=Td(null,t,n,e,r);break e;case 1:t=Hh(null,t,n,e,r);break e;case 11:t=Bh(null,t,n,e,r);break e;case 14:t=Uh(null,t,n,Nt(n.type,e),r);break e}throw Error(k(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Nt(n,s),Td(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Nt(n,s),Hh(e,t,n,s,r);case 3:e:{if(jv(t),e===null)throw Error(k(387));n=t.pendingProps,i=t.memoizedState,s=i.element,dv(e,t),Na(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Vs(Error(k(423)),t),t=Vh(e,t,n,r,s);break e}else if(n!==s){s=Vs(Error(k(424)),t),t=Vh(e,t,n,r,s);break e}else for(_t=tn(t.stateNode.containerInfo.firstChild),yt=t,_e=!0,$t=null,r=cv(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bs(),n===s){t=Lr(e,t,r);break e}st(e,t,n,r)}t=t.child}return t;case 5:return uv(t),e===null&&Sd(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,gd(n,s)?o=null:i!==null&&gd(n,i)&&(t.flags|=32),Av(e,t),st(e,t,o,r),t.child;case 6:return e===null&&Sd(t),null;case 13:return $v(e,t,r);case 4:return Ju(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Us(t,null,n,r):st(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Nt(n,s),Bh(e,t,n,s,r);case 7:return st(e,t,t.pendingProps,r),t.child;case 8:return st(e,t,t.pendingProps.children,r),t.child;case 12:return st(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,he(Ma,n._currentValue),n._currentValue=o,i!==null)if(Ht(i.value,o)){if(i.children===s.children&&!ut.current){t=Lr(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Er(-1,r&-r),c.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Rd(i.return,r,t),a.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(k(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Rd(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}st(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ms(t,r),s=xt(s),n=n(s),t.flags|=1,st(e,t,n,r),t.child;case 14:return n=t.type,s=Nt(n,t.pendingProps),s=Nt(n.type,s),Uh(e,t,n,s,r);case 15:return Ov(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Nt(n,s),ga(e,t),t.tag=1,pt(n)?(e=!0,xa(t)):e=!1,Ms(t,r),Lv(t,n,s),Cd(t,n,s,r),Ed(null,t,n,!0,e,r);case 19:return Fv(e,t,r);case 22:return Nv(e,t,r)}throw Error(k(156,t.tag))};function t_(e,t){return Dg(e,t)}function nC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Et(e,t,r,n){return new nC(e,t,r,n)}function fp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sC(e){if(typeof e=="function")return fp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Iu)return 11;if(e===Mu)return 14}return 2}function on(e,t){var r=e.alternate;return r===null?(r=Et(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ya(e,t,r,n,s,i){var o=2;if(n=e,typeof e=="function")fp(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case vs:return xn(r.children,s,i,t);case Lu:o=8,s|=8;break;case ql:return e=Et(12,r,t,s|2),e.elementType=ql,e.lanes=i,e;case Gl:return e=Et(13,r,t,s),e.elementType=Gl,e.lanes=i,e;case Yl:return e=Et(19,r,t,s),e.elementType=Yl,e.lanes=i,e;case ug:return Ec(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case lg:o=10;break e;case dg:o=9;break e;case Iu:o=11;break e;case Mu:o=14;break e;case Ur:o=16,n=null;break e}throw Error(k(130,e==null?e:typeof e,""))}return t=Et(o,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function xn(e,t,r,n){return e=Et(7,e,n,t),e.lanes=r,e}function Ec(e,t,r,n){return e=Et(22,e,n,t),e.elementType=ug,e.lanes=r,e.stateNode={isHidden:!1},e}function Ml(e,t,r){return e=Et(6,e,null,t),e.lanes=r,e}function Ol(e,t,r){return t=Et(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function iC(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hl(0),this.expirationTimes=hl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hl(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function hp(e,t,r,n,s,i,o,a,c){return e=new iC(e,t,r,a,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Et(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xu(i),e}function oC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function r_(e){if(!e)return cn;e=e._reactInternals;e:{if(Un(e)!==e||e.tag!==1)throw Error(k(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(k(171))}if(e.tag===1){var r=e.type;if(pt(r))return rv(e,r,t)}return t}function n_(e,t,r,n,s,i,o,a,c){return e=hp(r,n,!0,e,s,i,o,a,c),e.context=r_(null),r=e.current,n=it(),s=sn(r),i=Er(n,s),i.callback=t??null,rn(r,i,s),e.current.lanes=s,fo(e,s,n),ft(e,n),e}function Dc(e,t,r,n){var s=t.current,i=it(),o=sn(s);return r=r_(r),t.context===null?t.context=r:t.pendingContext=r,t=Er(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=rn(s,t,o),e!==null&&(Ut(e,s,o,i),fa(e,s,o)),o}function Ha(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function em(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function mp(e,t){em(e,t),(e=e.alternate)&&em(e,t)}function aC(){return null}var s_=typeof reportError=="function"?reportError:function(e){console.error(e)};function gp(e){this._internalRoot=e}Pc.prototype.render=gp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(k(409));Dc(e,t,null,null)};Pc.prototype.unmount=gp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;jn(function(){Dc(null,e,null,null)}),t[Pr]=null}};function Pc(e){this._internalRoot=e}Pc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ng();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vr.length&&t!==0&&t<Vr[r].priority;r++);Vr.splice(r,0,e),r===0&&jg(e)}};function vp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function tm(){}function cC(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var l=Ha(o);i.call(l)}}var o=n_(t,n,e,0,null,!1,!1,"",tm);return e._reactRootContainer=o,e[Pr]=o.current,qi(e.nodeType===8?e.parentNode:e),jn(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var l=Ha(c);a.call(l)}}var c=hp(e,0,!1,null,null,!1,!1,"",tm);return e._reactRootContainer=c,e[Pr]=c.current,qi(e.nodeType===8?e.parentNode:e),jn(function(){Dc(t,c,r,n)}),c}function Lc(e,t,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Ha(o);a.call(c)}}Dc(t,o,e,s)}else o=cC(r,t,e,s,n);return Ha(o)}Mg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Di(t.pendingLanes);r!==0&&(Au(t,r|1),ft(t,Pe()),!(te&6)&&(Ks=Pe()+500,un()))}break;case 13:jn(function(){var n=xr(e,1);if(n!==null){var s=it();Ut(n,e,1,s)}}),mp(e,1)}};ju=function(e){if(e.tag===13){var t=xr(e,134217728);if(t!==null){var r=it();Ut(t,e,134217728,r)}mp(e,134217728)}};Og=function(e){if(e.tag===13){var t=sn(e),r=xr(e,t);if(r!==null){var n=it();Ut(r,e,t,n)}mp(e,t)}};Ng=function(){return ae};Ag=function(e,t){var r=ae;try{return ae=e,t()}finally{ae=r}};od=function(e,t,r){switch(t){case"input":if(Zl(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Sc(n);if(!s)throw Error(k(90));fg(n),Zl(n,s)}}}break;case"textarea":mg(e,r);break;case"select":t=r.value,t!=null&&Ps(e,!!r.multiple,t,!1)}};Rg=dp;bg=jn;var lC={usingClientEntryPoint:!1,Events:[mo,Ss,Sc,wg,Sg,dp]},Ci={findFiberByHostInstance:_n,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dC={bundleType:Ci.bundleType,version:Ci.version,rendererPackageName:Ci.rendererPackageName,rendererConfig:Ci.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Tg(e),e===null?null:e.stateNode},findFiberByHostInstance:Ci.findFiberByHostInstance||aC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var na=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!na.isDisabled&&na.supportsFiber)try{vc=na.inject(dC),ar=na}catch{}}St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lC;St.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vp(t))throw Error(k(200));return oC(e,t,null,r)};St.createRoot=function(e,t){if(!vp(e))throw Error(k(299));var r=!1,n="",s=s_;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=hp(e,1,!1,null,null,r,!1,n,s),e[Pr]=t.current,qi(e.nodeType===8?e.parentNode:e),new gp(t)};St.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(k(188)):(e=Object.keys(e).join(","),Error(k(268,e)));return e=Tg(t),e=e===null?null:e.stateNode,e};St.flushSync=function(e){return jn(e)};St.hydrate=function(e,t,r){if(!xc(t))throw Error(k(200));return Lc(null,e,t,!0,r)};St.hydrateRoot=function(e,t,r){if(!vp(e))throw Error(k(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=s_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=n_(t,null,e,1,r??null,s,!1,i,o),e[Pr]=t.current,qi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Pc(t)};St.render=function(e,t,r){if(!xc(t))throw Error(k(200));return Lc(null,e,t,!1,r)};St.unmountComponentAtNode=function(e){if(!xc(e))throw Error(k(40));return e._reactRootContainer?(jn(function(){Lc(null,null,e,!1,function(){e._reactRootContainer=null,e[Pr]=null})}),!0):!1};St.unstable_batchedUpdates=dp;St.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!xc(r))throw Error(k(200));if(e==null||e._reactInternals===void 0)throw Error(k(38));return Lc(e,t,r,!1,n)};St.version="18.3.1-next-f1338f8080-20240426";function i_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i_)}catch(e){console.error(e)}}i_(),ig.exports=St;var uC=ig.exports,rm=uC;Ql.createRoot=rm.createRoot,Ql.hydrateRoot=rm.hydrateRoot;Ql.createRoot(document.getElementById("root")).render(se.jsx(M_.StrictMode,{children:se.jsx(o1,{})}));
